{"version":3,"sources":["parsebone.js"],"names":["root","Parse","VERSION","this","createReduce","dir","iterator","obj","iteratee","memo","keys","index","length","currentKey","context","optimizeCb","isArrayLike","_","arguments","createPredicateIndexFinder","array","predicate","cb","getLength","createIndexFinder","predicateFind","sortedIndex","item","idx","i","Math","max","min","slice","call","isNaN","collectNonEnumProps","nonEnumIdx","nonEnumerableProps","constructor","proto","isFunction","prototype","ObjProto","prop","has","contains","push","previousUnderscore","ArrayProto","Array","Object","FuncProto","Function","toString","hasOwnProperty","nativeIsArray","isArray","nativeKeys","nativeBind","bind","nativeCreate","create","Ctor","_wrapped","exports","module","func","argCount","value","other","collection","accumulator","apply","identity","isObject","matcher","property","Infinity","createAssigner","keysFunc","undefinedOnly","source","l","key","baseCreate","result","MAX_ARRAY_INDEX","pow","each","forEach","map","collect","results","reduce","foldl","inject","reduceRight","foldr","find","detect","findIndex","findKey","filter","select","list","reject","negate","every","all","some","any","includes","include","fromIndex","guard","values","indexOf","invoke","method","args","isFunc","pluck","where","attrs","findWhere","computed","lastComputed","shuffle","rand","set","shuffled","random","sample","n","sortBy","criteria","sort","left","right","a","b","group","behavior","groupBy","indexBy","countBy","toArray","size","partition","pass","fail","first","head","take","initial","last","rest","tail","drop","compact","flatten","input","shallow","strict","startIndex","output","isArguments","j","len","without","difference","uniq","unique","isSorted","isBoolean","seen","union","intersection","argsLength","zip","unzip","object","findLastIndex","low","high","mid","floor","lastIndexOf","range","start","stop","step","ceil","executeBound","sourceFunc","boundFunc","callingContext","self","TypeError","bound","concat","partial","boundArgs","position","bindAll","Error","memoize","hasher","cache","address","delay","wait","setTimeout","defer","throttle","options","timeout","previous","later","leading","now","remaining","clearTimeout","trailing","debounce","immediate","timestamp","callNow","wrap","wrapper","compose","after","times","before","once","hasEnumBug","propertyIsEnumerable","allKeys","mapObject","pairs","invert","functions","methods","names","extend","extendOwn","assign","pick","oiteratee","omit","String","defaults","props","clone","tap","interceptor","isMatch","eq","aStack","bStack","className","areArrays","aCtor","bCtor","pop","isEqual","isEmpty","isString","isElement","nodeType","type","name","Int8Array","isFinite","parseFloat","isNumber","isNull","isUndefined","noConflict","constant","noop","propertyOf","matches","accum","Date","getTime","escapeMap","&","<",">","\"","'","`","unescapeMap","createEscaper","escaper","match","join","testRegexp","RegExp","replaceRegexp","string","test","replace","escape","unescape","fallback","idCounter","uniqueId","prefix","id","templateSettings","evaluate","interpolate","noMatch","escapes","\\","\r","\n"," "," ","escapeChar","template","text","settings","oldSettings","offset","variable","render","e","data","argument","chain","instance","_chain","mixin","valueOf","toJSON","define","amd","req","require","XMLHttpRequest","$","EmptyConstructor","inherits","parent","protoProps","staticProps","child","__super__","serverURL","process","versions","node","_isNode","initialize","applicationId","javaScriptKey","masterKey","_initialize","_useMasterKey","Cloud","useMasterKey","_getParsePath","path","substring","_installationId","_getInstallationId","Promise","as","Storage","getItemAsync","then","hexOctet","setItemAsync","_parseDate","iso8601","regexp","exec","year","month","day","hour","minute","second","milli","UTC","_ajaxIE8","url","promise","xdr","XDomainRequest","onload","response","JSON","parse","responseText","resolve","onerror","ontimeout","fakeResponse","stringify","code","X_DOMAIN_REQUEST","error","onprogress","open","send","_useXDomainRequest","_ajax","success","_thenRunCallbacks","attempts","dispatch","handled","xhr","onreadystatechange","readyState","status","round","setRequestHeader","_extend","classProps","_request","route","objectId","sessionToken","dataObject","charAt","_method","_ApplicationId","_MasterKey","_JavaScriptKey","_ClientVersion","iid","_InstallationId","_sessionToken","User","_canUseCurrentUser","_currentAsync","currentUser","_SessionToken","_isRevocableSessionEnabled","_RevocableSession","errorJSON","INVALID_JSON","CONNECTION_FAILED","_getValue","_encode","seenObjects","disallowObjects","_hasData","_toPointer","dirty","_toFullJSON","ACL","isDate","__type","iso","GeoPoint","x","isRegExp","Relation","Op","File","_objectEach","v","k","_decode","_arrayEach","__op","pointer","_create","_finishFetch","latitude","longitude","relation","targetClassName","file","_url","_traverse","attributes","newChild","_each","callback","_isNullOrUndefined","async","hasLocalStorage","localStorage","setItem","removeItem","getItem","clear","AsyncStorage","p","err","removeItemAsync","memMap","inMemoryMap","Analytics","track","dimensions","val","Config","_escapedAttributes","current","_currentConfig","config","configData","_CURRENT_CONFIG_KEY","get","request","params","errorObject","attr","html","escaped","serverData","message","OTHER_CAUSE","INTERNAL_SERVER_ERROR","OBJECT_NOT_FOUND","INVALID_QUERY","INVALID_CLASS_NAME","MISSING_OBJECT_ID","INVALID_KEY_NAME","INVALID_POINTER","COMMAND_UNAVAILABLE","NOT_INITIALIZED","INCORRECT_TYPE","INVALID_CHANNEL_NAME","PUSH_MISCONFIGURED","OBJECT_TOO_LARGE","OPERATION_FORBIDDEN","CACHE_MISS","INVALID_NESTED_KEY","INVALID_FILE_NAME","INVALID_ACL","TIMEOUT","INVALID_EMAIL_ADDRESS","MISSING_CONTENT_TYPE","MISSING_CONTENT_LENGTH","INVALID_CONTENT_LENGTH","FILE_TOO_LARGE","FILE_SAVE_ERROR","DUPLICATE_VALUE","INVALID_ROLE_NAME","EXCEEDED_QUOTA","SCRIPT_FAILED","VALIDATION_ERROR","INVALID_IMAGE_DATA","UNSAVED_FILE_ERROR","INVALID_PUSH_TIME_ERROR","FILE_DELETE_ERROR","REQUEST_LIMIT_EXCEEDED","INVALID_EVENT_NAME","USERNAME_MISSING","PASSWORD_MISSING","USERNAME_TAKEN","EMAIL_TAKEN","EMAIL_MISSING","EMAIL_NOT_FOUND","SESSION_MISSING","MUST_CREATE_USER_THROUGH_SIGNUP","ACCOUNT_ALREADY_LINKED","INVALID_SESSION_TOKEN","LINKED_ID_MISSING","INVALID_LINKED_SESSION","UNSUPPORTED_SERVICE","AGGREGATE_ERROR","FILE_READ_ERROR","eventSplitter","Events","on","events","calls","event","split","_callbacks","shift","next","off","ctx","trigger","unbind","arg1","arg2","_validate","__defineGetter__","__defineSetter__","_latitude","_longitude","navigator","geolocation","getCurrentPosition","location","coords","radiansTo","point","d2r","PI","lat1rad","long1rad","lat2rad","long2rad","deltaLat","deltaLong","sinDeltaLatDiv2","sin","sinDeltaLongDiv2","cos","asin","sqrt","kilometersTo","milesTo","PUBLIC_KEY","permissionsById","setReadAccess","setWriteAccess","accessList","userId","allowed","permission","_setAccess","accessType","Role","getName","permissions","_getAccess","getReadAccess","getWriteAccess","setPublicReadAccess","getPublicReadAccess","setPublicWriteAccess","getPublicWriteAccess","getRoleReadAccess","role","getRoleWriteAccess","setRoleReadAccess","setRoleWriteAccess","_opDecoderMap","_registerDecoder","opName","decoder","json","op","ops","nextOp","_mergeWithPrevious","Set","_value","_estimate","oldValue","_UNSET","Unset","Increment","amount","_amount","Add","objects","_objects","undefined","AddUnique","newValue","matchingObj","anObj","Remove","adds","removes","_targetClassName","pointerToId","relationsToAdd","relationsToRemove","added","removed","idToPointer","pointers","newAdd","newRemove","newRelation","_ensureParentAndKey","add","change","remove","query","targetClass","_getSubclass","Query","_extraOptions","redirectClassNameForKey","_addCondition","_resolved","_rejected","_resolvedCallbacks","_rejectedCallbacks","_isPromisesAPlusCompliant","is","when","promises","total","hadError","errors","resolveOne","_continueWhile","asyncFunction","_result","resolvedCallback","_error","rejectedCallback","wrappedResolvedCallback","wrappedRejectedCallback","runLater","window","nextTick","always","done","optionsOrCallback","model","_continueWith","continuation","b64Digit","number","fromCharCode","encodeBase64","chunks","b1","b2","b3","has2","has3","readAsync","reader","FileReader","onloadend","dataURL","readAsDataURL","_name","extension","toLowerCase","specifiedType","_source","base64","dataUriRegexp","save","_previousSave","_ContentType","_serverData","_opSetQueue","_hashedJSON","cid","changed","_silent","_pending","silent","_previousAttributes","saveAll","_deepSaveAsync","destroyAll","triggerDestroy","destroyBatch","batch","requests","responses","thisBatch","fetchAll","_fetchAll","fetchAllIfNeeded","_existed","_operations","createdAt","updatedAt","_refreshCache","_refreshingCache","objectArray","arrVal","_resetCacheForKey","currentChanges","dirtyKeys","_mergeMagicFields","specialFields","_copyServerData","tempServerData","_rebuildAllEstimatedData","_mergeFromObject","_startSave","_cancelSave","failedChanges","nextChanges","op1","op2","_saving","_finishSave","fetchedObjects","savedChanges","_applyOpSet","fetched","hasData","opSet","target","wasSet","_rebuildEstimatedDataForKey","previousAttributes","unusedValue","readOnlyAttributes","unset","dataToValidate","changes","isRealChange","increment","addUnique","keysToClear","_getSaveJSON","_canBeSerialized","_canBeSerializedAsValue","fetch","arg3","extraKeys","allFunctions","setOptions","setError","unsavedChildren","unsavedFiles","_findUnsavedChildren","_allPreviousSaves","resp","serverAttrs","destroy","isNew","changing","_changing","deleteChanged","existed","hasChanged","changedAttributes","diff","old","diffVal","isValid","validate","correct","getACL","setACL","acl","ObjectClass","_classMap","_toObjectIdArray","omitObjectsWithData","objectIds","_updateWithFetchedResults","forceFetch","fetchedObjectsById","fetchedObject","containedIn","limit","_performUserRewrite","NewClassObject","OldClassObject","arg0","newArguments","createWithoutData","children","files","canBeSerializedAsValue","newRemaining","readyToStart","batchFinished","body"],"mappings":"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","file":"parsebone.min.js","sourcesContent":["/*!\n * Parse JavaScript SDK\n * Version: 1.5.0\n * Built: Fri Jul 10 2015 17:05:46\n * http://parse.com\n *\n * Copyright 2015 Parse, LLC\n *\n * Includes: Underscore.js\n * Copyright 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.\n * Released under the MIT license.\n */\n;(function (root) {\n  root.Parse = root.Parse || {}\n  root.Parse.VERSION = 'js1.5.0'\n}(this))\n\n//     Underscore.js 1.8.3\n//     http://underscorejs.org\n//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n//     Underscore may be freely distributed under the MIT license.\n\n(function() {\n\n  // Baseline setup\n  // --------------\n\n  // Establish the root object, `window` in the browser, or `exports` on the server.\n  var root = this;\n\n  // Save the previous value of the `_` variable.\n  var previousUnderscore = root._;\n\n  // Save bytes in the minified (but not gzipped) version:\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\n\n  // Create quick reference variables for speed access to core prototypes.\n  var\n    push             = ArrayProto.push,\n    slice            = ArrayProto.slice,\n    toString         = ObjProto.toString,\n    hasOwnProperty   = ObjProto.hasOwnProperty;\n\n  // All **ECMAScript 5** native function implementations that we hope to use\n  // are declared here.\n  var\n    nativeIsArray      = Array.isArray,\n    nativeKeys         = Object.keys,\n    nativeBind         = FuncProto.bind,\n    nativeCreate       = Object.create;\n\n  // Naked function reference for surrogate-prototype-swapping.\n  var Ctor = function(){};\n\n  // Create a safe reference to the Underscore object for use below.\n  var _ = function(obj) {\n    if (obj instanceof _) return obj;\n    if (!(this instanceof _)) return new _(obj);\n    this._wrapped = obj;\n  };\n\n  // Export the Underscore object for **Node.js**, with\n  // backwards-compatibility for the old `require()` API. If we're in\n  // the browser, add `_` as a global object.\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = _;\n    }\n    exports._ = _;\n  } else {\n    root._ = _;\n  }\n\n  // Current version.\n  _.VERSION = '1.8.3';\n\n  // Internal function that returns an efficient (for current engines) version\n  // of the passed-in callback, to be repeatedly applied in other Underscore\n  // functions.\n  var optimizeCb = function(func, context, argCount) {\n    if (context === void 0) return func;\n    switch (argCount == null ? 3 : argCount) {\n      case 1: return function(value) {\n        return func.call(context, value);\n      };\n      case 2: return function(value, other) {\n        return func.call(context, value, other);\n      };\n      case 3: return function(value, index, collection) {\n        return func.call(context, value, index, collection);\n      };\n      case 4: return function(accumulator, value, index, collection) {\n        return func.call(context, accumulator, value, index, collection);\n      };\n    }\n    return function() {\n      return func.apply(context, arguments);\n    };\n  };\n\n  // A mostly-internal function to generate callbacks that can be applied\n  // to each element in a collection, returning the desired result — either\n  // identity, an arbitrary callback, a property matcher, or a property accessor.\n  var cb = function(value, context, argCount) {\n    if (value == null) return _.identity;\n    if (_.isFunction(value)) return optimizeCb(value, context, argCount);\n    if (_.isObject(value)) return _.matcher(value);\n    return _.property(value);\n  };\n  _.iteratee = function(value, context) {\n    return cb(value, context, Infinity);\n  };\n\n  // An internal function for creating assigner functions.\n  var createAssigner = function(keysFunc, undefinedOnly) {\n    return function(obj) {\n      var length = arguments.length;\n      if (length < 2 || obj == null) return obj;\n      for (var index = 1; index < length; index++) {\n        var source = arguments[index],\n            keys = keysFunc(source),\n            l = keys.length;\n        for (var i = 0; i < l; i++) {\n          var key = keys[i];\n          if (!undefinedOnly || obj[key] === void 0) obj[key] = source[key];\n        }\n      }\n      return obj;\n    };\n  };\n\n  // An internal function for creating a new object that inherits from another.\n  var baseCreate = function(prototype) {\n    if (!_.isObject(prototype)) return {};\n    if (nativeCreate) return nativeCreate(prototype);\n    Ctor.prototype = prototype;\n    var result = new Ctor;\n    Ctor.prototype = null;\n    return result;\n  };\n\n  var property = function(key) {\n    return function(obj) {\n      return obj == null ? void 0 : obj[key];\n    };\n  };\n\n  // Helper for collection methods to determine whether a collection\n  // should be iterated as an array or as an object\n  // Related: http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength\n  // Avoids a very nasty iOS 8 JIT bug on ARM-64. #2094\n  var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;\n  var getLength = property('length');\n  var isArrayLike = function(collection) {\n    var length = getLength(collection);\n    return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;\n  };\n\n  // Collection Functions\n  // --------------------\n\n  // The cornerstone, an `each` implementation, aka `forEach`.\n  // Handles raw objects in addition to array-likes. Treats all\n  // sparse array-likes as if they were dense.\n  _.each = _.forEach = function(obj, iteratee, context) {\n    iteratee = optimizeCb(iteratee, context);\n    var i, length;\n    if (isArrayLike(obj)) {\n      for (i = 0, length = obj.length; i < length; i++) {\n        iteratee(obj[i], i, obj);\n      }\n    } else {\n      var keys = _.keys(obj);\n      for (i = 0, length = keys.length; i < length; i++) {\n        iteratee(obj[keys[i]], keys[i], obj);\n      }\n    }\n    return obj;\n  };\n\n  // Return the results of applying the iteratee to each element.\n  _.map = _.collect = function(obj, iteratee, context) {\n    iteratee = cb(iteratee, context);\n    var keys = !isArrayLike(obj) && _.keys(obj),\n        length = (keys || obj).length,\n        results = Array(length);\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      results[index] = iteratee(obj[currentKey], currentKey, obj);\n    }\n    return results;\n  };\n\n  // Create a reducing function iterating left or right.\n  function createReduce(dir) {\n    // Optimized iterator function as using arguments.length\n    // in the main function will deoptimize the, see #1991.\n    function iterator(obj, iteratee, memo, keys, index, length) {\n      for (; index >= 0 && index < length; index += dir) {\n        var currentKey = keys ? keys[index] : index;\n        memo = iteratee(memo, obj[currentKey], currentKey, obj);\n      }\n      return memo;\n    }\n\n    return function(obj, iteratee, memo, context) {\n      iteratee = optimizeCb(iteratee, context, 4);\n      var keys = !isArrayLike(obj) && _.keys(obj),\n          length = (keys || obj).length,\n          index = dir > 0 ? 0 : length - 1;\n      // Determine the initial value if none is provided.\n      if (arguments.length < 3) {\n        memo = obj[keys ? keys[index] : index];\n        index += dir;\n      }\n      return iterator(obj, iteratee, memo, keys, index, length);\n    };\n  }\n\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\n  // or `foldl`.\n  _.reduce = _.foldl = _.inject = createReduce(1);\n\n  // The right-associative version of reduce, also known as `foldr`.\n  _.reduceRight = _.foldr = createReduce(-1);\n\n  // Return the first value which passes a truth test. Aliased as `detect`.\n  _.find = _.detect = function(obj, predicate, context) {\n    var key;\n    if (isArrayLike(obj)) {\n      key = _.findIndex(obj, predicate, context);\n    } else {\n      key = _.findKey(obj, predicate, context);\n    }\n    if (key !== void 0 && key !== -1) return obj[key];\n  };\n\n  // Return all the elements that pass a truth test.\n  // Aliased as `select`.\n  _.filter = _.select = function(obj, predicate, context) {\n    var results = [];\n    predicate = cb(predicate, context);\n    _.each(obj, function(value, index, list) {\n      if (predicate(value, index, list)) results.push(value);\n    });\n    return results;\n  };\n\n  // Return all the elements for which a truth test fails.\n  _.reject = function(obj, predicate, context) {\n    return _.filter(obj, _.negate(cb(predicate)), context);\n  };\n\n  // Determine whether all of the elements match a truth test.\n  // Aliased as `all`.\n  _.every = _.all = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = !isArrayLike(obj) && _.keys(obj),\n        length = (keys || obj).length;\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      if (!predicate(obj[currentKey], currentKey, obj)) return false;\n    }\n    return true;\n  };\n\n  // Determine if at least one element in the object matches a truth test.\n  // Aliased as `any`.\n  _.some = _.any = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = !isArrayLike(obj) && _.keys(obj),\n        length = (keys || obj).length;\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      if (predicate(obj[currentKey], currentKey, obj)) return true;\n    }\n    return false;\n  };\n\n  // Determine if the array or object contains a given item (using `===`).\n  // Aliased as `includes` and `include`.\n  _.contains = _.includes = _.include = function(obj, item, fromIndex, guard) {\n    if (!isArrayLike(obj)) obj = _.values(obj);\n    if (typeof fromIndex != 'number' || guard) fromIndex = 0;\n    return _.indexOf(obj, item, fromIndex) >= 0;\n  };\n\n  // Invoke a method (with arguments) on every item in a collection.\n  _.invoke = function(obj, method) {\n    var args = slice.call(arguments, 2);\n    var isFunc = _.isFunction(method);\n    return _.map(obj, function(value) {\n      var func = isFunc ? method : value[method];\n      return func == null ? func : func.apply(value, args);\n    });\n  };\n\n  // Convenience version of a common use case of `map`: fetching a property.\n  _.pluck = function(obj, key) {\n    return _.map(obj, _.property(key));\n  };\n\n  // Convenience version of a common use case of `filter`: selecting only objects\n  // containing specific `key:value` pairs.\n  _.where = function(obj, attrs) {\n    return _.filter(obj, _.matcher(attrs));\n  };\n\n  // Convenience version of a common use case of `find`: getting the first object\n  // containing specific `key:value` pairs.\n  _.findWhere = function(obj, attrs) {\n    return _.find(obj, _.matcher(attrs));\n  };\n\n  // Return the maximum element (or element-based computation).\n  _.max = function(obj, iteratee, context) {\n    var result = -Infinity, lastComputed = -Infinity,\n        value, computed;\n    if (iteratee == null && obj != null) {\n      obj = isArrayLike(obj) ? obj : _.values(obj);\n      for (var i = 0, length = obj.length; i < length; i++) {\n        value = obj[i];\n        if (value > result) {\n          result = value;\n        }\n      }\n    } else {\n      iteratee = cb(iteratee, context);\n      _.each(obj, function(value, index, list) {\n        computed = iteratee(value, index, list);\n        if (computed > lastComputed || computed === -Infinity && result === -Infinity) {\n          result = value;\n          lastComputed = computed;\n        }\n      });\n    }\n    return result;\n  };\n\n  // Return the minimum element (or element-based computation).\n  _.min = function(obj, iteratee, context) {\n    var result = Infinity, lastComputed = Infinity,\n        value, computed;\n    if (iteratee == null && obj != null) {\n      obj = isArrayLike(obj) ? obj : _.values(obj);\n      for (var i = 0, length = obj.length; i < length; i++) {\n        value = obj[i];\n        if (value < result) {\n          result = value;\n        }\n      }\n    } else {\n      iteratee = cb(iteratee, context);\n      _.each(obj, function(value, index, list) {\n        computed = iteratee(value, index, list);\n        if (computed < lastComputed || computed === Infinity && result === Infinity) {\n          result = value;\n          lastComputed = computed;\n        }\n      });\n    }\n    return result;\n  };\n\n  // Shuffle a collection, using the modern version of the\n  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher–Yates_shuffle).\n  _.shuffle = function(obj) {\n    var set = isArrayLike(obj) ? obj : _.values(obj);\n    var length = set.length;\n    var shuffled = Array(length);\n    for (var index = 0, rand; index < length; index++) {\n      rand = _.random(0, index);\n      if (rand !== index) shuffled[index] = shuffled[rand];\n      shuffled[rand] = set[index];\n    }\n    return shuffled;\n  };\n\n  // Sample **n** random values from a collection.\n  // If **n** is not specified, returns a single random element.\n  // The internal `guard` argument allows it to work with `map`.\n  _.sample = function(obj, n, guard) {\n    if (n == null || guard) {\n      if (!isArrayLike(obj)) obj = _.values(obj);\n      return obj[_.random(obj.length - 1)];\n    }\n    return _.shuffle(obj).slice(0, Math.max(0, n));\n  };\n\n  // Sort the object's values by a criterion produced by an iteratee.\n  _.sortBy = function(obj, iteratee, context) {\n    iteratee = cb(iteratee, context);\n    return _.pluck(_.map(obj, function(value, index, list) {\n      return {\n        value: value,\n        index: index,\n        criteria: iteratee(value, index, list)\n      };\n    }).sort(function(left, right) {\n      var a = left.criteria;\n      var b = right.criteria;\n      if (a !== b) {\n        if (a > b || a === void 0) return 1;\n        if (a < b || b === void 0) return -1;\n      }\n      return left.index - right.index;\n    }), 'value');\n  };\n\n  // An internal function used for aggregate \"group by\" operations.\n  var group = function(behavior) {\n    return function(obj, iteratee, context) {\n      var result = {};\n      iteratee = cb(iteratee, context);\n      _.each(obj, function(value, index) {\n        var key = iteratee(value, index, obj);\n        behavior(result, value, key);\n      });\n      return result;\n    };\n  };\n\n  // Groups the object's values by a criterion. Pass either a string attribute\n  // to group by, or a function that returns the criterion.\n  _.groupBy = group(function(result, value, key) {\n    if (_.has(result, key)) result[key].push(value); else result[key] = [value];\n  });\n\n  // Indexes the object's values by a criterion, similar to `groupBy`, but for\n  // when you know that your index values will be unique.\n  _.indexBy = group(function(result, value, key) {\n    result[key] = value;\n  });\n\n  // Counts instances of an object that group by a certain criterion. Pass\n  // either a string attribute to count by, or a function that returns the\n  // criterion.\n  _.countBy = group(function(result, value, key) {\n    if (_.has(result, key)) result[key]++; else result[key] = 1;\n  });\n\n  // Safely create a real, live array from anything iterable.\n  _.toArray = function(obj) {\n    if (!obj) return [];\n    if (_.isArray(obj)) return slice.call(obj);\n    if (isArrayLike(obj)) return _.map(obj, _.identity);\n    return _.values(obj);\n  };\n\n  // Return the number of elements in an object.\n  _.size = function(obj) {\n    if (obj == null) return 0;\n    return isArrayLike(obj) ? obj.length : _.keys(obj).length;\n  };\n\n  // Split a collection into two arrays: one whose elements all satisfy the given\n  // predicate, and one whose elements all do not satisfy the predicate.\n  _.partition = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var pass = [], fail = [];\n    _.each(obj, function(value, key, obj) {\n      (predicate(value, key, obj) ? pass : fail).push(value);\n    });\n    return [pass, fail];\n  };\n\n  // Array Functions\n  // ---------------\n\n  // Get the first element of an array. Passing **n** will return the first N\n  // values in the array. Aliased as `head` and `take`. The **guard** check\n  // allows it to work with `_.map`.\n  _.first = _.head = _.take = function(array, n, guard) {\n    if (array == null) return void 0;\n    if (n == null || guard) return array[0];\n    return _.initial(array, array.length - n);\n  };\n\n  // Returns everything but the last entry of the array. Especially useful on\n  // the arguments object. Passing **n** will return all the values in\n  // the array, excluding the last N.\n  _.initial = function(array, n, guard) {\n    return slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));\n  };\n\n  // Get the last element of an array. Passing **n** will return the last N\n  // values in the array.\n  _.last = function(array, n, guard) {\n    if (array == null) return void 0;\n    if (n == null || guard) return array[array.length - 1];\n    return _.rest(array, Math.max(0, array.length - n));\n  };\n\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\n  // Especially useful on the arguments object. Passing an **n** will return\n  // the rest N values in the array.\n  _.rest = _.tail = _.drop = function(array, n, guard) {\n    return slice.call(array, n == null || guard ? 1 : n);\n  };\n\n  // Trim out all falsy values from an array.\n  _.compact = function(array) {\n    return _.filter(array, _.identity);\n  };\n\n  // Internal implementation of a recursive `flatten` function.\n  var flatten = function(input, shallow, strict, startIndex) {\n    var output = [], idx = 0;\n    for (var i = startIndex || 0, length = getLength(input); i < length; i++) {\n      var value = input[i];\n      if (isArrayLike(value) && (_.isArray(value) || _.isArguments(value))) {\n        //flatten current level of array or arguments object\n        if (!shallow) value = flatten(value, shallow, strict);\n        var j = 0, len = value.length;\n        output.length += len;\n        while (j < len) {\n          output[idx++] = value[j++];\n        }\n      } else if (!strict) {\n        output[idx++] = value;\n      }\n    }\n    return output;\n  };\n\n  // Flatten out an array, either recursively (by default), or just one level.\n  _.flatten = function(array, shallow) {\n    return flatten(array, shallow, false);\n  };\n\n  // Return a version of the array that does not contain the specified value(s).\n  _.without = function(array) {\n    return _.difference(array, slice.call(arguments, 1));\n  };\n\n  // Produce a duplicate-free version of the array. If the array has already\n  // been sorted, you have the option of using a faster algorithm.\n  // Aliased as `unique`.\n  _.uniq = _.unique = function(array, isSorted, iteratee, context) {\n    if (!_.isBoolean(isSorted)) {\n      context = iteratee;\n      iteratee = isSorted;\n      isSorted = false;\n    }\n    if (iteratee != null) iteratee = cb(iteratee, context);\n    var result = [];\n    var seen = [];\n    for (var i = 0, length = getLength(array); i < length; i++) {\n      var value = array[i],\n          computed = iteratee ? iteratee(value, i, array) : value;\n      if (isSorted) {\n        if (!i || seen !== computed) result.push(value);\n        seen = computed;\n      } else if (iteratee) {\n        if (!_.contains(seen, computed)) {\n          seen.push(computed);\n          result.push(value);\n        }\n      } else if (!_.contains(result, value)) {\n        result.push(value);\n      }\n    }\n    return result;\n  };\n\n  // Produce an array that contains the union: each distinct element from all of\n  // the passed-in arrays.\n  _.union = function() {\n    return _.uniq(flatten(arguments, true, true));\n  };\n\n  // Produce an array that contains every item shared between all the\n  // passed-in arrays.\n  _.intersection = function(array) {\n    var result = [];\n    var argsLength = arguments.length;\n    for (var i = 0, length = getLength(array); i < length; i++) {\n      var item = array[i];\n      if (_.contains(result, item)) continue;\n      for (var j = 1; j < argsLength; j++) {\n        if (!_.contains(arguments[j], item)) break;\n      }\n      if (j === argsLength) result.push(item);\n    }\n    return result;\n  };\n\n  // Take the difference between one array and a number of other arrays.\n  // Only the elements present in just the first array will remain.\n  _.difference = function(array) {\n    var rest = flatten(arguments, true, true, 1);\n    return _.filter(array, function(value){\n      return !_.contains(rest, value);\n    });\n  };\n\n  // Zip together multiple lists into a single array -- elements that share\n  // an index go together.\n  _.zip = function() {\n    return _.unzip(arguments);\n  };\n\n  // Complement of _.zip. Unzip accepts an array of arrays and groups\n  // each array's elements on shared indices\n  _.unzip = function(array) {\n    var length = array && _.max(array, getLength).length || 0;\n    var result = Array(length);\n\n    for (var index = 0; index < length; index++) {\n      result[index] = _.pluck(array, index);\n    }\n    return result;\n  };\n\n  // Converts lists into objects. Pass either a single array of `[key, value]`\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\n  // the corresponding values.\n  _.object = function(list, values) {\n    var result = {};\n    for (var i = 0, length = getLength(list); i < length; i++) {\n      if (values) {\n        result[list[i]] = values[i];\n      } else {\n        result[list[i][0]] = list[i][1];\n      }\n    }\n    return result;\n  };\n\n  // Generator function to create the findIndex and findLastIndex functions\n  function createPredicateIndexFinder(dir) {\n    return function(array, predicate, context) {\n      predicate = cb(predicate, context);\n      var length = getLength(array);\n      var index = dir > 0 ? 0 : length - 1;\n      for (; index >= 0 && index < length; index += dir) {\n        if (predicate(array[index], index, array)) return index;\n      }\n      return -1;\n    };\n  }\n\n  // Returns the first index on an array-like that passes a predicate test\n  _.findIndex = createPredicateIndexFinder(1);\n  _.findLastIndex = createPredicateIndexFinder(-1);\n\n  // Use a comparator function to figure out the smallest index at which\n  // an object should be inserted so as to maintain order. Uses binary search.\n  _.sortedIndex = function(array, obj, iteratee, context) {\n    iteratee = cb(iteratee, context, 1);\n    var value = iteratee(obj);\n    var low = 0, high = getLength(array);\n    while (low < high) {\n      var mid = Math.floor((low + high) / 2);\n      if (iteratee(array[mid]) < value) low = mid + 1; else high = mid;\n    }\n    return low;\n  };\n\n  // Generator function to create the indexOf and lastIndexOf functions\n  function createIndexFinder(dir, predicateFind, sortedIndex) {\n    return function(array, item, idx) {\n      var i = 0, length = getLength(array);\n      if (typeof idx == 'number') {\n        if (dir > 0) {\n            i = idx >= 0 ? idx : Math.max(idx + length, i);\n        } else {\n            length = idx >= 0 ? Math.min(idx + 1, length) : idx + length + 1;\n        }\n      } else if (sortedIndex && idx && length) {\n        idx = sortedIndex(array, item);\n        return array[idx] === item ? idx : -1;\n      }\n      if (item !== item) {\n        idx = predicateFind(slice.call(array, i, length), _.isNaN);\n        return idx >= 0 ? idx + i : -1;\n      }\n      for (idx = dir > 0 ? i : length - 1; idx >= 0 && idx < length; idx += dir) {\n        if (array[idx] === item) return idx;\n      }\n      return -1;\n    };\n  }\n\n  // Return the position of the first occurrence of an item in an array,\n  // or -1 if the item is not included in the array.\n  // If the array is large and already in sort order, pass `true`\n  // for **isSorted** to use binary search.\n  _.indexOf = createIndexFinder(1, _.findIndex, _.sortedIndex);\n  _.lastIndexOf = createIndexFinder(-1, _.findLastIndex);\n\n  // Generate an integer Array containing an arithmetic progression. A port of\n  // the native Python `range()` function. See\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\n  _.range = function(start, stop, step) {\n    if (stop == null) {\n      stop = start || 0;\n      start = 0;\n    }\n    step = step || 1;\n\n    var length = Math.max(Math.ceil((stop - start) / step), 0);\n    var range = Array(length);\n\n    for (var idx = 0; idx < length; idx++, start += step) {\n      range[idx] = start;\n    }\n\n    return range;\n  };\n\n  // Function (ahem) Functions\n  // ------------------\n\n  // Determines whether to execute a function as a constructor\n  // or a normal function with the provided arguments\n  var executeBound = function(sourceFunc, boundFunc, context, callingContext, args) {\n    if (!(callingContext instanceof boundFunc)) return sourceFunc.apply(context, args);\n    var self = baseCreate(sourceFunc.prototype);\n    var result = sourceFunc.apply(self, args);\n    if (_.isObject(result)) return result;\n    return self;\n  };\n\n  // Create a function bound to a given object (assigning `this`, and arguments,\n  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if\n  // available.\n  _.bind = function(func, context) {\n    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\n    if (!_.isFunction(func)) throw new TypeError('Bind must be called on a function');\n    var args = slice.call(arguments, 2);\n    var bound = function() {\n      return executeBound(func, bound, context, this, args.concat(slice.call(arguments)));\n    };\n    return bound;\n  };\n\n  // Partially apply a function by creating a version that has had some of its\n  // arguments pre-filled, without changing its dynamic `this` context. _ acts\n  // as a placeholder, allowing any combination of arguments to be pre-filled.\n  _.partial = function(func) {\n    var boundArgs = slice.call(arguments, 1);\n    var bound = function() {\n      var position = 0, length = boundArgs.length;\n      var args = Array(length);\n      for (var i = 0; i < length; i++) {\n        args[i] = boundArgs[i] === _ ? arguments[position++] : boundArgs[i];\n      }\n      while (position < arguments.length) args.push(arguments[position++]);\n      return executeBound(func, bound, this, this, args);\n    };\n    return bound;\n  };\n\n  // Bind a number of an object's methods to that object. Remaining arguments\n  // are the method names to be bound. Useful for ensuring that all callbacks\n  // defined on an object belong to it.\n  _.bindAll = function(obj) {\n    var i, length = arguments.length, key;\n    if (length <= 1) throw new Error('bindAll must be passed function names');\n    for (i = 1; i < length; i++) {\n      key = arguments[i];\n      obj[key] = _.bind(obj[key], obj);\n    }\n    return obj;\n  };\n\n  // Memoize an expensive function by storing its results.\n  _.memoize = function(func, hasher) {\n    var memoize = function(key) {\n      var cache = memoize.cache;\n      var address = '' + (hasher ? hasher.apply(this, arguments) : key);\n      if (!_.has(cache, address)) cache[address] = func.apply(this, arguments);\n      return cache[address];\n    };\n    memoize.cache = {};\n    return memoize;\n  };\n\n  // Delays a function for the given number of milliseconds, and then calls\n  // it with the arguments supplied.\n  _.delay = function(func, wait) {\n    var args = slice.call(arguments, 2);\n    return setTimeout(function(){\n      return func.apply(null, args);\n    }, wait);\n  };\n\n  // Defers a function, scheduling it to run after the current call stack has\n  // cleared.\n  _.defer = _.partial(_.delay, _, 1);\n\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time. Normally, the throttled function will run\n  // as much as it can, without ever going more than once per `wait` duration;\n  // but if you'd like to disable the execution on the leading edge, pass\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\n  _.throttle = function(func, wait, options) {\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n    if (!options) options = {};\n    var later = function() {\n      previous = options.leading === false ? 0 : _.now();\n      timeout = null;\n      result = func.apply(context, args);\n      if (!timeout) context = args = null;\n    };\n    return function() {\n      var now = _.now();\n      if (!previous && options.leading === false) previous = now;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0 || remaining > wait) {\n        if (timeout) {\n          clearTimeout(timeout);\n          timeout = null;\n        }\n        previous = now;\n        result = func.apply(context, args);\n        if (!timeout) context = args = null;\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds. If `immediate` is passed, trigger the function on the\n  // leading edge, instead of the trailing.\n  _.debounce = function(func, wait, immediate) {\n    var timeout, args, context, timestamp, result;\n\n    var later = function() {\n      var last = _.now() - timestamp;\n\n      if (last < wait && last >= 0) {\n        timeout = setTimeout(later, wait - last);\n      } else {\n        timeout = null;\n        if (!immediate) {\n          result = func.apply(context, args);\n          if (!timeout) context = args = null;\n        }\n      }\n    };\n\n    return function() {\n      context = this;\n      args = arguments;\n      timestamp = _.now();\n      var callNow = immediate && !timeout;\n      if (!timeout) timeout = setTimeout(later, wait);\n      if (callNow) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n\n      return result;\n    };\n  };\n\n  // Returns the first function passed as an argument to the second,\n  // allowing you to adjust arguments, run code before and after, and\n  // conditionally execute the original function.\n  _.wrap = function(func, wrapper) {\n    return _.partial(wrapper, func);\n  };\n\n  // Returns a negated version of the passed-in predicate.\n  _.negate = function(predicate) {\n    return function() {\n      return !predicate.apply(this, arguments);\n    };\n  };\n\n  // Returns a function that is the composition of a list of functions, each\n  // consuming the return value of the function that follows.\n  _.compose = function() {\n    var args = arguments;\n    var start = args.length - 1;\n    return function() {\n      var i = start;\n      var result = args[start].apply(this, arguments);\n      while (i--) result = args[i].call(this, result);\n      return result;\n    };\n  };\n\n  // Returns a function that will only be executed on and after the Nth call.\n  _.after = function(times, func) {\n    return function() {\n      if (--times < 1) {\n        return func.apply(this, arguments);\n      }\n    };\n  };\n\n  // Returns a function that will only be executed up to (but not including) the Nth call.\n  _.before = function(times, func) {\n    var memo;\n    return function() {\n      if (--times > 0) {\n        memo = func.apply(this, arguments);\n      }\n      if (times <= 1) func = null;\n      return memo;\n    };\n  };\n\n  // Returns a function that will be executed at most one time, no matter how\n  // often you call it. Useful for lazy initialization.\n  _.once = _.partial(_.before, 2);\n\n  // Object Functions\n  // ----------------\n\n  // Keys in IE < 9 that won't be iterated by `for key in ...` and thus missed.\n  var hasEnumBug = !{toString: null}.propertyIsEnumerable('toString');\n  var nonEnumerableProps = ['valueOf', 'isPrototypeOf', 'toString',\n                      'propertyIsEnumerable', 'hasOwnProperty', 'toLocaleString'];\n\n  function collectNonEnumProps(obj, keys) {\n    var nonEnumIdx = nonEnumerableProps.length;\n    var constructor = obj.constructor;\n    var proto = (_.isFunction(constructor) && constructor.prototype) || ObjProto;\n\n    // Constructor is a special case.\n    var prop = 'constructor';\n    if (_.has(obj, prop) && !_.contains(keys, prop)) keys.push(prop);\n\n    while (nonEnumIdx--) {\n      prop = nonEnumerableProps[nonEnumIdx];\n      if (prop in obj && obj[prop] !== proto[prop] && !_.contains(keys, prop)) {\n        keys.push(prop);\n      }\n    }\n  }\n\n  // Retrieve the names of an object's own properties.\n  // Delegates to **ECMAScript 5**'s native `Object.keys`\n  _.keys = function(obj) {\n    if (!_.isObject(obj)) return [];\n    if (nativeKeys) return nativeKeys(obj);\n    var keys = [];\n    for (var key in obj) if (_.has(obj, key)) keys.push(key);\n    // Ahem, IE < 9.\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\n    return keys;\n  };\n\n  // Retrieve all the property names of an object.\n  _.allKeys = function(obj) {\n    if (!_.isObject(obj)) return [];\n    var keys = [];\n    for (var key in obj) keys.push(key);\n    // Ahem, IE < 9.\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\n    return keys;\n  };\n\n  // Retrieve the values of an object's properties.\n  _.values = function(obj) {\n    var keys = _.keys(obj);\n    var length = keys.length;\n    var values = Array(length);\n    for (var i = 0; i < length; i++) {\n      values[i] = obj[keys[i]];\n    }\n    return values;\n  };\n\n  // Returns the results of applying the iteratee to each element of the object\n  // In contrast to _.map it returns an object\n  _.mapObject = function(obj, iteratee, context) {\n    iteratee = cb(iteratee, context);\n    var keys =  _.keys(obj),\n          length = keys.length,\n          results = {},\n          currentKey;\n      for (var index = 0; index < length; index++) {\n        currentKey = keys[index];\n        results[currentKey] = iteratee(obj[currentKey], currentKey, obj);\n      }\n      return results;\n  };\n\n  // Convert an object into a list of `[key, value]` pairs.\n  _.pairs = function(obj) {\n    var keys = _.keys(obj);\n    var length = keys.length;\n    var pairs = Array(length);\n    for (var i = 0; i < length; i++) {\n      pairs[i] = [keys[i], obj[keys[i]]];\n    }\n    return pairs;\n  };\n\n  // Invert the keys and values of an object. The values must be serializable.\n  _.invert = function(obj) {\n    var result = {};\n    var keys = _.keys(obj);\n    for (var i = 0, length = keys.length; i < length; i++) {\n      result[obj[keys[i]]] = keys[i];\n    }\n    return result;\n  };\n\n  // Return a sorted list of the function names available on the object.\n  // Aliased as `methods`\n  _.functions = _.methods = function(obj) {\n    var names = [];\n    for (var key in obj) {\n      if (_.isFunction(obj[key])) names.push(key);\n    }\n    return names.sort();\n  };\n\n  // Extend a given object with all the properties in passed-in object(s).\n  _.extend = createAssigner(_.allKeys);\n\n  // Assigns a given object with all the own properties in the passed-in object(s)\n  // (https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)\n  _.extendOwn = _.assign = createAssigner(_.keys);\n\n  // Returns the first key on an object that passes a predicate test\n  _.findKey = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = _.keys(obj), key;\n    for (var i = 0, length = keys.length; i < length; i++) {\n      key = keys[i];\n      if (predicate(obj[key], key, obj)) return key;\n    }\n  };\n\n  // Return a copy of the object only containing the whitelisted properties.\n  _.pick = function(object, oiteratee, context) {\n    var result = {}, obj = object, iteratee, keys;\n    if (obj == null) return result;\n    if (_.isFunction(oiteratee)) {\n      keys = _.allKeys(obj);\n      iteratee = optimizeCb(oiteratee, context);\n    } else {\n      keys = flatten(arguments, false, false, 1);\n      iteratee = function(value, key, obj) { return key in obj; };\n      obj = Object(obj);\n    }\n    for (var i = 0, length = keys.length; i < length; i++) {\n      var key = keys[i];\n      var value = obj[key];\n      if (iteratee(value, key, obj)) result[key] = value;\n    }\n    return result;\n  };\n\n   // Return a copy of the object without the blacklisted properties.\n  _.omit = function(obj, iteratee, context) {\n    if (_.isFunction(iteratee)) {\n      iteratee = _.negate(iteratee);\n    } else {\n      var keys = _.map(flatten(arguments, false, false, 1), String);\n      iteratee = function(value, key) {\n        return !_.contains(keys, key);\n      };\n    }\n    return _.pick(obj, iteratee, context);\n  };\n\n  // Fill in a given object with default properties.\n  _.defaults = createAssigner(_.allKeys, true);\n\n  // Creates an object that inherits from the given prototype object.\n  // If additional properties are provided then they will be added to the\n  // created object.\n  _.create = function(prototype, props) {\n    var result = baseCreate(prototype);\n    if (props) _.extendOwn(result, props);\n    return result;\n  };\n\n  // Create a (shallow-cloned) duplicate of an object.\n  _.clone = function(obj) {\n    if (!_.isObject(obj)) return obj;\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\n  };\n\n  // Invokes interceptor with the obj, and then returns obj.\n  // The primary purpose of this method is to \"tap into\" a method chain, in\n  // order to perform operations on intermediate results within the chain.\n  _.tap = function(obj, interceptor) {\n    interceptor(obj);\n    return obj;\n  };\n\n  // Returns whether an object has a given set of `key:value` pairs.\n  _.isMatch = function(object, attrs) {\n    var keys = _.keys(attrs), length = keys.length;\n    if (object == null) return !length;\n    var obj = Object(object);\n    for (var i = 0; i < length; i++) {\n      var key = keys[i];\n      if (attrs[key] !== obj[key] || !(key in obj)) return false;\n    }\n    return true;\n  };\n\n\n  // Internal recursive comparison function for `isEqual`.\n  var eq = function(a, b, aStack, bStack) {\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\n    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).\n    if (a === b) return a !== 0 || 1 / a === 1 / b;\n    // A strict comparison is necessary because `null == undefined`.\n    if (a == null || b == null) return a === b;\n    // Unwrap any wrapped objects.\n    if (a instanceof _) a = a._wrapped;\n    if (b instanceof _) b = b._wrapped;\n    // Compare `[[Class]]` names.\n    var className = toString.call(a);\n    if (className !== toString.call(b)) return false;\n    switch (className) {\n      // Strings, numbers, regular expressions, dates, and booleans are compared by value.\n      case '[object RegExp]':\n      // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')\n      case '[object String]':\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\n        // equivalent to `new String(\"5\")`.\n        return '' + a === '' + b;\n      case '[object Number]':\n        // `NaN`s are equivalent, but non-reflexive.\n        // Object(NaN) is equivalent to NaN\n        if (+a !== +a) return +b !== +b;\n        // An `egal` comparison is performed for other numeric values.\n        return +a === 0 ? 1 / +a === 1 / b : +a === +b;\n      case '[object Date]':\n      case '[object Boolean]':\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n        // millisecond representations. Note that invalid dates with millisecond representations\n        // of `NaN` are not equivalent.\n        return +a === +b;\n    }\n\n    var areArrays = className === '[object Array]';\n    if (!areArrays) {\n      if (typeof a != 'object' || typeof b != 'object') return false;\n\n      // Objects with different constructors are not equivalent, but `Object`s or `Array`s\n      // from different frames are.\n      var aCtor = a.constructor, bCtor = b.constructor;\n      if (aCtor !== bCtor && !(_.isFunction(aCtor) && aCtor instanceof aCtor &&\n                               _.isFunction(bCtor) && bCtor instanceof bCtor)\n                          && ('constructor' in a && 'constructor' in b)) {\n        return false;\n      }\n    }\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n\n    // Initializing stack of traversed objects.\n    // It's done here since we only need them for objects and arrays comparison.\n    aStack = aStack || [];\n    bStack = bStack || [];\n    var length = aStack.length;\n    while (length--) {\n      // Linear search. Performance is inversely proportional to the number of\n      // unique nested structures.\n      if (aStack[length] === a) return bStack[length] === b;\n    }\n\n    // Add the first object to the stack of traversed objects.\n    aStack.push(a);\n    bStack.push(b);\n\n    // Recursively compare objects and arrays.\n    if (areArrays) {\n      // Compare array lengths to determine if a deep comparison is necessary.\n      length = a.length;\n      if (length !== b.length) return false;\n      // Deep compare the contents, ignoring non-numeric properties.\n      while (length--) {\n        if (!eq(a[length], b[length], aStack, bStack)) return false;\n      }\n    } else {\n      // Deep compare objects.\n      var keys = _.keys(a), key;\n      length = keys.length;\n      // Ensure that both objects contain the same number of properties before comparing deep equality.\n      if (_.keys(b).length !== length) return false;\n      while (length--) {\n        // Deep compare each member\n        key = keys[length];\n        if (!(_.has(b, key) && eq(a[key], b[key], aStack, bStack))) return false;\n      }\n    }\n    // Remove the first object from the stack of traversed objects.\n    aStack.pop();\n    bStack.pop();\n    return true;\n  };\n\n  // Perform a deep comparison to check if two objects are equal.\n  _.isEqual = function(a, b) {\n    return eq(a, b);\n  };\n\n  // Is a given array, string, or object empty?\n  // An \"empty\" object has no enumerable own-properties.\n  _.isEmpty = function(obj) {\n    if (obj == null) return true;\n    if (isArrayLike(obj) && (_.isArray(obj) || _.isString(obj) || _.isArguments(obj))) return obj.length === 0;\n    return _.keys(obj).length === 0;\n  };\n\n  // Is a given value a DOM element?\n  _.isElement = function(obj) {\n    return !!(obj && obj.nodeType === 1);\n  };\n\n  // Is a given value an array?\n  // Delegates to ECMA5's native Array.isArray\n  _.isArray = nativeIsArray || function(obj) {\n    return toString.call(obj) === '[object Array]';\n  };\n\n  // Is a given variable an object?\n  _.isObject = function(obj) {\n    var type = typeof obj;\n    return type === 'function' || type === 'object' && !!obj;\n  };\n\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp, isError.\n  _.each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp', 'Error'], function(name) {\n    _['is' + name] = function(obj) {\n      return toString.call(obj) === '[object ' + name + ']';\n    };\n  });\n\n  // Define a fallback version of the method in browsers (ahem, IE < 9), where\n  // there isn't any inspectable \"Arguments\" type.\n  if (!_.isArguments(arguments)) {\n    _.isArguments = function(obj) {\n      return _.has(obj, 'callee');\n    };\n  }\n\n  // Optimize `isFunction` if appropriate. Work around some typeof bugs in old v8,\n  // IE 11 (#1621), and in Safari 8 (#1929).\n  if (typeof /./ != 'function' && typeof Int8Array != 'object') {\n    _.isFunction = function(obj) {\n      return typeof obj == 'function' || false;\n    };\n  }\n\n  // Is a given object a finite number?\n  _.isFinite = function(obj) {\n    return isFinite(obj) && !isNaN(parseFloat(obj));\n  };\n\n  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\n  _.isNaN = function(obj) {\n    return _.isNumber(obj) && obj !== +obj;\n  };\n\n  // Is a given value a boolean?\n  _.isBoolean = function(obj) {\n    return obj === true || obj === false || toString.call(obj) === '[object Boolean]';\n  };\n\n  // Is a given value equal to null?\n  _.isNull = function(obj) {\n    return obj === null;\n  };\n\n  // Is a given variable undefined?\n  _.isUndefined = function(obj) {\n    return obj === void 0;\n  };\n\n  // Shortcut function for checking if an object has a given property directly\n  // on itself (in other words, not on a prototype).\n  _.has = function(obj, key) {\n    return obj != null && hasOwnProperty.call(obj, key);\n  };\n\n  // Utility Functions\n  // -----------------\n\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\n  // previous owner. Returns a reference to the Underscore object.\n  _.noConflict = function() {\n    root._ = previousUnderscore;\n    return this;\n  };\n\n  // Keep the identity function around for default iteratees.\n  _.identity = function(value) {\n    return value;\n  };\n\n  // Predicate-generating functions. Often useful outside of Underscore.\n  _.constant = function(value) {\n    return function() {\n      return value;\n    };\n  };\n\n  _.noop = function(){};\n\n  _.property = property;\n\n  // Generates a function for a given object that returns a given property.\n  _.propertyOf = function(obj) {\n    return obj == null ? function(){} : function(key) {\n      return obj[key];\n    };\n  };\n\n  // Returns a predicate for checking whether an object has a given set of\n  // `key:value` pairs.\n  _.matcher = _.matches = function(attrs) {\n    attrs = _.extendOwn({}, attrs);\n    return function(obj) {\n      return _.isMatch(obj, attrs);\n    };\n  };\n\n  // Run a function **n** times.\n  _.times = function(n, iteratee, context) {\n    var accum = Array(Math.max(0, n));\n    iteratee = optimizeCb(iteratee, context, 1);\n    for (var i = 0; i < n; i++) accum[i] = iteratee(i);\n    return accum;\n  };\n\n  // Return a random integer between min and max (inclusive).\n  _.random = function(min, max) {\n    if (max == null) {\n      max = min;\n      min = 0;\n    }\n    return min + Math.floor(Math.random() * (max - min + 1));\n  };\n\n  // A (possibly faster) way to get the current timestamp as an integer.\n  _.now = Date.now || function() {\n    return new Date().getTime();\n  };\n\n   // List of HTML entities for escaping.\n  var escapeMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#x27;',\n    '`': '&#x60;'\n  };\n  var unescapeMap = _.invert(escapeMap);\n\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\n  var createEscaper = function(map) {\n    var escaper = function(match) {\n      return map[match];\n    };\n    // Regexes for identifying a key that needs to be escaped\n    var source = '(?:' + _.keys(map).join('|') + ')';\n    var testRegexp = RegExp(source);\n    var replaceRegexp = RegExp(source, 'g');\n    return function(string) {\n      string = string == null ? '' : '' + string;\n      return testRegexp.test(string) ? string.replace(replaceRegexp, escaper) : string;\n    };\n  };\n  _.escape = createEscaper(escapeMap);\n  _.unescape = createEscaper(unescapeMap);\n\n  // If the value of the named `property` is a function then invoke it with the\n  // `object` as context; otherwise, return it.\n  _.result = function(object, property, fallback) {\n    var value = object == null ? void 0 : object[property];\n    if (value === void 0) {\n      value = fallback;\n    }\n    return _.isFunction(value) ? value.call(object) : value;\n  };\n\n  // Generate a unique integer id (unique within the entire client session).\n  // Useful for temporary DOM ids.\n  var idCounter = 0;\n  _.uniqueId = function(prefix) {\n    var id = ++idCounter + '';\n    return prefix ? prefix + id : id;\n  };\n\n  // By default, Underscore uses ERB-style template delimiters, change the\n  // following template settings to use alternative delimiters.\n  _.templateSettings = {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g\n  };\n\n  // When customizing `templateSettings`, if you don't want to define an\n  // interpolation, evaluation or escaping regex, we need one that is\n  // guaranteed not to match.\n  var noMatch = /(.)^/;\n\n  // Certain characters need to be escaped so that they can be put into a\n  // string literal.\n  var escapes = {\n    \"'\":      \"'\",\n    '\\\\':     '\\\\',\n    '\\r':     'r',\n    '\\n':     'n',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  var escaper = /\\\\|'|\\r|\\n|\\u2028|\\u2029/g;\n\n  var escapeChar = function(match) {\n    return '\\\\' + escapes[match];\n  };\n\n  // JavaScript micro-templating, similar to John Resig's implementation.\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\n  // and correctly escapes quotes within interpolated code.\n  // NB: `oldSettings` only exists for backwards compatibility.\n  _.template = function(text, settings, oldSettings) {\n    if (!settings && oldSettings) settings = oldSettings;\n    settings = _.defaults({}, settings, _.templateSettings);\n\n    // Combine delimiters into one regular expression via alternation.\n    var matcher = RegExp([\n      (settings.escape || noMatch).source,\n      (settings.interpolate || noMatch).source,\n      (settings.evaluate || noMatch).source\n    ].join('|') + '|$', 'g');\n\n    // Compile the template source, escaping string literals appropriately.\n    var index = 0;\n    var source = \"__p+='\";\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n      source += text.slice(index, offset).replace(escaper, escapeChar);\n      index = offset + match.length;\n\n      if (escape) {\n        source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\n      } else if (interpolate) {\n        source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\n      } else if (evaluate) {\n        source += \"';\\n\" + evaluate + \"\\n__p+='\";\n      }\n\n      // Adobe VMs need the match returned to produce the correct offest.\n      return match;\n    });\n    source += \"';\\n\";\n\n    // If a variable is not specified, place data values in local scope.\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\n\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\n      \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\n      source + 'return __p;\\n';\n\n    try {\n      var render = new Function(settings.variable || 'obj', '_', source);\n    } catch (e) {\n      e.source = source;\n      throw e;\n    }\n\n    var template = function(data) {\n      return render.call(this, data, _);\n    };\n\n    // Provide the compiled source as a convenience for precompilation.\n    var argument = settings.variable || 'obj';\n    template.source = 'function(' + argument + '){\\n' + source + '}';\n\n    return template;\n  };\n\n  // Add a \"chain\" function. Start chaining a wrapped Underscore object.\n  _.chain = function(obj) {\n    var instance = _(obj);\n    instance._chain = true;\n    return instance;\n  };\n\n  // OOP\n  // ---------------\n  // If Underscore is called as a function, it returns a wrapped object that\n  // can be used OO-style. This wrapper holds altered versions of all the\n  // underscore functions. Wrapped objects may be chained.\n\n  // Helper function to continue chaining intermediate results.\n  var result = function(instance, obj) {\n    return instance._chain ? _(obj).chain() : obj;\n  };\n\n  // Add your own custom functions to the Underscore object.\n  _.mixin = function(obj) {\n    _.each(_.functions(obj), function(name) {\n      var func = _[name] = obj[name];\n      _.prototype[name] = function() {\n        var args = [this._wrapped];\n        push.apply(args, arguments);\n        return result(this, func.apply(_, args));\n      };\n    });\n  };\n\n  // Add all of the Underscore functions to the wrapper object.\n  _.mixin(_);\n\n  // Add all mutator Array functions to the wrapper.\n  _.each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      var obj = this._wrapped;\n      method.apply(obj, arguments);\n      if ((name === 'shift' || name === 'splice') && obj.length === 0) delete obj[0];\n      return result(this, obj);\n    };\n  });\n\n  // Add all accessor Array functions to the wrapper.\n  _.each(['concat', 'join', 'slice'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      return result(this, method.apply(this._wrapped, arguments));\n    };\n  });\n\n  // Extracts the result from a wrapped and chained object.\n  _.prototype.value = function() {\n    return this._wrapped;\n  };\n\n  // Provide unwrapping proxy for some methods used in engine operations\n  // such as arithmetic and JSON stringification.\n  _.prototype.valueOf = _.prototype.toJSON = _.prototype.value;\n\n  _.prototype.toString = function() {\n    return '' + this._wrapped;\n  };\n\n  // AMD registration happens at the end for compatibility with AMD loaders\n  // that may not enforce next-turn semantics on modules. Even though general\n  // practice for AMD registration is to be anonymous, underscore registers\n  // as a named module because, like jQuery, it is a base library that is\n  // popular enough to be bundled in a third party lib, but not be part of\n  // an AMD load request. Those cases could generate an error when an\n  // anonymous define() is called outside of a loader request.\n  if (typeof define === 'function' && define.amd) {\n    define('underscore', [], function() {\n      return _;\n    });\n  }\n}.call(this));\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  /**\n   * Contains all Parse API classes and functions.\n   * @name Parse\n   * @namespace\n   *\n   * Contains all Parse API classes and functions.\n   */\n  var Parse = root.Parse\n\n  var req = typeof (require) === 'function' ? require : null\n  // Load references to other dependencies\n  if (typeof (XMLHttpRequest) !== 'undefined') {\n    Parse.XMLHttpRequest = XMLHttpRequest\n  } else if (req && typeof (require.ensure) === 'undefined') {\n    Parse.XMLHttpRequest = req('xmlhttprequest').XMLHttpRequest\n  }\n  // Import Parse's local copy of underscore.\n  if (typeof (exports) !== 'undefined' && exports._) {\n    // We're running in a CommonJS environment\n    Parse._ = exports._.noConflict()\n    exports.Parse = Parse\n  } else {\n    Parse._ = _.noConflict()\n  }\n\n  // If jQuery or Zepto has been included, grab a reference to it.\n  if (typeof ($) !== 'undefined') {\n    Parse.$ = $\n  }\n\n  // Helpers\n  // -------\n\n  // Shared empty constructor function to aid in prototype-chain creation.\n  var EmptyConstructor = function () {}\n\n  // Helper function to correctly set up the prototype chain, for subclasses.\n  // Similar to `goog.inherits`, but uses a hash of prototype properties and\n  // class properties to be extended.\n  var inherits = function (parent, protoProps, staticProps) {\n    var child\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && protoProps.hasOwnProperty('constructor')) {\n      child = protoProps.constructor\n    } else {\n      /** @ignore */\n      child = function () {\n        parent.apply(this, arguments)\n      }\n    }\n\n    // Inherit class (static) properties from parent.\n    Parse._.extend(child, parent)\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    EmptyConstructor.prototype = parent.prototype\n    child.prototype = new EmptyConstructor()\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) {\n      Parse._.extend(child.prototype, protoProps)\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    if (staticProps) {\n      Parse._.extend(child, staticProps)\n    }\n\n    // Correctly set child's `prototype.constructor`.\n    child.prototype.constructor = child\n\n    // Set a convenience property in case the parent's prototype is\n    // needed later.\n    child.__super__ = parent.prototype\n\n    return child\n  }\n\n  // Set the server for Parse to talk to.\n  Parse.serverURL = 'https://api.parse.com'\n\n  // Check whether we are running in Node.js.\n  if (typeof (process) !== 'undefined' &&\n    process.versions &&\n    process.versions.node) {\n    Parse._isNode = true\n  }\n\n  /**\n   * Call this method first to set up your authentication tokens for Parse.\n   * You can get your keys from the Data Browser on parse.com.\n   * @param {String} applicationId Your Parse Application ID.\n   * @param {String} javaScriptKey Your Parse JavaScript Key.\n   * @param {String} masterKey (optional) Your Parse Master Key. (Node.js only!)\n   */\n  Parse.initialize = function (applicationId, javaScriptKey, masterKey) {\n    if (masterKey) {\n      throw new Error('Parse.initialize() was passed a Master Key, which is only allowed from within Node.js.')\n    }\n    Parse._initialize(applicationId, javaScriptKey)\n  }\n\n  /**\n   * Call this method first to set up master authentication tokens for Parse.\n   * This method is for Parse's own private use.\n   * @param {String} applicationId Your Parse Application ID.\n   * @param {String} javaScriptKey Your Parse JavaScript Key.\n   * @param {String} masterKey Your Parse Master Key.\n   */\n  Parse._initialize = function (applicationId, javaScriptKey, masterKey) {\n    Parse.applicationId = applicationId\n    Parse.javaScriptKey = javaScriptKey\n    Parse.masterKey = masterKey\n    Parse._useMasterKey = false\n  }\n\n  // If we're running in node.js, allow using the master key.\n  if (Parse._isNode) {\n    Parse.initialize = Parse._initialize\n\n    Parse.Cloud = Parse.Cloud || {}\n    /**\n     * Switches the Parse SDK to using the Master key.  The Master key grants\n     * priveleged access to the data in Parse and can be used to bypass ACLs and\n     * other restrictions that are applied to the client SDKs.\n     * <p><strong><em>Available in Cloud Code and Node.js only.</em></strong>\n     * </p>\n     */\n    Parse.Cloud.useMasterKey = function () {\n      Parse._useMasterKey = true\n    }\n  }\n\n  /**\n   * Returns prefix for Storage keys used by this instance of Parse.\n   * @param {String} path The relative suffix to append to it.\n   *     null or undefined is treated as the empty string.\n   * @return {String} The full key name.\n   */\n  Parse._getParsePath = function (path) {\n    if (!Parse.applicationId) {\n      throw new Error('You need to call Parse.initialize before using Parse.')\n    }\n    if (!path) {\n      path = ''\n    }\n    if (!Parse._.isString(path)) {\n      throw new Error(\"Tried to get a Storage path that wasn't a String.\")\n    }\n    if (path[0] === '/') {\n      path = path.substring(1)\n    }\n    return 'Parse/' + Parse.applicationId + '/' + path\n  }\n\n  /**\n   * Returns a Promise that is resolved with the unique string for this app on\n   * this machine.\n   * Gets reset when Storage is cleared.\n   */\n  Parse._installationId = null\n  Parse._getInstallationId = function () {\n    // See if it's cached in RAM.\n    if (Parse._installationId) {\n      return Parse.Promise.as(Parse._installationId)\n    }\n\n    // Try to get it from Storage.\n    var path = Parse._getParsePath('installationId')\n    return (Parse.Storage.getItemAsync(path)\n      .then(function (value) {\n        Parse._installationId = value\n\n        if (!Parse._installationId || Parse._installationId === '') {\n          // It wasn't in Storage, so create a new one.\n          var hexOctet = function () {\n            return (\n            Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1)\n            )\n          }\n          Parse._installationId = (\n            hexOctet() + hexOctet() + '-' +\n            hexOctet() + '-' +\n            hexOctet() + '-' +\n            hexOctet() + '-' +\n            hexOctet() + hexOctet() + hexOctet())\n          return Parse.Storage.setItemAsync(path, Parse._installationId)\n        }\n\n        return Parse.Promise.as(Parse._installationId)\n      })\n    )\n  }\n\n  Parse._parseDate = function (iso8601) {\n    var regexp = new RegExp(\n      '^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})' + 'T' +\n      '([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})' +\n      '(.([0-9]+))?' + 'Z$')\n    var match = regexp.exec(iso8601)\n    if (!match) {\n      return null\n    }\n\n    var year = match[1] || 0\n    var month = (match[2] || 1) - 1\n    var day = match[3] || 0\n    var hour = match[4] || 0\n    var minute = match[5] || 0\n    var second = match[6] || 0\n    var milli = match[8] || 0\n\n    return new Date(Date.UTC(year, month, day, hour, minute, second, milli))\n  }\n\n  Parse._ajaxIE8 = function (method, url, data) {\n    var promise = new Parse.Promise()\n    var xdr = new XDomainRequest()\n    xdr.onload = function () {\n      var response\n      try {\n        response = JSON.parse(xdr.responseText)\n      } catch (e) {\n        promise.reject(e)\n      }\n      if (response) {\n        promise.resolve(response)\n      }\n    }\n    xdr.onerror = xdr.ontimeout = function () {\n      // Let's fake a real error message.\n      var fakeResponse = {\n        responseText: JSON.stringify({\n          code: Parse.Error.X_DOMAIN_REQUEST,\n          error: \"IE's XDomainRequest does not supply error info.\"\n        })\n      }\n      promise.reject(fakeResponse)\n    }\n    xdr.onprogress = function () {}\n    xdr.open(method, url)\n    xdr.send(data)\n    return promise\n  }\n\n  Parse._useXDomainRequest = function () {\n    if (typeof (XDomainRequest) !== 'undefined') {\n      // We're in IE 8+.\n      if ('withCredentials' in new XMLHttpRequest()) {\n        // We're in IE 10+.\n        return false\n      }\n      return true\n    }\n    return false\n  }\n\n  Parse._ajax = function (method, url, data, success, error) {\n    var options = {\n      success: success,\n      error: error\n    }\n\n    if (Parse._useXDomainRequest()) {\n      return Parse._ajaxIE8(method, url, data)._thenRunCallbacks(options)\n    }\n\n    var promise = new Parse.Promise()\n    var attempts = 0\n\n    var dispatch = function () {\n      var handled = false\n      var xhr = new Parse.XMLHttpRequest()\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 4) {\n          if (handled) {\n            return\n          }\n          handled = true\n\n          if (xhr.status >= 200 && xhr.status < 300) {\n            var response\n            try {\n              response = JSON.parse(xhr.responseText)\n            } catch (e) {\n              promise.reject(e)\n            }\n            if (response) {\n              promise.resolve(response, xhr.status, xhr)\n            }\n          } else if (xhr.status >= 500) { // Retry on 5XX\n            if (++attempts < 5) {\n              // Exponentially-growing delay\n              var delay = Math.round(\n                Math.random() * 125 * Math.pow(2, attempts)\n              )\n              setTimeout(dispatch, delay)\n            } else {\n              // After 5 retries, fail\n              promise.reject(xhr)\n            }\n          } else {\n            promise.reject(xhr)\n          }\n        }\n      }\n\n      xhr.open(method, url, true)\n      xhr.setRequestHeader('Content-Type', 'text/plain') // avoid pre-flight.\n      if (Parse._isNode) {\n        // Add a special user agent just for request from node.js.\n        xhr.setRequestHeader('User-Agent',\n          'Parse/' + Parse.VERSION +\n          ' (NodeJS ' + process.versions.node + ')')\n      }\n      xhr.send(data)\n    }\n\n    dispatch()\n    return promise._thenRunCallbacks(options)\n  }\n\n  // A self-propagating extend function.\n  Parse._extend = function (protoProps, classProps) {\n    var child = inherits(this, protoProps, classProps)\n    child.extend = this.extend\n    return child\n  }\n\n  /**\n   * Options:\n   *   route: is classes, users, login, etc.\n   *   objectId: null if there is no associated objectId.\n   *   method: the http method for the REST API.\n   *   dataObject: the payload as an object, or null if there is none.\n   *   useMasterKey: overrides whether to use the master key if set.\n   * @ignore\n   */\n  Parse._request = function (options) {\n    var route = options.route\n    var className = options.className\n    var objectId = options.objectId\n    var method = options.method\n    var useMasterKey = options.useMasterKey\n    var sessionToken = options.sessionToken\n    var dataObject = options.data\n\n    if (!Parse.applicationId) {\n      throw new Error('You must specify your applicationId using Parse.initialize.')\n    }\n\n    if (!Parse.javaScriptKey && !Parse.masterKey) {\n      throw new Error('You must specify a key using Parse.initialize.')\n    }\n\n    if (route !== 'batch' &&\n      route !== 'classes' &&\n      route !== 'events' &&\n      route !== 'files' &&\n      route !== 'functions' &&\n      route !== 'login' &&\n      route !== 'logout' &&\n      route !== 'push' &&\n      route !== 'requestPasswordReset' &&\n      route !== 'rest_verify_analytics' &&\n      route !== 'users' &&\n      route !== 'jobs' &&\n      route !== 'config' &&\n      route !== 'sessions' &&\n      route !== 'upgradeToRevocableSession') {\n      throw new Error(\"Bad route: '\" + route + \"'.\")\n    }\n\n    var url = Parse.serverURL\n    if (url.charAt(url.length - 1) !== '/') {\n      url += '/'\n    }\n    url += '1/' + route\n    if (className) {\n      url += '/' + className\n    }\n    if (objectId) {\n      url += '/' + objectId\n    }\n\n    dataObject = Parse._.clone(dataObject || {})\n    if (method !== 'POST') {\n      dataObject._method = method\n      method = 'POST'\n    }\n\n    if (Parse._.isUndefined(useMasterKey)) {\n      useMasterKey = Parse._useMasterKey\n    }\n\n    dataObject._ApplicationId = Parse.applicationId\n    if (!useMasterKey) {\n      dataObject._JavaScriptKey = Parse.javaScriptKey\n    } else if (!Parse.masterKey) {\n      throw new Error('Cannot use the Master Key, it has not been provided.')\n    } else {\n      dataObject._MasterKey = Parse.masterKey\n    }\n\n    dataObject._ClientVersion = Parse.VERSION\n\n    return Parse._getInstallationId().then(function (iid) {\n      dataObject._InstallationId = iid\n\n      if (sessionToken) {\n        return Parse.Promise.as({ _sessionToken: sessionToken })\n      }\n      if (!Parse.User._canUseCurrentUser()) {\n        return Parse.Promise.as(null)\n      }\n\n      return Parse.User._currentAsync()\n    }).then(function (currentUser) {\n      if (currentUser && currentUser._sessionToken) {\n        dataObject._SessionToken = currentUser._sessionToken\n      }\n\n      if (Parse.User._isRevocableSessionEnabled) {\n        dataObject._RevocableSession = '1'\n      }\n\n      var data = JSON.stringify(dataObject)\n\n      return Parse._ajax(method, url, data)\n    }).then(null, function (response) {\n      // Transform the error into an instance of Parse.Error by trying to parse\n      // the error string as JSON.\n      var error\n      if (response && response.responseText) {\n        try {\n          var errorJSON = JSON.parse(response.responseText)\n          error = new Parse.Error(errorJSON.code, errorJSON.error)\n        } catch (e) {\n          // If we fail to parse the error text, that's okay.\n          error = new Parse.Error(\n            Parse.Error.INVALID_JSON,\n            'Received an error with invalid JSON from Parse: ' +\n            response.responseText)\n        }\n      } else {\n        error = new Parse.Error(\n          Parse.Error.CONNECTION_FAILED,\n          'XMLHttpRequest failed: ' + JSON.stringify(response))\n      }\n      // By explicitly returning a rejected Promise, this will work with\n      // either jQuery or Promises/A semantics.\n      return Parse.Promise.error(error)\n    })\n  }\n\n  // Helper function to get a value from a Backbone object as a property\n  // or as a function.\n  Parse._getValue = function (object, prop) {\n    if (!(object && object[prop])) {\n      return null\n    }\n    return Parse._.isFunction(object[prop]) ? object[prop]() : object[prop]\n  }\n\n  /**\n   * Converts a value in a Parse Object into the appropriate representation.\n   * This is the JS equivalent of Java's Parse.maybeReferenceAndEncode(Object)\n   * if seenObjects is falsey. Otherwise any Parse.Objects not in\n   * seenObjects will be fully embedded rather than encoded\n   * as a pointer.  This array will be used to prevent going into an infinite\n   * loop because we have circular references.  If seenObjects\n   * is set, then none of the Parse Objects that are serialized can be dirty.\n   */\n  Parse._encode = function (value, seenObjects, disallowObjects) {\n    var _ = Parse._\n    if (value instanceof Parse.Object) {\n      if (disallowObjects) {\n        throw new Error('Parse.Objects not allowed here')\n      }\n      if (!seenObjects || _.include(seenObjects, value) || !value._hasData) {\n        return value._toPointer()\n      }\n      if (!value.dirty()) {\n        seenObjects = seenObjects.concat(value)\n        return Parse._encode(value._toFullJSON(seenObjects),\n          seenObjects,\n          disallowObjects)\n      }\n      throw new Error('Tried to save an object with a pointer to a new, unsaved object.')\n    }\n    if (value instanceof Parse.ACL) {\n      return value.toJSON()\n    }\n    if (_.isDate(value)) {\n      if (isNaN(value)) {\n        throw new Error('Cannot encode invalid Date')\n      }\n      return { '__type': 'Date', 'iso': value.toJSON() }\n    }\n    if (value instanceof Parse.GeoPoint) {\n      return value.toJSON()\n    }\n    if (_.isArray(value)) {\n      return _.map(value, function (x) {\n        return Parse._encode(x, seenObjects, disallowObjects)\n      })\n    }\n    if (_.isRegExp(value)) {\n      return value.source\n    }\n    if (value instanceof Parse.Relation) {\n      return value.toJSON()\n    }\n    if (value instanceof Parse.Op) {\n      return value.toJSON()\n    }\n    if (value instanceof Parse.File) {\n      if (!value.url()) {\n        throw new Error('Tried to save an object containing an unsaved file.')\n      }\n      return {\n        __type: 'File',\n        name: value.name(),\n        url: value.url()\n      }\n    }\n    if (_.isObject(value)) {\n      var output = {}\n      Parse._objectEach(value, function (v, k) {\n        output[k] = Parse._encode(v, seenObjects, disallowObjects)\n      })\n      return output\n    }\n    return value\n  }\n\n  /**\n   * The inverse function of Parse._encode.\n   * TODO: make decode not mutate value.\n   */\n  Parse._decode = function (key, value) {\n    var _ = Parse._\n    if (!_.isObject(value)) {\n      return value\n    }\n    if (_.isArray(value)) {\n      Parse._arrayEach(value, function (v, k) {\n        value[k] = Parse._decode(k, v)\n      })\n      return value\n    }\n    if (value instanceof Parse.Object) {\n      return value\n    }\n    if (value instanceof Parse.File) {\n      return value\n    }\n    if (value instanceof Parse.Op) {\n      return value\n    }\n    if (value.__op) {\n      return Parse.Op._decode(value)\n    }\n    if (value.__type === 'Pointer' && value.className) {\n      var pointer = Parse.Object._create(value.className)\n      pointer._finishFetch({ objectId: value.objectId }, false)\n      return pointer\n    }\n    if (value.__type === 'Object' && value.className) {\n      // It's an Object included in a query result.\n      var className = value.className\n      delete value.__type\n      delete value.className\n      var object = Parse.Object._create(className)\n      object._finishFetch(value, true)\n      return object\n    }\n    if (value.__type === 'Date') {\n      return Parse._parseDate(value.iso)\n    }\n    if (value.__type === 'GeoPoint') {\n      return new Parse.GeoPoint({\n        latitude: value.latitude,\n        longitude: value.longitude\n      })\n    }\n    if (key === 'ACL') {\n      if (value instanceof Parse.ACL) {\n        return value\n      }\n      return new Parse.ACL(value)\n    }\n    if (value.__type === 'Relation') {\n      var relation = new Parse.Relation(null, key)\n      relation.targetClassName = value.className\n      return relation\n    }\n    if (value.__type === 'File') {\n      var file = new Parse.File(value.name)\n      file._url = value.url\n      return file\n    }\n    Parse._objectEach(value, function (v, k) {\n      value[k] = Parse._decode(k, v)\n    })\n    return value\n  }\n\n  Parse._arrayEach = Parse._.each\n\n  /**\n   * Does a deep traversal of every item in object, calling func on every one.\n   * @param {Object} object The object or array to traverse deeply.\n   * @param {Function} func The function to call for every item. It will\n   *     be passed the item as an argument. If it returns a truthy value, that\n   *     value will replace the item in its parent container.\n   * @returns {} the result of calling func on the top-level object itself.\n   */\n  Parse._traverse = function (object, func, seen) {\n    if (object instanceof Parse.Object) {\n      seen = seen || []\n      if (Parse._.indexOf(seen, object) >= 0) {\n        // We've already visited this object in this call.\n        return\n      }\n      seen.push(object)\n      Parse._traverse(object.attributes, func, seen)\n      return func(object)\n    }\n    if (object instanceof Parse.Relation || object instanceof Parse.File) {\n      // Nothing needs to be done, but we don't want to recurse into the\n      // object's parent infinitely, so we catch this case.\n      return func(object)\n    }\n    if (Parse._.isArray(object)) {\n      Parse._.each(object, function (child, index) {\n        var newChild = Parse._traverse(child, func, seen)\n        if (newChild) {\n          object[index] = newChild\n        }\n      })\n      return func(object)\n    }\n    if (Parse._.isObject(object)) {\n      Parse._each(object, function (child, key) {\n        var newChild = Parse._traverse(child, func, seen)\n        if (newChild) {\n          object[key] = newChild\n        }\n      })\n      return func(object)\n    }\n    return func(object)\n  }\n\n  /**\n   * This is like _.each, except:\n   * * it doesn't work for so-called array-like objects,\n   * * it does work for dictionaries with a \"length\" attribute.\n   */\n  Parse._objectEach = Parse._each = function (obj, callback) {\n    var _ = Parse._\n    if (_.isObject(obj)) {\n      _.each(_.keys(obj), function (key) {\n        callback(obj[key], key)\n      })\n    } else {\n      _.each(obj, callback)\n    }\n  }\n\n  // Helper function to check null or undefined.\n  Parse._isNullOrUndefined = function (x) {\n    return Parse._.isNull(x) || Parse._.isUndefined(x)\n  }\n}(this))\n\n/* global require: false, localStorage: false */\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n\n  var Storage = {\n    async: false\n  }\n\n  var hasLocalStorage = (typeof localStorage !== 'undefined')\n  if (hasLocalStorage) {\n    try {\n      localStorage.setItem('supported', true)\n      localStorage.removeItem('supported')\n    } catch (e) {\n      hasLocalStorage = false\n    }\n  }\n  if (hasLocalStorage) {\n    Storage.getItem = function (path) {\n      return localStorage.getItem(path)\n    }\n\n    Storage.setItem = function (path, value) {\n      return localStorage.setItem(path, value)\n    }\n\n    Storage.removeItem = function (path) {\n      return localStorage.removeItem(path)\n    }\n\n    Storage.clear = function () {\n      return localStorage.clear()\n    }\n  } else if (typeof require === 'function' && typeof (require.ensure) === 'undefined') {\n    var AsyncStorage\n    try {\n      AsyncStorage = require('AsyncStorage')\n\n      Storage.async = true\n\n      Storage.getItemAsync = function (path) {\n        var p = new Parse.Promise()\n        AsyncStorage.getItem(path, function (err, value) {\n          if (err) {\n            p.reject(err)\n          } else {\n            p.resolve(value)\n          }\n        })\n        return p\n      }\n\n      Storage.setItemAsync = function (path, value) {\n        var p = new Parse.Promise()\n        AsyncStorage.setItem(path, value, function (err) {\n          if (err) {\n            p.reject(err)\n          } else {\n            p.resolve(value)\n          }\n        })\n        return p\n      }\n\n      Storage.removeItemAsync = function (path) {\n        var p = new Parse.Promise()\n        AsyncStorage.removeItem(path, function (err) {\n          if (err) {\n            p.reject(err)\n          } else {\n            p.resolve()\n          }\n        })\n        return p\n      }\n\n      Storage.clear = function () {\n        AsyncStorage.clear()\n      }\n    } catch (e) {}\n  }\n  if (!Storage.async && !Storage.getItem) {\n    var memMap = Storage.inMemoryMap = {}\n    Storage.getItem = function (path) {\n      if (memMap.hasOwnProperty(path)) {\n        return memMap[path]\n      }\n      return null\n    }\n\n    Storage.setItem = function (path, value) {\n      memMap[path] = String(value)\n    }\n\n    Storage.removeItem = function (path) {\n      delete memMap[path]\n    }\n\n    Storage.clear = function () {\n      for (var key in memMap) {\n        if (memMap.hasOwnProperty(key)) {\n          delete memMap[key]\n        }\n      }\n    }\n  }\n\n  // We can use synchronous methods from async scenarios, but not vice-versa\n  if (!Storage.async) {\n    Storage.getItemAsync = function (path) {\n      return Parse.Promise.as(\n        Storage.getItem(path)\n      )\n    }\n\n    Storage.setItemAsync = function (path, value) {\n      Storage.setItem(path, value)\n      return Parse.Promise.as(value)\n    }\n\n    Storage.removeItemAsync = function (path) {\n      return Parse.Promise.as(\n        Storage.removeItem(path)\n      )\n    }\n  }\n\n  Parse.Storage = Storage\n})(this)\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  /**\n   * @namespace Provides an interface to Parse's logging and analytics backend.\n   */\n  Parse.Analytics = Parse.Analytics || {}\n\n  _.extend(Parse.Analytics, /** @lends Parse.Analytics */ {\n    /**\n     * Tracks the occurrence of a custom event with additional dimensions.\n     * Parse will store a data point at the time of invocation with the given\n     * event name.\n     *\n     * Dimensions will allow segmentation of the occurrences of this custom\n     * event. Keys and values should be {@code String}s, and will throw\n     * otherwise.\n     *\n     * To track a user signup along with additional metadata, consider the\n     * following:\n     * <pre>\n     * var dimensions = {\n     *  gender: 'm',\n     *  source: 'web',\n     *  dayType: 'weekend'\n     * }\n     * Parse.Analytics.track('signup', dimensions)\n     * </pre>\n     *\n     * There is a default limit of 8 dimensions per event tracked.\n     *\n     * @param {String} name The name of the custom event to report to Parse as\n     * having happened.\n     * @param {Object} dimensions The dictionary of information by which to\n     * segment this event.\n     * @param {Object} options A Backbone-style callback object.\n     * @return {Parse.Promise} A promise that is resolved when the round-trip\n     * to the server completes.\n     */\n    track: function (name, dimensions, options) {\n      name = name || ''\n      name = name.replace(/^\\s*/, '')\n      name = name.replace(/\\s*$/, '')\n      if (name.length === 0) {\n        throw new Error('A name for the custom event must be provided')\n      }\n\n      _.each(dimensions, function (val, key) {\n        if (!_.isString(key) || !_.isString(val)) {\n          throw new Error('track() dimensions expects keys and values of type \"string\".')\n        }\n      })\n\n      options = options || {}\n      return Parse._request({\n        route: 'events',\n        className: name,\n        method: 'POST',\n        data: { dimensions: dimensions }\n      })._thenRunCallbacks(options)\n    }\n  })\n}(this))\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  /**\n   * @class Parse.Config is a local representation of configuration data that\n   * can be set from the Parse dashboard.\n   */\n  Parse.Config = function () {\n    this.attributes = {}\n    this._escapedAttributes = {}\n  }\n\n  /**\n   * Retrieves the most recently-fetched configuration object, either from\n   * memory or from local storage if necessary.\n   *\n   * @return {Parse.Config} The most recently-fetched Parse.Config if it\n   *     exists, else an empty Parse.Config.\n   */\n  Parse.Config.current = function () {\n    if (Parse.Config._currentConfig) {\n      return Parse.Config._currentConfig\n    }\n\n    var config = new Parse.Config()\n\n    if (Parse.Storage.async) {\n      return config\n    }\n\n    var configData = Parse.Storage.getItem(Parse._getParsePath(\n      Parse.Config._CURRENT_CONFIG_KEY))\n\n    if (configData) {\n      config._finishFetch(JSON.parse(configData))\n      Parse.Config._currentConfig = config\n    }\n    return config\n  }\n\n  /**\n   * Gets a new configuration object from the server.\n   * @param {Object} options A Backbone-style options object.\n   * Valid options are:<ul>\n   *   <li>success: Function to call when the get completes successfully.\n   *   <li>error: Function to call when the get fails.\n   * </ul>\n   * @return {Parse.Promise} A promise that is resolved with a newly-created\n   *     configuration object when the get completes.\n   */\n  Parse.Config.get = function (options) {\n    options = options || {}\n\n    var request = Parse._request({\n      route: 'config',\n      method: 'GET'\n    })\n\n    return request.then(function (response) {\n      if (!response || !response.params) {\n        var errorObject = new Parse.Error(\n          Parse.Error.INVALID_JSON,\n          'Config JSON response invalid.')\n        return Parse.Promise.error(errorObject)\n      }\n\n      var config = new Parse.Config()\n      config._finishFetch(response)\n      Parse.Config._currentConfig = config\n      return config\n    })._thenRunCallbacks(options)\n  }\n\n  Parse.Config.prototype = {\n\n    /**\n     * Gets the HTML-escaped value of an attribute.\n     */\n    escape: function (attr) {\n      var html = this._escapedAttributes[attr]\n      if (html) {\n        return html\n      }\n      var val = this.attributes[attr]\n      var escaped\n      if (Parse._isNullOrUndefined(val)) {\n        escaped = ''\n      } else {\n        escaped = _.escape(val.toString())\n      }\n      this._escapedAttributes[attr] = escaped\n      return escaped\n    },\n\n    /**\n     * Gets the value of an attribute.\n     * @param {String} attr The name of an attribute.\n     */\n    get: function (attr) {\n      return this.attributes[attr]\n    },\n\n    _finishFetch: function (serverData) {\n      this.attributes = Parse._decode(null, _.clone(serverData.params))\n      if (!Parse.Storage.async) {\n        // We only provide local caching of config with synchronous Storage\n        Parse.Storage.setItem(\n          Parse._getParsePath(Parse.Config._CURRENT_CONFIG_KEY),\n          JSON.stringify(serverData))\n      }\n    }\n  }\n\n  Parse.Config._currentConfig = null\n\n  Parse.Config._CURRENT_CONFIG_KEY = 'currentConfig'\n}(this))\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  /**\n   * Constructs a new Parse.Error object with the given code and message.\n   * @param {Number} code An error code constant from <code>Parse.Error</code>.\n   * @param {String} message A detailed description of the error.\n   * @class\n   *\n   * <p>Class used for all objects passed to error callbacks.</p>\n   */\n  Parse.Error = function (code, message) {\n    this.code = code\n    this.message = message\n  }\n\n  _.extend(Parse.Error, /** @lends Parse.Error */ {\n    /**\n     * Error code indicating some error other than those enumerated here.\n     * @constant\n     */\n    OTHER_CAUSE: -1,\n\n    /**\n     * Error code indicating that something has gone wrong with the server.\n     * If you get this error code, it is Parse's fault. Contact us at\n     * https://parse.com/help\n     * @constant\n     */\n    INTERNAL_SERVER_ERROR: 1,\n\n    /**\n     * Error code indicating the connection to the Parse servers failed.\n     * @constant\n     */\n    CONNECTION_FAILED: 100,\n\n    /**\n     * Error code indicating the specified object doesn't exist.\n     * @constant\n     */\n    OBJECT_NOT_FOUND: 101,\n\n    /**\n     * Error code indicating you tried to query with a datatype that doesn't\n     * support it, like exact matching an array or object.\n     * @constant\n     */\n    INVALID_QUERY: 102,\n\n    /**\n     * Error code indicating a missing or invalid classname. Classnames are\n     * case-sensitive. They must start with a letter, and a-zA-Z0-9_ are the\n     * only valid characters.\n     * @constant\n     */\n    INVALID_CLASS_NAME: 103,\n\n    /**\n     * Error code indicating an unspecified object id.\n     * @constant\n     */\n    MISSING_OBJECT_ID: 104,\n\n    /**\n     * Error code indicating an invalid key name. Keys are case-sensitive. They\n     * must start with a letter, and a-zA-Z0-9_ are the only valid characters.\n     * @constant\n     */\n    INVALID_KEY_NAME: 105,\n\n    /**\n     * Error code indicating a malformed pointer. You should not see this unless\n     * you have been mucking about changing internal Parse code.\n     * @constant\n     */\n    INVALID_POINTER: 106,\n\n    /**\n     * Error code indicating that badly formed JSON was received upstream. This\n     * either indicates you have done something unusual with modifying how\n     * things encode to JSON, or the network is failing badly.\n     * @constant\n     */\n    INVALID_JSON: 107,\n\n    /**\n     * Error code indicating that the feature you tried to access is only\n     * available internally for testing purposes.\n     * @constant\n     */\n    COMMAND_UNAVAILABLE: 108,\n\n    /**\n     * You must call Parse.initialize before using the Parse library.\n     * @constant\n     */\n    NOT_INITIALIZED: 109,\n\n    /**\n     * Error code indicating that a field was set to an inconsistent type.\n     * @constant\n     */\n    INCORRECT_TYPE: 111,\n\n    /**\n     * Error code indicating an invalid channel name. A channel name is either\n     * an empty string (the broadcast channel) or contains only a-zA-Z0-9_\n     * characters and starts with a letter.\n     * @constant\n     */\n    INVALID_CHANNEL_NAME: 112,\n\n    /**\n     * Error code indicating that push is misconfigured.\n     * @constant\n     */\n    PUSH_MISCONFIGURED: 115,\n\n    /**\n     * Error code indicating that the object is too large.\n     * @constant\n     */\n    OBJECT_TOO_LARGE: 116,\n\n    /**\n     * Error code indicating that the operation isn't allowed for clients.\n     * @constant\n     */\n    OPERATION_FORBIDDEN: 119,\n\n    /**\n     * Error code indicating the result was not found in the cache.\n     * @constant\n     */\n    CACHE_MISS: 120,\n\n    /**\n     * Error code indicating that an invalid key was used in a nested\n     * JSONObject.\n     * @constant\n     */\n    INVALID_NESTED_KEY: 121,\n\n    /**\n     * Error code indicating that an invalid filename was used for ParseFile.\n     * A valid file name contains only a-zA-Z0-9_. characters and is between 1\n     * and 128 characters.\n     * @constant\n     */\n    INVALID_FILE_NAME: 122,\n\n    /**\n     * Error code indicating an invalid ACL was provided.\n     * @constant\n     */\n    INVALID_ACL: 123,\n\n    /**\n     * Error code indicating that the request timed out on the server. Typically\n     * this indicates that the request is too expensive to run.\n     * @constant\n     */\n    TIMEOUT: 124,\n\n    /**\n     * Error code indicating that the email address was invalid.\n     * @constant\n     */\n    INVALID_EMAIL_ADDRESS: 125,\n\n    /**\n     * Error code indicating a missing content type.\n     * @constant\n     */\n    MISSING_CONTENT_TYPE: 126,\n\n    /**\n     * Error code indicating a missing content length.\n     * @constant\n     */\n    MISSING_CONTENT_LENGTH: 127,\n\n    /**\n     * Error code indicating an invalid content length.\n     * @constant\n     */\n    INVALID_CONTENT_LENGTH: 128,\n\n    /**\n     * Error code indicating a file that was too large.\n     * @constant\n     */\n    FILE_TOO_LARGE: 129,\n\n    /**\n     * Error code indicating an error saving a file.\n     * @constant\n     */\n    FILE_SAVE_ERROR: 130,\n\n    /**\n     * Error code indicating that a unique field was given a value that is\n     * already taken.\n     * @constant\n     */\n    DUPLICATE_VALUE: 137,\n\n    /**\n     * Error code indicating that a role's name is invalid.\n     * @constant\n     */\n    INVALID_ROLE_NAME: 139,\n\n    /**\n     * Error code indicating that an application quota was exceeded.  Upgrade to\n     * resolve.\n     * @constant\n     */\n    EXCEEDED_QUOTA: 140,\n\n    /**\n     * Error code indicating that a Cloud Code script failed.\n     * @constant\n     */\n    SCRIPT_FAILED: 141,\n\n    /**\n     * Error code indicating that a Cloud Code validation failed.\n     * @constant\n     */\n    VALIDATION_ERROR: 142,\n\n    /**\n     * Error code indicating that invalid image data was provided.\n     * @constant\n     */\n    INVALID_IMAGE_DATA: 150,\n\n    /**\n     * Error code indicating an unsaved file.\n     * @constant\n     */\n    UNSAVED_FILE_ERROR: 151,\n\n    /**\n     * Error code indicating an invalid push time.\n     */\n    INVALID_PUSH_TIME_ERROR: 152,\n\n    /**\n     * Error code indicating an error deleting a file.\n     * @constant\n     */\n    FILE_DELETE_ERROR: 153,\n\n    /**\n     * Error code indicating that the application has exceeded its request\n     * limit.\n     * @constant\n     */\n    REQUEST_LIMIT_EXCEEDED: 155,\n\n    /**\n     * Error code indicating an invalid event name.\n     */\n    INVALID_EVENT_NAME: 160,\n\n    /**\n     * Error code indicating that the username is missing or empty.\n     * @constant\n     */\n    USERNAME_MISSING: 200,\n\n    /**\n     * Error code indicating that the password is missing or empty.\n     * @constant\n     */\n    PASSWORD_MISSING: 201,\n\n    /**\n     * Error code indicating that the username has already been taken.\n     * @constant\n     */\n    USERNAME_TAKEN: 202,\n\n    /**\n     * Error code indicating that the email has already been taken.\n     * @constant\n     */\n    EMAIL_TAKEN: 203,\n\n    /**\n     * Error code indicating that the email is missing, but must be specified.\n     * @constant\n     */\n    EMAIL_MISSING: 204,\n\n    /**\n     * Error code indicating that a user with the specified email was not found.\n     * @constant\n     */\n    EMAIL_NOT_FOUND: 205,\n\n    /**\n     * Error code indicating that a user object without a valid session could\n     * not be altered.\n     * @constant\n     */\n    SESSION_MISSING: 206,\n\n    /**\n     * Error code indicating that a user can only be created through signup.\n     * @constant\n     */\n    MUST_CREATE_USER_THROUGH_SIGNUP: 207,\n\n    /**\n     * Error code indicating that an an account being linked is already linked\n     * to another user.\n     * @constant\n     */\n    ACCOUNT_ALREADY_LINKED: 208,\n\n    /**\n     * Error code indicating that the current session token is invalid.\n     * @constant\n     */\n    INVALID_SESSION_TOKEN: 209,\n\n    /**\n     * Error code indicating that a user cannot be linked to an account because\n     * that account's id could not be found.\n     * @constant\n     */\n    LINKED_ID_MISSING: 250,\n\n    /**\n     * Error code indicating that a user with a linked (e.g. Facebook) account\n     * has an invalid session.\n     * @constant\n     */\n    INVALID_LINKED_SESSION: 251,\n\n    /**\n     * Error code indicating that a service being linked (e.g. Facebook or\n     * Twitter) is unsupported.\n     * @constant\n     */\n    UNSUPPORTED_SERVICE: 252,\n\n    /**\n     * Error code indicating that there were multiple errors. Aggregate errors\n     * have an \"errors\" property, which is an array of error objects with more\n     * detail about each error that occurred.\n     * @constant\n     */\n    AGGREGATE_ERROR: 600,\n\n    /**\n     * Error code indicating the client was unable to read an input file.\n     * @constant\n     */\n    FILE_READ_ERROR: 601,\n\n    /**\n     * Error code indicating a real error code is unavailable because\n     * we had to use an XDomainRequest object to allow CORS requests in\n     * Internet Explorer, which strips the body from HTTP responses that have\n     * a non-2XX status code.\n     * @constant\n     */\n    X_DOMAIN_REQUEST: 602\n  })\n}(this))\n\n;(function () {\n  var root = this\n  var Parse = (root.Parse || (root.Parse = {}))\n  var eventSplitter = /\\s+/\n  var slice = Array.prototype.slice\n\n  /**\n   * @class\n   *\n   * <p>Parse.Events is a fork of Backbone's Events module, provided for your\n   * convenience.</p>\n   *\n   * <p>A module that can be mixed in to any object in order to provide\n   * it with custom events. You may bind callback functions to an event\n   * with `on`, or remove these functions with `off`.\n   * Triggering an event fires all callbacks in the order that `on` was\n   * called.\n   *\n   * <pre>\n   *     var object = {}\n   *     _.extend(object, Parse.Events)\n   *     object.on('expand', function(){ alert('expanded'); })\n   *     object.trigger('expand');</pre></p>\n   *\n   * <p>For more information, see the\n   * <a href=\"http://documentcloud.github.com/backbone/#Events\">Backbone\n   * documentation</a>.</p>\n   */\n  Parse.Events = {\n    /**\n     * Bind one or more space separated events, `events`, to a `callback`\n     * function. Passing `\"all\"` will bind the callback to all events fired.\n     */\n    on: function (events, callback, context) {\n      var calls, event, node, tail, list\n      if (!callback) {\n        return this\n      }\n      events = events.split(eventSplitter)\n      calls = this._callbacks || (this._callbacks = {})\n\n      // Create an immutable callback list, allowing traversal during\n      // modification.  The tail is an empty object that will always be used\n      // as the next node.\n      event = events.shift()\n      while (event) {\n        list = calls[event]\n        node = list ? list.tail : {}\n        node.next = tail = {}\n        node.context = context\n        node.callback = callback\n        calls[event] = {tail: tail, next: list ? list.next : node}\n        event = events.shift()\n      }\n\n      return this\n    },\n\n    /**\n     * Remove one or many callbacks. If `context` is null, removes all callbacks\n     * with that function. If `callback` is null, removes all callbacks for the\n     * event. If `events` is null, removes all bound callbacks for all events.\n     */\n    off: function (events, callback, context) {\n      var event, calls, node, tail, cb, ctx\n\n      // No events, or removing *all* events.\n      if (!(calls = this._callbacks)) {\n        return\n      }\n      if (!(events || callback || context)) {\n        delete this._callbacks\n        return this\n      }\n\n      // Loop through the listed events and contexts, splicing them out of the\n      // linked list of callbacks if appropriate.\n      events = events ? events.split(eventSplitter) : Object.keys(calls)\n      event = events.shift()\n      while (event) {\n        node = calls[event]\n        delete calls[event]\n        if (!node || !(callback || context)) {\n          event = events.shift()\n          continue\n        }\n        // Create a new list, omitting the indicated callbacks.\n        tail = node.tail\n        node = node.next\n        while (node !== tail) {\n          cb = node.callback\n          ctx = node.context\n          if ((callback && cb !== callback) || (context && ctx !== context)) {\n            this.on(event, cb, ctx)\n          }\n          node = node.next\n        }\n        event = events.shift()\n      }\n\n      return this\n    },\n\n    /**\n     * Trigger one or many events, firing all bound callbacks. Callbacks are\n     * passed the same arguments as `trigger` is, apart from the event name\n     * (unless you're listening on `\"all\"`, which will cause your callback to\n     * receive the true name of the event as the first argument).\n     */\n    trigger: function (events) {\n      var event, node, calls, tail, args, all, rest\n      if (!(calls = this._callbacks)) {\n        return this\n      }\n      all = calls.all\n      events = events.split(eventSplitter)\n      rest = slice.call(arguments, 1)\n\n      // For each event, walk through the linked list of callbacks twice,\n      // first to trigger the event, then to trigger any `\"all\"` callbacks.\n      event = events.shift()\n      while (event) {\n        node = calls[event]\n        if (node) {\n          tail = node.tail\n          while ((node = node.next) !== tail) {\n            node.callback.apply(node.context || this, rest)\n          }\n        }\n        node = all\n        if (node) {\n          tail = node.tail\n          args = [event].concat(rest)\n          while ((node = node.next) !== tail) {\n            node.callback.apply(node.context || this, args)\n          }\n        }\n        event = events.shift()\n      }\n\n      return this\n    }\n  }\n\n  /**\n   * @function\n   */\n  Parse.Events.bind = Parse.Events.on\n\n  /**\n   * @function\n   */\n  Parse.Events.unbind = Parse.Events.off\n}.call(this))\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  /**\n   * Creates a new GeoPoint with any of the following forms:<br>\n   *   <pre>\n   *   new GeoPoint(otherGeoPoint)\n   *   new GeoPoint(30, 30)\n   *   new GeoPoint([30, 30])\n   *   new GeoPoint({latitude: 30, longitude: 30})\n   *   new GeoPoint()  // defaults to (0, 0)\n   *   </pre>\n   * @class\n   *\n   * <p>Represents a latitude / longitude point that may be associated\n   * with a key in a ParseObject or used as a reference point for geo queries.\n   * This allows proximity-based queries on the key.</p>\n   *\n   * <p>Only one key in a class may contain a GeoPoint.</p>\n   *\n   * <p>Example:<pre>\n   *   var point = new Parse.GeoPoint(30.0, -20.0)\n   *   var object = new Parse.Object(\"PlaceObject\")\n   *   object.set(\"location\", point)\n   *   object.save();</pre></p>\n   */\n  Parse.GeoPoint = function (arg1, arg2) {\n    if (_.isArray(arg1)) {\n      Parse.GeoPoint._validate(arg1[0], arg1[1])\n      this.latitude = arg1[0]\n      this.longitude = arg1[1]\n    } else if (_.isObject(arg1)) {\n      Parse.GeoPoint._validate(arg1.latitude, arg1.longitude)\n      this.latitude = arg1.latitude\n      this.longitude = arg1.longitude\n    } else if (_.isNumber(arg1) && _.isNumber(arg2)) {\n      Parse.GeoPoint._validate(arg1, arg2)\n      this.latitude = arg1\n      this.longitude = arg2\n    } else {\n      this.latitude = 0\n      this.longitude = 0\n    }\n\n    // Add properties so that anyone using Webkit or Mozilla will get an error\n    // if they try to set values that are out of bounds.\n    var self = this\n    if (this.__defineGetter__ && this.__defineSetter__) {\n      // Use _latitude and _longitude to actually store the values, and add\n      // getters and setters for latitude and longitude.\n      this._latitude = this.latitude\n      this._longitude = this.longitude\n      this.__defineGetter__('latitude', function () {\n        return self._latitude\n      })\n      this.__defineGetter__('longitude', function () {\n        return self._longitude\n      })\n      this.__defineSetter__('latitude', function (val) {\n        Parse.GeoPoint._validate(val, self.longitude)\n        self._latitude = val\n      })\n      this.__defineSetter__('longitude', function (val) {\n        Parse.GeoPoint._validate(self.latitude, val)\n        self._longitude = val\n      })\n    }\n  }\n\n  /**\n   * @lends Parse.GeoPoint.prototype\n   * @property {float} latitude North-south portion of the coordinate, in range\n   *   [-90, 90].  Throws an exception if set out of range in a modern browser.\n   * @property {float} longitude East-west portion of the coordinate, in range\n   *   [-180, 180].  Throws if set out of range in a modern browser.\n   */\n\n  /**\n   * Throws an exception if the given lat-long is out of bounds.\n   */\n  Parse.GeoPoint._validate = function (latitude, longitude) {\n    if (latitude < -90.0) {\n      throw new Error('Parse.GeoPoint latitude ' + latitude + ' < -90.0.')\n    }\n    if (latitude > 90.0) {\n      throw new Error('Parse.GeoPoint latitude ' + latitude + ' > 90.0.')\n    }\n    if (longitude < -180.0) {\n      throw new Error('Parse.GeoPoint longitude ' + longitude + ' < -180.0.')\n    }\n    if (longitude > 180.0) {\n      throw new Error('Parse.GeoPoint longitude ' + longitude + ' > 180.0.')\n    }\n  }\n\n  /**\n   * Creates a GeoPoint with the user's current location, if available.\n   * Calls options.success with a new GeoPoint instance or calls options.error.\n   * @param {Object} options An object with success and error callbacks.\n   */\n  Parse.GeoPoint.current = function (options) {\n    var promise = new Parse.Promise()\n    navigator.geolocation.getCurrentPosition(function (location) {\n      promise.resolve(new Parse.GeoPoint({\n        latitude: location.coords.latitude,\n        longitude: location.coords.longitude\n      }))\n    }, function (error) {\n      promise.reject(error)\n    })\n\n    return promise._thenRunCallbacks(options)\n  }\n\n  Parse.GeoPoint.prototype = {\n    /**\n     * Returns a JSON representation of the GeoPoint, suitable for Parse.\n     * @return {Object}\n     */\n    toJSON: function () {\n      Parse.GeoPoint._validate(this.latitude, this.longitude)\n      return {\n        '__type': 'GeoPoint',\n        latitude: this.latitude,\n        longitude: this.longitude\n      }\n    },\n\n    /**\n     * Returns the distance from this GeoPoint to another in radians.\n     * @param {Parse.GeoPoint} point the other Parse.GeoPoint.\n     * @return {Number}\n     */\n    radiansTo: function (point) {\n      var d2r = Math.PI / 180.0\n      var lat1rad = this.latitude * d2r\n      var long1rad = this.longitude * d2r\n      var lat2rad = point.latitude * d2r\n      var long2rad = point.longitude * d2r\n      var deltaLat = lat1rad - lat2rad\n      var deltaLong = long1rad - long2rad\n      var sinDeltaLatDiv2 = Math.sin(deltaLat / 2)\n      var sinDeltaLongDiv2 = Math.sin(deltaLong / 2)\n      // Square of half the straight line chord distance between both points.\n      var a = ((sinDeltaLatDiv2 * sinDeltaLatDiv2) +\n        (Math.cos(lat1rad) * Math.cos(lat2rad) *\n        sinDeltaLongDiv2 * sinDeltaLongDiv2))\n      a = Math.min(1.0, a)\n      return 2 * Math.asin(Math.sqrt(a))\n    },\n\n    /**\n     * Returns the distance from this GeoPoint to another in kilometers.\n     * @param {Parse.GeoPoint} point the other Parse.GeoPoint.\n     * @return {Number}\n     */\n    kilometersTo: function (point) {\n      return this.radiansTo(point) * 6371.0\n    },\n\n    /**\n     * Returns the distance from this GeoPoint to another in miles.\n     * @param {Parse.GeoPoint} point the other Parse.GeoPoint.\n     * @return {Number}\n     */\n    milesTo: function (point) {\n      return this.radiansTo(point) * 3958.8\n    }\n  }\n}(this))\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  var PUBLIC_KEY = '*'\n\n  /**\n   * Creates a new ACL.\n   * If no argument is given, the ACL has no permissions for anyone.\n   * If the argument is a Parse.User, the ACL will have read and write\n   *   permission for only that user.\n   * If the argument is any other JSON object, that object will be interpretted\n   *   as a serialized ACL created with toJSON().\n   * @see Parse.Object#setACL\n   * @class\n   *\n   * <p>An ACL, or Access Control List can be added to any\n   * <code>Parse.Object</code> to restrict access to only a subset of users\n   * of your application.</p>\n   */\n  Parse.ACL = function (arg1) {\n    var self = this\n    self.permissionsById = {}\n    if (_.isObject(arg1)) {\n      if (arg1 instanceof Parse.User) {\n        self.setReadAccess(arg1, true)\n        self.setWriteAccess(arg1, true)\n      } else {\n        if (_.isFunction(arg1)) {\n          throw new Error('Parse.ACL() called with a function.  Did you forget ()?')\n        }\n        Parse._objectEach(arg1, function (accessList, userId) {\n          if (!_.isString(userId)) {\n            throw new Error('Tried to create an ACL with an invalid userId.')\n          }\n          self.permissionsById[userId] = {}\n          Parse._objectEach(accessList, function (allowed, permission) {\n            if (permission !== 'read' && permission !== 'write') {\n              throw new Error('Tried to create an ACL with an invalid permission type.')\n            }\n            if (!_.isBoolean(allowed)) {\n              throw new Error('Tried to create an ACL with an invalid permission value.')\n            }\n            self.permissionsById[userId][permission] = allowed\n          })\n        })\n      }\n    }\n  }\n\n  /**\n   * Returns a JSON-encoded version of the ACL.\n   * @return {Object}\n   */\n  Parse.ACL.prototype.toJSON = function () {\n    return _.clone(this.permissionsById)\n  }\n\n  Parse.ACL.prototype._setAccess = function (accessType, userId, allowed) {\n    if (userId instanceof Parse.User) {\n      userId = userId.id\n    } else if (userId instanceof Parse.Role) {\n      userId = 'role:' + userId.getName()\n    }\n    if (!_.isString(userId)) {\n      throw new Error('userId must be a string.')\n    }\n    if (!_.isBoolean(allowed)) {\n      throw new Error('allowed must be either true or false.')\n    }\n    var permissions = this.permissionsById[userId]\n    if (!permissions) {\n      if (!allowed) {\n        // The user already doesn't have this permission, so no action needed.\n        return\n      } else {\n        permissions = {}\n        this.permissionsById[userId] = permissions\n      }\n    }\n\n    if (allowed) {\n      this.permissionsById[userId][accessType] = true\n    } else {\n      delete permissions[accessType]\n      if (_.isEmpty(permissions)) {\n        delete permissions[userId]\n      }\n    }\n  }\n\n  Parse.ACL.prototype._getAccess = function (accessType, userId) {\n    if (userId instanceof Parse.User) {\n      userId = userId.id\n    } else if (userId instanceof Parse.Role) {\n      userId = 'role:' + userId.getName()\n    }\n    var permissions = this.permissionsById[userId]\n    if (!permissions) {\n      return false\n    }\n    return !!(permissions[accessType])\n  }\n\n  /**\n   * Set whether the given user is allowed to read this object.\n   * @param userId An instance of Parse.User or its objectId.\n   * @param {Boolean} allowed Whether that user should have read access.\n   */\n  Parse.ACL.prototype.setReadAccess = function (userId, allowed) {\n    this._setAccess('read', userId, allowed)\n  }\n\n  /**\n   * Get whether the given user id is *explicitly* allowed to read this object.\n   * Even if this returns false, the user may still be able to access it if\n   * getPublicReadAccess returns true or a role that the user belongs to has\n   * write access.\n   * @param userId An instance of Parse.User or its objectId, or a Parse.Role.\n   * @return {Boolean}\n   */\n  Parse.ACL.prototype.getReadAccess = function (userId) {\n    return this._getAccess('read', userId)\n  }\n\n  /**\n   * Set whether the given user id is allowed to write this object.\n   * @param userId An instance of Parse.User or its objectId, or a Parse.Role..\n   * @param {Boolean} allowed Whether that user should have write access.\n   */\n  Parse.ACL.prototype.setWriteAccess = function (userId, allowed) {\n    this._setAccess('write', userId, allowed)\n  }\n\n  /**\n   * Get whether the given user id is *explicitly* allowed to write this object.\n   * Even if this returns false, the user may still be able to write it if\n   * getPublicWriteAccess returns true or a role that the user belongs to has\n   * write access.\n   * @param userId An instance of Parse.User or its objectId, or a Parse.Role.\n   * @return {Boolean}\n   */\n  Parse.ACL.prototype.getWriteAccess = function (userId) {\n    return this._getAccess('write', userId)\n  }\n\n  /**\n   * Set whether the public is allowed to read this object.\n   * @param {Boolean} allowed\n   */\n  Parse.ACL.prototype.setPublicReadAccess = function (allowed) {\n    this.setReadAccess(PUBLIC_KEY, allowed)\n  }\n\n  /**\n   * Get whether the public is allowed to read this object.\n   * @return {Boolean}\n   */\n  Parse.ACL.prototype.getPublicReadAccess = function () {\n    return this.getReadAccess(PUBLIC_KEY)\n  }\n\n  /**\n   * Set whether the public is allowed to write this object.\n   * @param {Boolean} allowed\n   */\n  Parse.ACL.prototype.setPublicWriteAccess = function (allowed) {\n    this.setWriteAccess(PUBLIC_KEY, allowed)\n  }\n\n  /**\n   * Get whether the public is allowed to write this object.\n   * @return {Boolean}\n   */\n  Parse.ACL.prototype.getPublicWriteAccess = function () {\n    return this.getWriteAccess(PUBLIC_KEY)\n  }\n\n  /**\n   * Get whether users belonging to the given role are allowed\n   * to read this object. Even if this returns false, the role may\n   * still be able to write it if a parent role has read access.\n   *\n   * @param role The name of the role, or a Parse.Role object.\n   * @return {Boolean} true if the role has read access. false otherwise.\n   * @throws {String} If role is neither a Parse.Role nor a String.\n   */\n  Parse.ACL.prototype.getRoleReadAccess = function (role) {\n    if (role instanceof Parse.Role) {\n      // Normalize to the String name\n      role = role.getName()\n    }\n    if (_.isString(role)) {\n      return this.getReadAccess('role:' + role)\n    }\n    throw new Error('role must be a Parse.Role or a String')\n  }\n\n  /**\n   * Get whether users belonging to the given role are allowed\n   * to write this object. Even if this returns false, the role may\n   * still be able to write it if a parent role has write access.\n   *\n   * @param role The name of the role, or a Parse.Role object.\n   * @return {Boolean} true if the role has write access. false otherwise.\n   * @throws {String} If role is neither a Parse.Role nor a String.\n   */\n  Parse.ACL.prototype.getRoleWriteAccess = function (role) {\n    if (role instanceof Parse.Role) {\n      // Normalize to the String name\n      role = role.getName()\n    }\n    if (_.isString(role)) {\n      return this.getWriteAccess('role:' + role)\n    }\n    throw new Error('role must be a Parse.Role or a String')\n  }\n\n  /**\n   * Set whether users belonging to the given role are allowed\n   * to read this object.\n   *\n   * @param role The name of the role, or a Parse.Role object.\n   * @param {Boolean} allowed Whether the given role can read this object.\n   * @throws {String} If role is neither a Parse.Role nor a String.\n   */\n  Parse.ACL.prototype.setRoleReadAccess = function (role, allowed) {\n    if (role instanceof Parse.Role) {\n      // Normalize to the String name\n      role = role.getName()\n    }\n    if (_.isString(role)) {\n      this.setReadAccess('role:' + role, allowed)\n      return\n    }\n    throw new Error('role must be a Parse.Role or a String')\n  }\n\n  /**\n   * Set whether users belonging to the given role are allowed\n   * to write this object.\n   *\n   * @param role The name of the role, or a Parse.Role object.\n   * @param {Boolean} allowed Whether the given role can write this object.\n   * @throws {String} If role is neither a Parse.Role nor a String.\n   */\n  Parse.ACL.prototype.setRoleWriteAccess = function (role, allowed) {\n    if (role instanceof Parse.Role) {\n      // Normalize to the String name\n      role = role.getName()\n    }\n    if (_.isString(role)) {\n      this.setWriteAccess('role:' + role, allowed)\n      return\n    }\n    throw new Error('role must be a Parse.Role or a String')\n  }\n}(this))\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  /**\n   * @class\n   * A Parse.Op is an atomic operation that can be applied to a field in a\n   * Parse.Object. For example, calling <code>object.set(\"foo\", \"bar\")</code>\n   * is an example of a Parse.Op.Set. Calling <code>object.unset(\"foo\")</code>\n   * is a Parse.Op.Unset. These operations are stored in a Parse.Object and\n   * sent to the server as part of <code>object.save()</code> operations.\n   * Instances of Parse.Op should be immutable.\n   *\n   * You should not create subclasses of Parse.Op or instantiate Parse.Op\n   * directly.\n   */\n  Parse.Op = function () {\n    this._initialize.apply(this, arguments)\n  }\n\n  Parse.Op.prototype = {\n    _initialize: function () {}\n  }\n\n  _.extend(Parse.Op, {\n    /**\n     * To create a new Op, call Parse.Op._extend()\n     */\n    _extend: Parse._extend,\n\n    // A map of __op string to decoder function.\n    _opDecoderMap: {},\n\n    /**\n     * Registers a function to convert a json object with an __op field into an\n     * instance of a subclass of Parse.Op.\n     */\n    _registerDecoder: function (opName, decoder) {\n      Parse.Op._opDecoderMap[opName] = decoder\n    },\n\n    /**\n     * Converts a json object into an instance of a subclass of Parse.Op.\n     */\n    _decode: function (json) {\n      var decoder = Parse.Op._opDecoderMap[json.__op]\n      if (decoder) {\n        return decoder(json)\n      } else {\n        return undefined\n      }\n    }\n  })\n\n  /*\n   * Add a handler for Batch ops.\n   */\n  Parse.Op._registerDecoder('Batch', function (json) {\n    var op = null\n    Parse._arrayEach(json.ops, function (nextOp) {\n      nextOp = Parse.Op._decode(nextOp)\n      op = nextOp._mergeWithPrevious(op)\n    })\n    return op\n  })\n\n  /**\n   * @class\n   * A Set operation indicates that either the field was changed using\n   * Parse.Object.set, or it is a mutable container that was detected as being\n   * changed.\n   */\n  Parse.Op.Set = Parse.Op._extend({\n    _initialize: function (value) {\n      this._value = value\n    },\n\n    /**\n     * Returns the new value of this field after the set.\n     */\n    value: function () {\n      return this._value\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function () {\n      return Parse._encode(this.value())\n    },\n\n    _mergeWithPrevious: function (previous) {\n      return this\n    },\n\n    _estimate: function (oldValue) {\n      return this.value()\n    }\n  })\n\n  /**\n   * A sentinel value that is returned by Parse.Op.Unset._estimate to\n   * indicate the field should be deleted. Basically, if you find _UNSET as a\n   * value in your object, you should remove that key.\n   */\n  Parse.Op._UNSET = {}\n\n  /**\n   * @class\n   * An Unset operation indicates that this field has been deleted from the\n   * object.\n   */\n  Parse.Op.Unset = Parse.Op._extend({\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function () {\n      return { __op: 'Delete' }\n    },\n\n    _mergeWithPrevious: function (previous) {\n      return this\n    },\n\n    _estimate: function (oldValue) {\n      return Parse.Op._UNSET\n    }\n  })\n\n  Parse.Op._registerDecoder('Delete', function (json) {\n    return new Parse.Op.Unset()\n  })\n\n  /**\n   * @class\n   * An Increment is an atomic operation where the numeric value for the field\n   * will be increased by a given amount.\n   */\n  Parse.Op.Increment = Parse.Op._extend({\n    _initialize: function (amount) {\n      this._amount = amount\n    },\n\n    /**\n     * Returns the amount to increment by.\n     * @return {Number} the amount to increment by.\n     */\n    amount: function () {\n      return this._amount\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function () {\n      return { __op: 'Increment', amount: this._amount }\n    },\n\n    _mergeWithPrevious: function (previous) {\n      if (!previous) {\n        return this\n      } else if (previous instanceof Parse.Op.Unset) {\n        return new Parse.Op.Set(this.amount())\n      } else if (previous instanceof Parse.Op.Set) {\n        return new Parse.Op.Set(previous.value() + this.amount())\n      } else if (previous instanceof Parse.Op.Increment) {\n        return new Parse.Op.Increment(this.amount() + previous.amount())\n      } else {\n        throw new Error('Op is invalid after previous op.')\n      }\n    },\n\n    _estimate: function (oldValue) {\n      if (!oldValue) {\n        return this.amount()\n      }\n      return oldValue + this.amount()\n    }\n  })\n\n  Parse.Op._registerDecoder('Increment', function (json) {\n    return new Parse.Op.Increment(json.amount)\n  })\n\n  /**\n   * @class\n   * Add is an atomic operation where the given objects will be appended to the\n   * array that is stored in this field.\n   */\n  Parse.Op.Add = Parse.Op._extend({\n    _initialize: function (objects) {\n      this._objects = objects\n    },\n\n    /**\n     * Returns the objects to be added to the array.\n     * @return {Array} The objects to be added to the array.\n     */\n    objects: function () {\n      return this._objects\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function () {\n      return { __op: 'Add', objects: Parse._encode(this.objects()) }\n    },\n\n    _mergeWithPrevious: function (previous) {\n      if (!previous) {\n        return this\n      } else if (previous instanceof Parse.Op.Unset) {\n        return new Parse.Op.Set(this.objects())\n      } else if (previous instanceof Parse.Op.Set) {\n        return new Parse.Op.Set(this._estimate(previous.value()))\n      } else if (previous instanceof Parse.Op.Add) {\n        return new Parse.Op.Add(previous.objects().concat(this.objects()))\n      } else {\n        throw new Error('Op is invalid after previous op.')\n      }\n    },\n\n    _estimate: function (oldValue) {\n      if (!oldValue) {\n        return _.clone(this.objects())\n      } else {\n        return oldValue.concat(this.objects())\n      }\n    }\n  })\n\n  Parse.Op._registerDecoder('Add', function (json) {\n    return new Parse.Op.Add(Parse._decode(undefined, json.objects))\n  })\n\n  /**\n   * @class\n   * AddUnique is an atomic operation where the given items will be appended to\n   * the array that is stored in this field only if they were not already\n   * present in the array.\n   */\n  Parse.Op.AddUnique = Parse.Op._extend({\n    _initialize: function (objects) {\n      this._objects = _.uniq(objects)\n    },\n\n    /**\n     * Returns the objects to be added to the array.\n     * @return {Array} The objects to be added to the array.\n     */\n    objects: function () {\n      return this._objects\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function () {\n      return { __op: 'AddUnique', objects: Parse._encode(this.objects()) }\n    },\n\n    _mergeWithPrevious: function (previous) {\n      if (!previous) {\n        return this\n      } else if (previous instanceof Parse.Op.Unset) {\n        return new Parse.Op.Set(this.objects())\n      } else if (previous instanceof Parse.Op.Set) {\n        return new Parse.Op.Set(this._estimate(previous.value()))\n      } else if (previous instanceof Parse.Op.AddUnique) {\n        return new Parse.Op.AddUnique(this._estimate(previous.objects()))\n      } else {\n        throw new Error('Op is invalid after previous op.')\n      }\n    },\n\n    _estimate: function (oldValue) {\n      if (!oldValue) {\n        return _.clone(this.objects())\n      } else {\n        // We can't just take the _.uniq(_.union(...)) of oldValue and\n        // this.objects, because the uniqueness may not apply to oldValue\n        // (especially if the oldValue was set via .set())\n        var newValue = _.clone(oldValue)\n        Parse._arrayEach(this.objects(), function (obj) {\n          if (obj instanceof Parse.Object && obj.id) {\n            var matchingObj = _.find(newValue, function (anObj) {\n              return (anObj instanceof Parse.Object) && (anObj.id === obj.id)\n            })\n            if (!matchingObj) {\n              newValue.push(obj)\n            } else {\n              var index = _.indexOf(newValue, matchingObj)\n              newValue[index] = obj\n            }\n          } else if (!_.contains(newValue, obj)) {\n            newValue.push(obj)\n          }\n        })\n        return newValue\n      }\n    }\n  })\n\n  Parse.Op._registerDecoder('AddUnique', function (json) {\n    return new Parse.Op.AddUnique(Parse._decode(undefined, json.objects))\n  })\n\n  /**\n   * @class\n   * Remove is an atomic operation where the given objects will be removed from\n   * the array that is stored in this field.\n   */\n  Parse.Op.Remove = Parse.Op._extend({\n    _initialize: function (objects) {\n      this._objects = _.uniq(objects)\n    },\n\n    /**\n     * Returns the objects to be removed from the array.\n     * @return {Array} The objects to be removed from the array.\n     */\n    objects: function () {\n      return this._objects\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function () {\n      return { __op: 'Remove', objects: Parse._encode(this.objects()) }\n    },\n\n    _mergeWithPrevious: function (previous) {\n      if (!previous) {\n        return this\n      } else if (previous instanceof Parse.Op.Unset) {\n        return previous\n      } else if (previous instanceof Parse.Op.Set) {\n        return new Parse.Op.Set(this._estimate(previous.value()))\n      } else if (previous instanceof Parse.Op.Remove) {\n        return new Parse.Op.Remove(_.union(previous.objects(), this.objects()))\n      } else {\n        throw new Error('Op is invalid after previous op.')\n      }\n    },\n\n    _estimate: function (oldValue) {\n      if (!oldValue) {\n        return []\n      } else {\n        var newValue = _.difference(oldValue, this.objects())\n        // If there are saved Parse Objects being removed, also remove them.\n        Parse._arrayEach(this.objects(), function (obj) {\n          if (obj instanceof Parse.Object && obj.id) {\n            newValue = _.reject(newValue, function (other) {\n              return (other instanceof Parse.Object) && (other.id === obj.id)\n            })\n          }\n        })\n        return newValue\n      }\n    }\n  })\n\n  Parse.Op._registerDecoder('Remove', function (json) {\n    return new Parse.Op.Remove(Parse._decode(undefined, json.objects))\n  })\n\n  /**\n   * @class\n   * A Relation operation indicates that the field is an instance of\n   * Parse.Relation, and objects are being added to, or removed from, that\n   * relation.\n   */\n  Parse.Op.Relation = Parse.Op._extend({\n    _initialize: function (adds, removes) {\n      this._targetClassName = null\n\n      var self = this\n\n      var pointerToId = function (object) {\n        if (object instanceof Parse.Object) {\n          if (!object.id) {\n            throw new Error(\"You can't add an unsaved Parse.Object to a relation.\")\n          }\n          if (!self._targetClassName) {\n            self._targetClassName = object.className\n          }\n          if (self._targetClassName !== object.className) {\n            throw new Error('Tried to create a Parse.Relation with 2 different types: ' + self._targetClassName + ' and ' + object.className + '.')\n          }\n          return object.id\n        }\n        return object\n      }\n\n      this.relationsToAdd = _.uniq(_.map(adds, pointerToId))\n      this.relationsToRemove = _.uniq(_.map(removes, pointerToId))\n    },\n\n    /**\n     * Returns an array of unfetched Parse.Object that are being added to the\n     * relation.\n     * @return {Array}\n     */\n    added: function () {\n      var self = this\n      return _.map(this.relationsToAdd, function (objectId) {\n        var object = Parse.Object._create(self._targetClassName)\n        object.id = objectId\n        return object\n      })\n    },\n\n    /**\n     * Returns an array of unfetched Parse.Object that are being removed from\n     * the relation.\n     * @return {Array}\n     */\n    removed: function () {\n      var self = this\n      return _.map(this.relationsToRemove, function (objectId) {\n        var object = Parse.Object._create(self._targetClassName)\n        object.id = objectId\n        return object\n      })\n    },\n\n    /**\n     * Returns a JSON version of the operation suitable for sending to Parse.\n     * @return {Object}\n     */\n    toJSON: function () {\n      var adds = null\n      var removes = null\n      var self = this\n      var idToPointer = function (id) {\n        return { __type: 'Pointer',\n          className: self._targetClassName,\n        objectId: id }\n      }\n      var pointers = null\n      if (this.relationsToAdd.length > 0) {\n        pointers = _.map(this.relationsToAdd, idToPointer)\n        adds = { '__op': 'AddRelation', 'objects': pointers }\n      }\n\n      if (this.relationsToRemove.length > 0) {\n        pointers = _.map(this.relationsToRemove, idToPointer)\n        removes = { '__op': 'RemoveRelation', 'objects': pointers }\n      }\n\n      if (adds && removes) {\n        return {\n          __op: 'Batch',\n          ops: [\n            adds,\n            removes\n          ]\n        }\n      }\n\n      return adds || removes || {}\n    },\n\n    _mergeWithPrevious: function (previous) {\n      if (!previous) {\n        return this\n      } else if (previous instanceof Parse.Op.Unset) {\n        throw new Error(\"You can't modify a relation after deleting it.\")\n      } else if (previous instanceof Parse.Op.Relation) {\n        if (previous._targetClassName &&\n          previous._targetClassName !== this._targetClassName) {\n          throw new Error('Related object must be of class ' + previous._targetClassName + ', but ' + this._targetClassName + ' was passed in.')\n        }\n        var newAdd = _.union(_.difference(previous.relationsToAdd,\n          this.relationsToRemove),\n          this.relationsToAdd)\n        var newRemove = _.union(_.difference(previous.relationsToRemove,\n          this.relationsToAdd),\n          this.relationsToRemove)\n\n        var newRelation = new Parse.Op.Relation(newAdd, newRemove)\n        newRelation._targetClassName = this._targetClassName\n        return newRelation\n      } else {\n        throw new Error('Op is invalid after previous op.')\n      }\n    },\n\n    _estimate: function (oldValue, object, key) {\n      if (!oldValue) {\n        var relation = new Parse.Relation(object, key)\n        relation.targetClassName = this._targetClassName\n      } else if (oldValue instanceof Parse.Relation) {\n        if (this._targetClassName) {\n          if (oldValue.targetClassName) {\n            if (oldValue.targetClassName !== this._targetClassName) {\n              throw new Error('Related object must be a ' + oldValue.targetClassName + ', but a ' + this._targetClassName + ' was passed in.')\n            }\n          } else {\n            oldValue.targetClassName = this._targetClassName\n          }\n        }\n        return oldValue\n      } else {\n        throw new Error('Op is invalid after previous op.')\n      }\n    }\n  })\n\n  Parse.Op._registerDecoder('AddRelation', function (json) {\n    return new Parse.Op.Relation(Parse._decode(undefined, json.objects), [])\n  })\n  Parse.Op._registerDecoder('RemoveRelation', function (json) {\n    return new Parse.Op.Relation([], Parse._decode(undefined, json.objects))\n  })\n}(this))\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  /**\n   * Creates a new Relation for the given parent object and key. This\n   * constructor should rarely be used directly, but rather created by\n   * Parse.Object.relation.\n   * @param {Parse.Object} parent The parent of this relation.\n   * @param {String} key The key for this relation on the parent.\n   * @see Parse.Object#relation\n   * @class\n   *\n   * <p>\n   * A class that is used to access all of the children of a many-to-many\n   * relationship.  Each instance of Parse.Relation is associated with a\n   * particular parent object and key.\n   * </p>\n   */\n  Parse.Relation = function (parent, key) {\n    this.parent = parent\n    this.key = key\n    this.targetClassName = null\n  }\n\n  Parse.Relation.prototype = {\n    /**\n     * Makes sure that this relation has the right parent and key.\n     */\n    _ensureParentAndKey: function (parent, key) {\n      this.parent = this.parent || parent\n      this.key = this.key || key\n      if (this.parent !== parent) {\n        throw new Error('Internal Error. Relation retrieved from two different Objects.')\n      }\n      if (this.key !== key) {\n        throw new Error('Internal Error. Relation retrieved from two different keys.')\n      }\n    },\n\n    /**\n     * Adds a Parse.Object or an array of Parse.Objects to the relation.\n     * @param {} objects The item or items to add.\n     */\n    add: function (objects) {\n      if (!_.isArray(objects)) {\n        objects = [objects]\n      }\n\n      var change = new Parse.Op.Relation(objects, [])\n      this.parent.set(this.key, change)\n      this.targetClassName = change._targetClassName\n    },\n\n    /**\n     * Removes a Parse.Object or an array of Parse.Objects from this relation.\n     * @param {} objects The item or items to remove.\n     */\n    remove: function (objects) {\n      if (!_.isArray(objects)) {\n        objects = [objects]\n      }\n\n      var change = new Parse.Op.Relation([], objects)\n      this.parent.set(this.key, change)\n      this.targetClassName = change._targetClassName\n    },\n\n    /**\n     * Returns a JSON version of the object suitable for saving to disk.\n     * @return {Object}\n     */\n    toJSON: function () {\n      return { '__type': 'Relation', 'className': this.targetClassName }\n    },\n\n    /**\n     * Returns a Parse.Query that is limited to objects in this\n     * relation.\n     * @return {Parse.Query}\n     */\n    query: function () {\n      var targetClass\n      var query\n      if (!this.targetClassName) {\n        targetClass = Parse.Object._getSubclass(this.parent.className)\n        query = new Parse.Query(targetClass)\n        query._extraOptions.redirectClassNameForKey = this.key\n      } else {\n        targetClass = Parse.Object._getSubclass(this.targetClassName)\n        query = new Parse.Query(targetClass)\n      }\n      query._addCondition('$relatedTo', 'object', this.parent._toPointer())\n      query._addCondition('$relatedTo', 'key', this.key)\n\n      return query\n    }\n  }\n}(this))\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  /**\n   * A Promise is returned by async methods as a hook to provide callbacks to be\n   * called when the async task is fulfilled.\n   *\n   * <p>Typical usage would be like:<pre>\n   *    query.find().then(function(results) {\n   *      results[0].set(\"foo\", \"bar\")\n   *      return results[0].saveAsync()\n   *    }).then(function(result) {\n   *      console.log(\"Updated \" + result.id)\n   *    })\n   * </pre></p>\n   *\n   * @see Parse.Promise.prototype.then\n   * @class\n   */\n  Parse.Promise = function () {\n    this._resolved = false\n    this._rejected = false\n    this._resolvedCallbacks = []\n    this._rejectedCallbacks = []\n  }\n\n  _.extend(Parse.Promise, /** @lends Parse.Promise */ {\n    _isPromisesAPlusCompliant: false,\n\n    /**\n     * Returns true iff the given object fulfils the Promise interface.\n     * @return {Boolean}\n     */\n    is: function (promise) {\n      return promise && promise.then && _.isFunction(promise.then)\n    },\n\n    /**\n     * Returns a new promise that is resolved with a given value.\n     * @return {Parse.Promise} the new promise.\n     */\n    as: function () {\n      var promise = new Parse.Promise()\n      promise.resolve.apply(promise, arguments)\n      return promise\n    },\n\n    /**\n     * Returns a new promise that is rejected with a given error.\n     * @return {Parse.Promise} the new promise.\n     */\n    error: function () {\n      var promise = new Parse.Promise()\n      promise.reject.apply(promise, arguments)\n      return promise\n    },\n\n    /**\n     * Returns a new promise that is fulfilled when all of the input promises\n     * are resolved. If any promise in the list fails, then the returned promise\n     * will fail with the last error. If they all succeed, then the returned\n     * promise will succeed, with the results being the results of all the input\n     * promises. For example: <pre>\n     *   var p1 = Parse.Promise.as(1)\n     *   var p2 = Parse.Promise.as(2)\n     *   var p3 = Parse.Promise.as(3)\n     *\n     *   Parse.Promise.when(p1, p2, p3).then(function(r1, r2, r3) {\n     *     console.log(r1)  // prints 1\n     *     console.log(r2)  // prints 2\n     *     console.log(r3)  // prints 3\n     *   });</pre>\n     *\n     * The input promises can also be specified as an array: <pre>\n     *   var promises = [p1, p2, p3]\n     *   Parse.Promise.when(promises).then(function(r1, r2, r3) {\n     *     console.log(r1)  // prints 1\n     *     console.log(r2)  // prints 2\n     *     console.log(r3)  // prints 3\n     *   })\n     * </pre>\n     * @param {Array} promises a list of promises to wait for.\n     * @return {Parse.Promise} the new promise.\n     */\n    when: function (promises) {\n      // Allow passing in Promises as separate arguments instead of an Array.\n      var objects\n      if (promises && Parse._isNullOrUndefined(promises.length)) {\n        objects = arguments\n      } else {\n        objects = promises\n      }\n\n      var total = objects.length\n      var hadError = false\n      var results = []\n      var errors = []\n      results.length = objects.length\n      errors.length = objects.length\n\n      if (total === 0) {\n        return Parse.Promise.as.apply(this, results)\n      }\n\n      var promise = new Parse.Promise()\n\n      var resolveOne = function () {\n        total = total - 1\n        if (total === 0) {\n          if (hadError) {\n            promise.reject(errors)\n          } else {\n            promise.resolve.apply(promise, results)\n          }\n        }\n      }\n\n      Parse._arrayEach(objects, function (object, i) {\n        if (Parse.Promise.is(object)) {\n          object.then(function (result) {\n            results[i] = result\n            resolveOne()\n          }, function (error) {\n            errors[i] = error\n            hadError = true\n            resolveOne()\n          })\n        } else {\n          results[i] = object\n          resolveOne()\n        }\n      })\n\n      return promise\n    },\n\n    /**\n     * Runs the given asyncFunction repeatedly, as long as the predicate\n     * function returns a truthy value. Stops repeating if asyncFunction returns\n     * a rejected promise.\n     * @param {Function} predicate should return false when ready to stop.\n     * @param {Function} asyncFunction should return a Promise.\n     */\n    _continueWhile: function (predicate, asyncFunction) {\n      if (predicate()) {\n        return asyncFunction().then(function () {\n          return Parse.Promise._continueWhile(predicate, asyncFunction)\n        })\n      }\n      return Parse.Promise.as()\n    }\n  })\n\n  _.extend(Parse.Promise.prototype, /** @lends Parse.Promise.prototype */ {\n\n    /**\n     * Marks this promise as fulfilled, firing any callbacks waiting on it.\n     * @param {Object} result the result to pass to the callbacks.\n     */\n    resolve: function (result) {\n      if (this._resolved || this._rejected) {\n        throw new Error('A promise was resolved even though it had already been ' + (this._resolved ? 'resolved' : 'rejected') + '.')\n      }\n      this._resolved = true\n      this._result = arguments\n      var results = arguments\n      Parse._arrayEach(this._resolvedCallbacks, function (resolvedCallback) {\n        resolvedCallback.apply(this, results)\n      })\n      this._resolvedCallbacks = []\n      this._rejectedCallbacks = []\n    },\n\n    /**\n     * Marks this promise as fulfilled, firing any callbacks waiting on it.\n     * @param {Object} error the error to pass to the callbacks.\n     */\n    reject: function (error) {\n      if (this._resolved || this._rejected) {\n        throw new Error('A promise was rejected even though it had already been ' + (this._resolved ? 'resolved' : 'rejected') + '.')\n      }\n      this._rejected = true\n      this._error = error\n      Parse._arrayEach(this._rejectedCallbacks, function (rejectedCallback) {\n        rejectedCallback(error)\n      })\n      this._resolvedCallbacks = []\n      this._rejectedCallbacks = []\n    },\n\n    /**\n     * Adds callbacks to be called when this promise is fulfilled. Returns a new\n     * Promise that will be fulfilled when the callback is complete. It allows\n     * chaining. If the callback itself returns a Promise, then the one returned\n     * by \"then\" will not be fulfilled until that one returned by the callback\n     * is fulfilled.\n     * @param {Function} resolvedCallback Function that is called when this\n     * Promise is resolved. Once the callback is complete, then the Promise\n     * returned by \"then\" will also be fulfilled.\n     * @param {Function} rejectedCallback Function that is called when this\n     * Promise is rejected with an error. Once the callback is complete, then\n     * the promise returned by \"then\" with be resolved successfully. If\n     * rejectedCallback is null, or it returns a rejected Promise, then the\n     * Promise returned by \"then\" will be rejected with that error.\n     * @return {Parse.Promise} A new Promise that will be fulfilled after this\n     * Promise is fulfilled and either callback has completed. If the callback\n     * returned a Promise, then this Promise will not be fulfilled until that\n     * one is.\n     */\n    then: function (resolvedCallback, rejectedCallback) {\n      var promise = new Parse.Promise()\n\n      var wrappedResolvedCallback = function () {\n        var result = arguments\n        if (resolvedCallback) {\n          if (Parse.Promise._isPromisesAPlusCompliant) {\n            try {\n              result = [resolvedCallback.apply(this, result)]\n            } catch (e) {\n              result = [Parse.Promise.error(e)]\n            }\n          } else {\n            result = [resolvedCallback.apply(this, result)]\n          }\n        }\n        if (result.length === 1 && Parse.Promise.is(result[0])) {\n          result[0].then(function () {\n            promise.resolve.apply(promise, arguments)\n          }, function (error) {\n            promise.reject(error)\n          })\n        } else {\n          promise.resolve.apply(promise, result)\n        }\n      }\n\n      var wrappedRejectedCallback = function (error) {\n        var result = []\n        if (rejectedCallback) {\n          if (Parse.Promise._isPromisesAPlusCompliant) {\n            try {\n              result = [rejectedCallback(error)]\n            } catch (e) {\n              result = [Parse.Promise.error(e)]\n            }\n          } else {\n            result = [rejectedCallback(error)]\n          }\n          if (result.length === 1 && Parse.Promise.is(result[0])) {\n            result[0].then(function () {\n              promise.resolve.apply(promise, arguments)\n            }, function (error) {\n              promise.reject(error)\n            })\n          } else {\n            if (Parse.Promise._isPromisesAPlusCompliant) {\n              promise.resolve.apply(promise, result)\n            } else {\n              promise.reject(result[0])\n            }\n          }\n        } else {\n          promise.reject(error)\n        }\n      }\n\n      var runLater = function (func) {\n        func.call()\n      }\n      if (Parse.Promise._isPromisesAPlusCompliant) {\n        if (typeof (window) !== 'undefined' && window.setTimeout) {\n          runLater = function (func) {\n            window.setTimeout(func, 0)\n          }\n        } else if (typeof (process) !== 'undefined' && process.nextTick) {\n          runLater = function (func) {\n            process.nextTick(func)\n          }\n        }\n      }\n\n      var self = this\n      if (this._resolved) {\n        runLater(function () {\n          wrappedResolvedCallback.apply(self, self._result)\n        })\n      } else if (this._rejected) {\n        runLater(function () {\n          wrappedRejectedCallback(self._error)\n        })\n      } else {\n        this._resolvedCallbacks.push(wrappedResolvedCallback)\n        this._rejectedCallbacks.push(wrappedRejectedCallback)\n      }\n\n      return promise\n    },\n\n    /**\n     * Add handlers to be called when the promise\n     * is either resolved or rejected\n     */\n    always: function (callback) {\n      return this.then(callback, callback)\n    },\n\n    /**\n     * Add handlers to be called when the Promise object is resolved\n     */\n    done: function (callback) {\n      return this.then(callback)\n    },\n\n    /**\n     * Add handlers to be called when the Promise object is rejected\n     */\n    fail: function (callback) {\n      return this.then(null, callback)\n    },\n\n    /**\n     * Run the given callbacks after this promise is fulfilled.\n     * @param optionsOrCallback {} A Backbone-style options callback, or a\n     * callback function. If this is an options object and contains a \"model\"\n     * attributes, that will be passed to error callbacks as the first argument.\n     * @param model {} If truthy, this will be passed as the first result of\n     * error callbacks. This is for Backbone-compatability.\n     * @return {Parse.Promise} A promise that will be resolved after the\n     * callbacks are run, with the same result as this.\n     */\n    _thenRunCallbacks: function (optionsOrCallback, model) {\n      var options\n      if (_.isFunction(optionsOrCallback)) {\n        var callback = optionsOrCallback\n        options = {\n          success: function (result) {\n            callback(result, null)\n          },\n          error: function (error) {\n            callback(null, error)\n          }\n        }\n      } else {\n        options = _.clone(optionsOrCallback)\n      }\n      options = options || {}\n\n      return this.then(function (result) {\n        if (options.success) {\n          options.success.apply(this, arguments)\n        } else if (model) {\n          // When there's no callback, a sync event should be triggered.\n          model.trigger('sync', model, result, options)\n        }\n        return Parse.Promise.as.apply(Parse.Promise, arguments)\n      }, function (error) {\n        if (options.error) {\n          if (!_.isUndefined(model)) {\n            options.error(model, error)\n          } else {\n            options.error(error)\n          }\n        } else if (model) {\n          // When there's no error callback, an error event should be triggered.\n          model.trigger('error', model, error, options)\n        }\n        // By explicitly returning a rejected Promise, this will work with\n        // either jQuery or Promises/A semantics.\n        return Parse.Promise.error(error)\n      })\n    },\n\n    /**\n     * Adds a callback function that should be called regardless of whether\n     * this promise failed or succeeded. The callback will be given either the\n     * array of results for its first argument, or the error as its second,\n     * depending on whether this Promise was rejected or resolved. Returns a\n     * new Promise, like \"then\" would.\n     * @param {Function} continuation the callback.\n     */\n    _continueWith: function (continuation) {\n      return this.then(function () {\n        return continuation(arguments, null)\n      }, function (error) {\n        return continuation(null, error)\n      })\n    }\n  })\n}(this))\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  var b64Digit = function (number) {\n    if (number < 26) {\n      return String.fromCharCode(65 + number)\n    }\n    if (number < 52) {\n      return String.fromCharCode(97 + (number - 26))\n    }\n    if (number < 62) {\n      return String.fromCharCode(48 + (number - 52))\n    }\n    if (number === 62) {\n      return '+'\n    }\n    if (number === 63) {\n      return '/'\n    }\n    throw new Error('Tried to encode large digit ' + number + ' in base64.')\n  }\n\n  var encodeBase64 = function (array) {\n    var chunks = []\n    chunks.length = Math.ceil(array.length / 3)\n    _.times(chunks.length, function (i) {\n      var b1 = array[i * 3]\n      var b2 = array[i * 3 + 1] || 0\n      var b3 = array[i * 3 + 2] || 0\n\n      var has2 = (i * 3 + 1) < array.length\n      var has3 = (i * 3 + 2) < array.length\n\n      chunks[i] = [\n        b64Digit((b1 >> 2) & 0x3F),\n        b64Digit(((b1 << 4) & 0x30) | ((b2 >> 4) & 0x0F)),\n        has2 ? b64Digit(((b2 << 2) & 0x3C) | ((b3 >> 6) & 0x03)) : '=',\n        has3 ? b64Digit(b3 & 0x3F) : '='\n      ].join('')\n    })\n    return chunks.join('')\n  }\n\n  /**\n   * Reads a File using a FileReader.\n   * @param file {File} the File to read.\n   * @param type {String} (optional) the mimetype to override with.\n   * @return {Parse.Promise} A Promise that will be fulfilled with a\n   *     base64-encoded string of the data and its mime type.\n   */\n  var readAsync = function (file, type) {\n    var promise = new Parse.Promise()\n\n    if (typeof (FileReader) === 'undefined') {\n      return Parse.Promise.error(new Parse.Error(\n        Parse.Error.FILE_READ_ERROR,\n        'Attempted to use a FileReader on an unsupported browser.'))\n    }\n\n    var reader = new FileReader()\n    reader.onloadend = function () {\n      if (reader.readyState !== 2) {\n        promise.reject(new Parse.Error(\n          Parse.Error.FILE_READ_ERROR,\n          'Error reading file.'))\n        return\n      }\n\n      var dataURL = reader.result\n      var matches = /^data:([^;]*);base64,(.*)$/.exec(dataURL)\n      if (!matches) {\n        promise.reject(new Parse.Error(\n          Parse.Error.FILE_READ_ERROR,\n          'Unable to interpret data URL: ' + dataURL))\n        return\n      }\n\n      promise.resolve(matches[2], type || matches[1])\n    }\n    reader.readAsDataURL(file)\n    return promise\n  }\n\n  /**\n   * A Parse.File is a local representation of a file that is saved to the Parse\n   * cloud.\n   * @class\n   * @param name {String} The file's name. This will be prefixed by a unique\n   *     value once the file has finished saving. The file name must begin with\n   *     an alphanumeric character, and consist of alphanumeric characters,\n   *     periods, spaces, underscores, or dashes.\n   * @param data {Array} The data for the file, as either:\n   *     1. an Array of byte value Numbers, or\n   *     2. an Object like { base64: \"...\" } with a base64-encoded String.\n   *     3. a File object selected with a file upload control. (3) only works\n   *        in Firefox 3.6+, Safari 6.0.2+, Chrome 7+, and IE 10+.\n   *        For example:<pre>\n   * var fileUploadControl = $(\"#profilePhotoFileUpload\")[0]\n   * if (fileUploadControl.files.length > 0) {\n   *   var file = fileUploadControl.files[0]\n   *   var name = \"photo.jpg\"\n   *   var parseFile = new Parse.File(name, file)\n   *   parseFile.save().then(function() {\n   *     // The file has been saved to Parse.\n   *   }, function(error) {\n   *     // The file either could not be read, or could not be saved to Parse.\n   *   })\n   * }</pre>\n   * @param type {String} Optional Content-Type header to use for the file. If\n   *     this is omitted, the content type will be inferred from the name's\n   *     extension.\n   */\n  Parse.File = function (name, data, type) {\n    this._name = name\n\n    // Guess the content type from the extension if we need to.\n    var extension = /\\.([^.]*)$/.exec(name)\n    if (extension) {\n      extension = extension[1].toLowerCase()\n    }\n    var specifiedType = type || ''\n\n    if (_.isArray(data)) {\n      this._source = Parse.Promise.as(encodeBase64(data), specifiedType)\n    } else if (data && data.base64) {\n      // if it contains data uri, extract based64 and the type out of it.\n      var dataUriRegexp = /^data:([a-zA-Z]*\\/[a-zA-Z+.-]*);(charset=[a-zA-Z0-9\\-\\/\\s]*,)?base64,(\\S+)/\n\n      var matches = dataUriRegexp.exec(data.base64)\n      if (matches && matches.length > 0) {\n        // if data URI with charset, there will have 4 matches.\n        this._source = Parse.Promise.as(\n          (matches.length === 4 ? matches[3] : matches[2]), matches[1]\n        )\n      } else {\n        this._source = Parse.Promise.as(data.base64, specifiedType)\n      }\n    } else if (typeof (File) !== 'undefined' && data instanceof File) {\n      this._source = readAsync(data, type)\n    } else if (_.isString(data)) {\n      throw new Error('Creating a Parse.File from a String is not yet supported.')\n    }\n  }\n\n  Parse.File.prototype = {\n\n    /**\n     * Gets the name of the file. Before save is called, this is the filename\n     * given by the user. After save is called, that name gets prefixed with a\n     * unique identifier.\n     */\n    name: function () {\n      return this._name\n    },\n\n    /**\n     * Gets the url of the file. It is only available after you save the file or\n     * after you get the file from a Parse.Object.\n     * @return {String}\n     */\n    url: function () {\n      return this._url\n    },\n\n    /**\n     * Saves the file to the Parse cloud.\n     * @param {Object} options A Backbone-style options object.\n     * @return {Parse.Promise} Promise that is resolved when the save finishes.\n     */\n    save: function (options) {\n      options = options || {}\n\n      var self = this\n      if (!self._previousSave) {\n        self._previousSave = self._source.then(function (base64, type) {\n          var data = {\n            base64: base64,\n            _ContentType: type\n          }\n          return Parse._request({\n            route: 'files',\n            className: self._name,\n            method: 'POST',\n            data: data,\n            useMasterKey: options.useMasterKey\n          })\n        }).then(function (response) {\n          self._name = response.name\n          self._url = response.url\n          return self\n        })\n      }\n      return self._previousSave._thenRunCallbacks(options)\n    }\n  }\n}(this))\n\n;(function (root) {\n  root.Parse = root.Parse || {}\n  var Parse = root.Parse\n  var _ = Parse._\n\n  /**\n   * Creates a new model with defined attributes. A client id (cid) is\n   * automatically generated and assigned for you.\n   *\n   * <p>You won't normally call this method directly.  It is recommended that\n   * you use a subclass of <code>Parse.Object</code> instead, created by calling\n   * <code>extend</code>.</p>\n   *\n   * <p>However, if you don't want to use a subclass, or aren't sure which\n   * subclass is appropriate, you can use this form:<pre>\n   *     var object = new Parse.Object(\"ClassName\")\n   * </pre>\n   * That is basically equivalent to:<pre>\n   *     var MyClass = Parse.Object.extend(\"ClassName\")\n   *     var object = new MyClass()\n   * </pre></p>\n   *\n   * @param {Object} attributes The initial set of data to store in the object.\n   * @param {Object} options A set of Backbone-like options for creating the\n   *     object.  The only option currently supported is \"collection\".\n   * @see Parse.Object.extend\n   *\n   * @class\n   *\n   * <p>The fundamental unit of Parse data, which implements the Backbone Model\n   * interface.</p>\n   */\n  Parse.Object = function (attributes, options) {\n    // Allow new Parse.Object(\"ClassName\") as a shortcut to _create.\n    if (_.isString(attributes)) {\n      return Parse.Object._create.apply(this, arguments)\n    }\n\n    attributes = attributes || {}\n    if (options && options.parse) {\n      attributes = this.parse(attributes)\n    }\n    var defaults = Parse._getValue(this, 'defaults')\n    if (defaults) {\n      attributes = _.extend({}, defaults, attributes)\n    }\n    if (options && options.collection) {\n      this.collection = options.collection\n    }\n\n    this._serverData = {} // The last known data for this object from cloud.\n    this._opSetQueue = [{}] // List of sets of changes to the data.\n    this.attributes = {} // The best estimate of this's current data.\n\n    this._hashedJSON = {} // Hash of values of containers at last save.\n    this._escapedAttributes = {}\n    this.cid = _.uniqueId('c')\n    this.changed = {}\n    this._silent = {}\n    this._pending = {}\n    if (!this.set(attributes, {silent: true})) {\n      throw new Error(\"Can't create an invalid Parse.Object\")\n    }\n    this.changed = {}\n    this._silent = {}\n    this._pending = {}\n    this._hasData = true\n    this._previousAttributes = _.clone(this.attributes)\n    this.initialize.apply(this, arguments)\n  }\n\n  /**\n   * The ID of this object, unique within its class.\n   * @name id\n   * @type String\n   * @field\n   * @memberOf Parse.Object.prototype\n   */\n\n  /**\n   * The first time this object was saved on the server.\n   * @name createdAt\n   * @type Date\n   * @field\n   * @memberOf Parse.Object.prototype\n   */\n\n  /**\n   * The last time this object was updated on the server.\n   * @name updatedAt\n   * @type Date\n   * @field\n   * @memberOf Parse.Object.prototype\n   */\n\n  /**\n   * Saves the given list of Parse.Object.\n   * If any error is encountered, stops and calls the error handler.\n   *\n   * <pre>\n   *   Parse.Object.saveAll([object1, object2, ...], {\n   *     success: function(list) {\n   *       // All the objects were saved.\n   *     },\n   *     error: function(error) {\n   *       // An error occurred while saving one of the objects.\n   *     },\n   *   })\n   * </pre>\n   *\n   * @param {Array} list A list of <code>Parse.Object</code>.\n   * @param {Object} options A Backbone-style callback object.\n   * Valid options are:<ul>\n   *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n   *     be used for this request.\n   *   <li>sessionToken: A valid session token, used for making a request on\n   *       behalf of a specific user.\n   * </ul>\n   */\n  Parse.Object.saveAll = function (list, options) {\n    options = options || {}\n    return Parse.Object._deepSaveAsync(list, {\n      useMasterKey: options.useMasterKey,\n      sessionToken: options.sessionToken\n    })._thenRunCallbacks(options)\n  }\n\n  /**\n   * Destroy the given list of models on the server if it was already persisted.\n   * Optimistically removes each model from its collection, if it has one.\n   * If `wait: true` is passed, waits for the server to respond before removal.\n   *\n   * <p>Unlike saveAll, if an error occurs while deleting an individual model,\n   * this method will continue trying to delete the rest of the models if\n   * possible, except in the case of a fatal error like a connection error.\n   *\n   * <p>In particular, the Parse.Error object returned in the case of error may\n   * be one of two types:\n   *\n   * <ul>\n   *   <li>A Parse.Error.AGGREGATE_ERROR. This object's \"errors\" property is an\n   *       array of other Parse.Error objects. Each error object in this array\n   *       has an \"object\" property that references the object that could not be\n   *       deleted (for instance, because that object could not be found).</li>\n   *   <li>A non-aggregate Parse.Error. This indicates a serious error that\n   *       caused the delete operation to be aborted partway through (for\n   *       instance, a connection failure in the middle of the delete).</li>\n   * </ul>\n   *\n   * <pre>\n   *   Parse.Object.destroyAll([object1, object2, ...], {\n   *     success: function() {\n   *       // All the objects were deleted.\n   *     },\n   *     error: function(error) {\n   *       // An error occurred while deleting one or more of the objects.\n   *       // If this is an aggregate error, then we can inspect each error\n   *       // object individually to determine the reason why a particular\n   *       // object was not deleted.\n   *       if (error.code == Parse.Error.AGGREGATE_ERROR) {\n   *         for (var i = 0; i < error.errors.length; i++) {\n   *           console.log(\"Couldn't delete \" + error.errors[i].object.id +\n   *             \"due to \" + error.errors[i].message)\n   *         }\n   *       } else {\n   *         console.log(\"Delete aborted because of \" + error.message)\n   *       }\n   *     },\n   *   })\n   * </pre>\n   *\n   * @param {Array} list A list of <code>Parse.Object</code>.\n   * @param {Object} options A Backbone-style callback object.\n   * Valid options are:<ul>\n   *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n   *     be used for this request.\n   *   <li>sessionToken: A valid session token, used for making a request on\n   *       behalf of a specific user.\n   * </ul>\n   * @return {Parse.Promise} A promise that is fulfilled when the destroyAll\n   *     completes.\n   */\n  Parse.Object.destroyAll = function (list, options) {\n    options = options || {}\n\n    var triggerDestroy = function (object) {\n      object.trigger('destroy', object, object.collection, options)\n    }\n\n    var errors = []\n    var destroyBatch = function (batch) {\n      var promise = Parse.Promise.as()\n\n      if (batch.length > 0) {\n        promise = promise.then(function () {\n          return Parse._request({\n            route: 'batch',\n            method: 'POST',\n            useMasterKey: options.useMasterKey,\n            sessionToken: options.sessionToken,\n            data: {\n              requests: _.map(batch, function (object) {\n                return {\n                  method: 'DELETE',\n                  path: '/1/classes/' + object.className + '/' + object.id\n                }\n              })\n            }\n          })\n        }).then(function (responses, status, xhr) {\n          Parse._arrayEach(batch, function (object, i) {\n            if (responses[i].success && options.wait) {\n              triggerDestroy(object)\n            } else if (responses[i].error) {\n              var error = new Parse.Error(responses[i].error.code,\n                responses[i].error.error)\n              error.object = object\n\n              errors.push(error)\n            }\n          })\n        })\n      }\n\n      return promise\n    }\n\n    var promise = Parse.Promise.as()\n    var batch = []\n    Parse._arrayEach(list, function (object, i) {\n      if (!object.id || !options.wait) {\n        triggerDestroy(object)\n      }\n\n      if (object.id) {\n        batch.push(object)\n      }\n\n      if (batch.length === 20 || i + 1 === list.length) {\n        var thisBatch = batch\n        batch = []\n\n        promise = promise.then(function () {\n          return destroyBatch(thisBatch)\n        })\n      }\n    })\n\n    return promise.then(function () {\n      if (errors.length === 0) {\n        return true\n      } else {\n        var error = new Parse.Error(Parse.Error.AGGREGATE_ERROR,\n          'Error deleting an object in destroyAll')\n        error.errors = errors\n\n        return Parse.Promise.error(error)\n      }\n    })._thenRunCallbacks(options)\n  }\n\n  /**\n   * Fetches the given list of Parse.Object.\n   * If any error is encountered, stops and calls the error handler.\n   *\n   * <pre>\n   *   Parse.Object.fetchAll([object1, object2, ...], {\n   *     success: function(list) {\n   *       // All the objects were fetched.\n   *     },\n   *     error: function(error) {\n   *       // An error occurred while fetching one of the objects.\n   *     },\n   *   })\n   * </pre>\n   *\n   * @param {Array} list A list of <code>Parse.Object</code>.\n   * @param {Object} options A Backbone-style callback object.\n   * Valid options are:<ul>\n   *   <li>success: A Backbone-style success callback.\n   *   <li>error: An Backbone-style error callback.\n   * </ul>\n   */\n  Parse.Object.fetchAll = function (list, options) {\n    return Parse.Object._fetchAll(\n      list,\n      true\n    )._thenRunCallbacks(options)\n  }\n\n  /**\n   * Fetches the given list of Parse.Object if needed.\n   * If any error is encountered, stops and calls the error handler.\n   *\n   * <pre>\n   *   Parse.Object.fetchAllIfNeeded([object1, ...], {\n   *     success: function(list) {\n   *       // Objects were fetched and updated.\n   *     },\n   *     error: function(error) {\n   *       // An error occurred while fetching one of the objects.\n   *     },\n   *   })\n   * </pre>\n   *\n   * @param {Array} list A list of <code>Parse.Object</code>.\n   * @param {Object} options A Backbone-style callback object.\n   * Valid options are:<ul>\n   *   <li>success: A Backbone-style success callback.\n   *   <li>error: An Backbone-style error callback.\n   * </ul>\n   */\n  Parse.Object.fetchAllIfNeeded = function (list, options) {\n    return Parse.Object._fetchAll(\n      list,\n      false\n    )._thenRunCallbacks(options)\n  }\n\n  // Attach all inheritable methods to the Parse.Object prototype.\n  _.extend(Parse.Object.prototype, Parse.Events, {\n    _existed: false,\n\n    /**\n     * Initialize is an empty function by default. Override it with your own\n     * initialization logic.\n     */\n    initialize: function () {},\n\n    /**\n     * Returns a JSON version of the object suitable for saving to Parse.\n     * @return {Object}\n     */\n    toJSON: function () {\n      var json = this._toFullJSON()\n      Parse._arrayEach(['__type', 'className'], function (key) {\n        delete json[key]\n      })\n      return json\n    },\n\n    _toFullJSON: function (seenObjects) {\n      var json = _.clone(this.attributes)\n      Parse._objectEach(json, function (val, key) {\n        json[key] = Parse._encode(val, seenObjects)\n      })\n      Parse._objectEach(this._operations, function (val, key) {\n        json[key] = val\n      })\n\n      if (_.has(this, 'id')) {\n        json.objectId = this.id\n      }\n      if (_.has(this, 'createdAt')) {\n        if (_.isDate(this.createdAt)) {\n          json.createdAt = this.createdAt.toJSON()\n        } else {\n          json.createdAt = this.createdAt\n        }\n      }\n\n      if (_.has(this, 'updatedAt')) {\n        if (_.isDate(this.updatedAt)) {\n          json.updatedAt = this.updatedAt.toJSON()\n        } else {\n          json.updatedAt = this.updatedAt\n        }\n      }\n      json.__type = 'Object'\n      json.className = this.className\n      return json\n    },\n\n    /**\n     * Updates _hashedJSON to reflect the current state of this object.\n     * Adds any changed hash values to the set of pending changes.\n     */\n    _refreshCache: function () {\n      var self = this\n      if (self._refreshingCache) {\n        return\n      }\n      self._refreshingCache = true\n      Parse._objectEach(this.attributes, function (value, key) {\n        if (value instanceof Parse.Object) {\n          value._refreshCache()\n        } else if (_.isObject(value)) {\n          var objectArray = false\n          if (_.isArray(value)) {\n            // We don't cache arrays of Parse.Objects\n            _.each(value, function (arrVal) {\n              if (arrVal instanceof Parse.Object) {\n                objectArray = true\n                arrVal._refreshCache()\n              }\n            })\n          }\n          if (!objectArray && self._resetCacheForKey(key)) {\n            self.set(key, new Parse.Op.Set(value), { silent: true })\n          }\n        }\n      })\n      delete self._refreshingCache\n    },\n\n    /**\n     * Returns true if this object has been modified since its last\n     * save/refresh.  If an attribute is specified, it returns true only if that\n     * particular attribute has been modified since the last save/refresh.\n     * @param {String} attr An attribute name (optional).\n     * @return {Boolean}\n     */\n    dirty: function (attr) {\n      this._refreshCache()\n\n      var currentChanges = _.last(this._opSetQueue)\n\n      if (attr) {\n        return !!(currentChanges[attr])\n      }\n      if (!this.id) {\n        return true\n      }\n      if (_.keys(currentChanges).length > 0) {\n        return true\n      }\n      return false\n    },\n\n    /**\n     * Returns an array of keys that have been modified since last save/refresh\n     * @return {Array of string}\n     */\n    dirtyKeys: function () {\n      return _.keys(_.last(this._opSetQueue))\n    },\n\n    /**\n     * Gets a Pointer referencing this Object.\n     */\n    _toPointer: function () {\n      if (!this.id) {\n        throw new Error(\"Can't serialize an unsaved Parse.Object\")\n      }\n      return { __type: 'Pointer',\n        className: this.className,\n      objectId: this.id }\n    },\n\n    /**\n     * Gets the value of an attribute.\n     * @param {String} attr The string name of an attribute.\n     */\n    get: function (attr) {\n      return this.attributes[attr]\n    },\n\n    /**\n     * Gets a relation on the given class for the attribute.\n     * @param String attr The attribute to get the relation for.\n     */\n    relation: function (attr) {\n      var value = this.get(attr)\n      if (value) {\n        if (!(value instanceof Parse.Relation)) {\n          throw new Error('Called relation() on non-relation field ' + attr)\n        }\n        value._ensureParentAndKey(this, attr)\n        return value\n      } else {\n        return new Parse.Relation(this, attr)\n      }\n    },\n\n    /**\n     * Gets the HTML-escaped value of an attribute.\n     */\n    escape: function (attr) {\n      var html = this._escapedAttributes[attr]\n      if (html) {\n        return html\n      }\n      var val = this.attributes[attr]\n      var escaped\n      if (Parse._isNullOrUndefined(val)) {\n        escaped = ''\n      } else {\n        escaped = _.escape(val.toString())\n      }\n      this._escapedAttributes[attr] = escaped\n      return escaped\n    },\n\n    /**\n     * Returns <code>true</code> if the attribute contains a value that is not\n     * null or undefined.\n     * @param {String} attr The string name of the attribute.\n     * @return {Boolean}\n     */\n    has: function (attr) {\n      return !Parse._isNullOrUndefined(this.attributes[attr])\n    },\n\n    /**\n     * Pulls \"special\" fields like objectId, createdAt, etc. out of attrs\n     * and puts them on \"this\" directly.  Removes them from attrs.\n     * @param attrs - A dictionary with the data for this Parse.Object.\n     */\n    _mergeMagicFields: function (attrs) {\n      // Check for changes of magic fields.\n      var model = this\n      var specialFields = ['id', 'objectId', 'createdAt', 'updatedAt']\n      Parse._arrayEach(specialFields, function (attr) {\n        if (attrs[attr]) {\n          if (attr === 'objectId') {\n            model.id = attrs[attr]\n          } else if ((attr === 'createdAt' || attr === 'updatedAt') &&\n            !_.isDate(attrs[attr])) {\n            model[attr] = Parse._parseDate(attrs[attr])\n          } else {\n            model[attr] = attrs[attr]\n          }\n          delete attrs[attr]\n        }\n      })\n    },\n\n    /**\n     * Copies the given serverData to \"this\", refreshes attributes, and\n     * clears pending changes\n     */\n    _copyServerData: function (serverData) {\n      // Copy server data\n      var tempServerData = {}\n      Parse._objectEach(serverData, function (value, key) {\n        tempServerData[key] = Parse._decode(key, value)\n      })\n      this._serverData = tempServerData\n\n      // Refresh the attributes.\n      this._rebuildAllEstimatedData()\n\n      // Clear out any changes the user might have made previously.\n      this._refreshCache()\n      this._opSetQueue = [{}]\n\n      // Refresh the attributes again.\n      this._rebuildAllEstimatedData()\n    },\n\n    /**\n     * Merges another object's attributes into this object.\n     */\n    _mergeFromObject: function (other) {\n      if (!other) {\n        return\n      }\n\n      // This does the inverse of _mergeMagicFields.\n      this.id = other.id\n      this.createdAt = other.createdAt\n      this.updatedAt = other.updatedAt\n\n      this._copyServerData(other._serverData)\n\n      this._hasData = true\n    },\n\n    /**\n     * Returns the json to be sent to the server.\n     */\n    _startSave: function () {\n      this._opSetQueue.push({})\n    },\n\n    /**\n     * Called when a save fails because of an error. Any changes that were part\n     * of the save need to be merged with changes made after the save. This\n     * might throw an exception is you do conflicting operations. For example,\n     * if you do:\n     *   object.set(\"foo\", \"bar\")\n     *   object.set(\"invalid field name\", \"baz\")\n     *   object.save()\n     *   object.increment(\"foo\")\n     * then this will throw when the save fails and the client tries to merge\n     * \"bar\" with the +1.\n     */\n    _cancelSave: function () {\n      var failedChanges = _.first(this._opSetQueue)\n      this._opSetQueue = _.rest(this._opSetQueue)\n      var nextChanges = _.first(this._opSetQueue)\n      Parse._objectEach(failedChanges, function (op, key) {\n        var op1 = failedChanges[key]\n        var op2 = nextChanges[key]\n        if (op1 && op2) {\n          nextChanges[key] = op2._mergeWithPrevious(op1)\n        } else if (op1) {\n          nextChanges[key] = op1\n        }\n      })\n      this._saving = this._saving - 1\n    },\n\n    /**\n     * Called when a save completes successfully. This merges the changes that\n     * were saved into the known server data, and overrides it with any data\n     * sent directly from the server.\n     */\n    _finishSave: function (serverData) {\n      // Grab a copy of any object referenced by this object. These instances\n      // may have already been fetched, and we don't want to lose their data.\n      // Note that doing it like this means we will unify separate copies of the\n      // same object, but that's a risk we have to take.\n      var fetchedObjects = {}\n      Parse._traverse(this.attributes, function (object) {\n        if (object instanceof Parse.Object && object.id && object._hasData) {\n          fetchedObjects[object.id] = object\n        }\n      })\n\n      var savedChanges = _.first(this._opSetQueue)\n      this._opSetQueue = _.rest(this._opSetQueue)\n      this._applyOpSet(savedChanges, this._serverData)\n      this._mergeMagicFields(serverData)\n      var self = this\n      Parse._objectEach(serverData, function (value, key) {\n        self._serverData[key] = Parse._decode(key, value)\n\n        // Look for any objects that might have become unfetched and fix them\n        // by replacing their values with the previously observed values.\n        var fetched = Parse._traverse(self._serverData[key], function (object) {\n          if (object instanceof Parse.Object && fetchedObjects[object.id]) {\n            return fetchedObjects[object.id]\n          }\n        })\n        if (fetched) {\n          self._serverData[key] = fetched\n        }\n      })\n      this._rebuildAllEstimatedData()\n      this._saving = this._saving - 1\n    },\n\n    /**\n     * Called when a fetch or login is complete to set the known server data to\n     * the given object.\n     */\n    _finishFetch: function (serverData, hasData) {\n      this._opSetQueue = [{}]\n\n      // Bring in all the new server data.\n      this._mergeMagicFields(serverData)\n      this._copyServerData(serverData)\n\n      this._hasData = hasData\n    },\n\n    /**\n     * Applies the set of Parse.Op in opSet to the object target.\n     */\n    _applyOpSet: function (opSet, target) {\n      var self = this\n      Parse._objectEach(opSet, function (change, key) {\n        target[key] = change._estimate(target[key], self, key)\n        if (target[key] === Parse.Op._UNSET) {\n          delete target[key]\n        }\n      })\n    },\n\n    /**\n     * Replaces the cached value for key with the current value.\n     * Returns true if the new value is different than the old value.\n     */\n    _resetCacheForKey: function (key) {\n      var value = this.attributes[key]\n      if (_.isObject(value) &&\n        !(value instanceof Parse.Object) &&\n        !(value instanceof Parse.File)) {\n        value = value.toJSON ? value.toJSON() : value\n        var json = JSON.stringify(value)\n        if (this._hashedJSON[key] !== json) {\n          var wasSet = !!this._hashedJSON[key]\n          this._hashedJSON[key] = json\n          return wasSet\n        }\n      }\n      return false\n    },\n\n    /**\n     * Populates attributes[key] by starting with the last known data from the\n     * server, and applying all of the local changes that have been made to that\n     * key since then.\n     */\n    _rebuildEstimatedDataForKey: function (key) {\n      var self = this\n      delete this.attributes[key]\n      if (this._serverData[key]) {\n        this.attributes[key] = this._serverData[key]\n      }\n      Parse._arrayEach(this._opSetQueue, function (opSet) {\n        var op = opSet[key]\n        if (op) {\n          self.attributes[key] = op._estimate(self.attributes[key], self, key)\n          if (self.attributes[key] === Parse.Op._UNSET) {\n            delete self.attributes[key]\n          } else {\n            self._resetCacheForKey(key)\n          }\n        }\n      })\n    },\n\n    /**\n     * Populates attributes by starting with the last known data from the\n     * server, and applying all of the local changes that have been made since\n     * then.\n     */\n    _rebuildAllEstimatedData: function () {\n      var self = this\n\n      var previousAttributes = _.clone(this.attributes)\n\n      this.attributes = _.clone(this._serverData)\n      Parse._arrayEach(this._opSetQueue, function (opSet) {\n        self._applyOpSet(opSet, self.attributes)\n        Parse._objectEach(opSet, function (op, key) {\n          self._resetCacheForKey(key)\n        })\n      })\n\n      // Trigger change events for anything that changed because of the fetch.\n      Parse._objectEach(previousAttributes, function (oldValue, key) {\n        if (self.attributes[key] !== oldValue) {\n          self.trigger('change:' + key, self, self.attributes[key], {})\n        }\n      })\n      Parse._objectEach(this.attributes, function (newValue, key) {\n        if (!_.has(previousAttributes, key)) {\n          self.trigger('change:' + key, self, newValue, {})\n        }\n      })\n    },\n\n    /**\n     * Sets a hash of model attributes on the object, firing\n     * <code>\"change\"</code> unless you choose to silence it.\n     *\n     * <p>You can call it with an object containing keys and values, or with one\n     * key and value.  For example:<pre>\n     *   gameTurn.set({\n     *     player: player1,\n     *     diceRoll: 2\n     *   }, {\n     *     error: function(gameTurnAgain, error) {\n     *       // The set failed validation.\n     *     }\n     *   })\n     *\n     *   game.set(\"currentPlayer\", player2, {\n     *     error: function(gameTurnAgain, error) {\n     *       // The set failed validation.\n     *     }\n     *   })\n     *\n     *   game.set(\"finished\", true);</pre></p>\n     *\n     * @param {String} key The key to set.\n     * @param {} value The value to give it.\n     * @param {Object} options A set of Backbone-like options for the set.\n     *     The only supported options are <code>silent</code>,\n     *     <code>error</code>, and <code>promise</code>.\n     * @return {Boolean} true if the set succeeded.\n     * @see Parse.Object#validate\n     * @see Parse.Error\n     */\n    set: function (key, value, options) {\n      var attrs\n      if (_.isObject(key) || Parse._isNullOrUndefined(key)) {\n        attrs = key\n        Parse._objectEach(attrs, function (v, k) {\n          attrs[k] = Parse._decode(k, v)\n        })\n        options = value\n      } else {\n        attrs = {}\n        attrs[key] = Parse._decode(key, value)\n      }\n\n      // Extract attributes and options.\n      options = options || {}\n      if (!attrs) {\n        return this\n      }\n      if (attrs instanceof Parse.Object) {\n        attrs = attrs.attributes\n      }\n\n      var self = this\n      Parse._objectEach(attrs, function (unusedValue, key) {\n        if (self.constructor.readOnlyAttributes &&\n          self.constructor.readOnlyAttributes[key]) {\n          throw new Error('Cannot modify readonly key: ' + key)\n        }\n      })\n\n      // If the unset option is used, every attribute should be a Unset.\n      if (options.unset) {\n        Parse._objectEach(attrs, function (unusedValue, key) {\n          attrs[key] = new Parse.Op.Unset()\n        })\n      }\n\n      // Apply all the attributes to get the estimated values.\n      var dataToValidate = _.clone(attrs)\n      Parse._objectEach(dataToValidate, function (value, key) {\n        if (value instanceof Parse.Op) {\n          dataToValidate[key] = value._estimate(self.attributes[key],\n            self, key)\n          if (dataToValidate[key] === Parse.Op._UNSET) {\n            delete dataToValidate[key]\n          }\n        }\n      })\n\n      // Run validation.\n      if (!this._validate(attrs, options)) {\n        return false\n      }\n\n      this._mergeMagicFields(attrs)\n\n      options.changes = {}\n      var escaped = this._escapedAttributes\n\n      // Update attributes.\n      Parse._arrayEach(_.keys(attrs), function (attr) {\n        var val = attrs[attr]\n\n        // If this is a relation object we need to set the parent correctly,\n        // since the location where it was parsed does not have access to\n        // this object.\n        if (val instanceof Parse.Relation) {\n          val.parent = self\n        }\n\n        if (!(val instanceof Parse.Op)) {\n          val = new Parse.Op.Set(val)\n        }\n\n        // See if this change will actually have any effect.\n        var isRealChange = true\n        if (val instanceof Parse.Op.Set && _.isEqual(self.attributes[attr], val.value)) {\n          isRealChange = false\n        }\n\n        if (isRealChange) {\n          delete escaped[attr]\n          if (options.silent) {\n            self._silent[attr] = true\n          } else {\n            options.changes[attr] = true\n          }\n        }\n\n        var currentChanges = _.last(self._opSetQueue)\n        currentChanges[attr] = val._mergeWithPrevious(currentChanges[attr])\n        self._rebuildEstimatedDataForKey(attr)\n\n        if (isRealChange) {\n          self.changed[attr] = self.attributes[attr]\n          if (!options.silent) {\n            self._pending[attr] = true\n          }\n        } else {\n          delete self.changed[attr]\n          delete self._pending[attr]\n        }\n      })\n\n      if (!options.silent) {\n        this.change(options)\n      }\n      return this\n    },\n\n    /**\n     * Remove an attribute from the model, firing <code>\"change\"</code> unless\n     * you choose to silence it. This is a noop if the attribute doesn't\n     * exist.\n     */\n    unset: function (attr, options) {\n      options = options || {}\n      options.unset = true\n      return this.set(attr, null, options)\n    },\n\n    /**\n     * Atomically increments the value of the given attribute the next time the\n     * object is saved. If no amount is specified, 1 is used by default.\n     *\n     * @param attr {String} The key.\n     * @param amount {Number} The amount to increment by.\n     */\n    increment: function (attr, amount) {\n      if (_.isUndefined(amount) || _.isNull(amount)) {\n        amount = 1\n      }\n      return this.set(attr, new Parse.Op.Increment(amount))\n    },\n\n    /**\n     * Atomically add an object to the end of the array associated with a given\n     * key.\n     * @param attr {String} The key.\n     * @param item {} The item to add.\n     */\n    add: function (attr, item) {\n      return this.set(attr, new Parse.Op.Add([item]))\n    },\n\n    /**\n     * Atomically add an object to the array associated with a given key, only\n     * if it is not already present in the array. The position of the insert is\n     * not guaranteed.\n     *\n     * @param attr {String} The key.\n     * @param item {} The object to add.\n     */\n    addUnique: function (attr, item) {\n      return this.set(attr, new Parse.Op.AddUnique([item]))\n    },\n\n    /**\n     * Atomically remove all instances of an object from the array associated\n     * with a given key.\n     *\n     * @param attr {String} The key.\n     * @param item {} The object to remove.\n     */\n    remove: function (attr, item) {\n      return this.set(attr, new Parse.Op.Remove([item]))\n    },\n\n    /**\n     * Returns an instance of a subclass of Parse.Op describing what kind of\n     * modification has been performed on this field since the last time it was\n     * saved. For example, after calling object.increment(\"x\"), calling\n     * object.op(\"x\") would return an instance of Parse.Op.Increment.\n     *\n     * @param attr {String} The key.\n     * @returns {Parse.Op} The operation, or undefined if none.\n     */\n    op: function (attr) {\n      return _.last(this._opSetQueue)[attr]\n    },\n\n    /**\n     * Clear all attributes on the model, firing <code>\"change\"</code> unless\n     * you choose to silence it.\n     */\n    clear: function (options) {\n      options = options || {}\n      options.unset = true\n      var keysToClear = _.extend(this.attributes, this._operations)\n      return this.set(keysToClear, options)\n    },\n\n    /**\n     * Returns a JSON-encoded set of operations to be sent with the next save\n     * request.\n     */\n    _getSaveJSON: function () {\n      var json = _.clone(_.first(this._opSetQueue))\n      Parse._objectEach(json, function (op, key) {\n        json[key] = op.toJSON()\n      })\n      return json\n    },\n\n    /**\n     * Returns true if this object can be serialized for saving.\n     */\n    _canBeSerialized: function () {\n      return Parse.Object._canBeSerializedAsValue(this.attributes)\n    },\n\n    /**\n     * Fetch the model from the server. If the server's representation of the\n     * model differs from its current attributes, they will be overriden,\n     * triggering a <code>\"change\"</code> event.\n     *\n     * @param {Object} options A Backbone-style callback object.\n     * Valid options are:<ul>\n     *   <li>success: A Backbone-style success callback.\n     *   <li>error: An Backbone-style error callback.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     *   <li>sessionToken: A valid session token, used for making a request on\n     *       behalf of a specific user.\n     * </ul>\n     * @return {Parse.Promise} A promise that is fulfilled when the fetch\n     *     completes.\n     */\n    fetch: function (options) {\n      var self = this\n      options = options || {}\n      var request = Parse._request({\n        method: 'GET',\n        route: 'classes',\n        className: this.className,\n        objectId: this.id,\n        useMasterKey: options.useMasterKey,\n        sessionToken: options.sessionToken\n      })\n      return request.then(function (response, status, xhr) {\n        self._finishFetch(self.parse(response, status, xhr), true)\n        return self\n      })._thenRunCallbacks(options, this)\n    },\n\n    /**\n     * Set a hash of model attributes, and save the model to the server.\n     * updatedAt will be updated when the request returns.\n     * You can either call it as:<pre>\n     *   object.save();</pre>\n     * or<pre>\n     *   object.save(null, options);</pre>\n     * or<pre>\n     *   object.save(attrs, options);</pre>\n     * or<pre>\n     *   object.save(key, value, options);</pre>\n     *\n     * For example, <pre>\n     *   gameTurn.save({\n     *     player: \"Jake Cutter\",\n     *     diceRoll: 2\n     *   }, {\n     *     success: function(gameTurnAgain) {\n     *       // The save was successful.\n     *     },\n     *     error: function(gameTurnAgain, error) {\n     *       // The save failed.  Error is an instance of Parse.Error.\n     *     }\n     *   });</pre>\n     * or with promises:<pre>\n     *   gameTurn.save({\n     *     player: \"Jake Cutter\",\n     *     diceRoll: 2\n     *   }).then(function(gameTurnAgain) {\n     *     // The save was successful.\n     *   }, function(error) {\n     *     // The save failed.  Error is an instance of Parse.Error.\n     *   });</pre>\n     *\n     * @param {Object} options A Backbone-style callback object.\n     * Valid options are:<ul>\n     *   <li>wait: Set to true to wait for the server to confirm a successful\n     *   save before modifying the attributes on the object.\n     *   <li>silent: Set to true to avoid firing the `set` event.\n     *   <li>success: A Backbone-style success callback.\n     *   <li>error: An Backbone-style error callback.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     *   <li>sessionToken: A valid session token, used for making a request on\n     *       behalf of a specific user.\n     * </ul>\n     * @return {Parse.Promise} A promise that is fulfilled when the save\n     *     completes.\n     * @see Parse.Error\n     */\n    save: function (arg1, arg2, arg3) {\n      var attrs, current, options\n      if (_.isObject(arg1) || Parse._isNullOrUndefined(arg1)) {\n        attrs = arg1\n        options = arg2\n      } else {\n        attrs = {}\n        attrs[arg1] = arg2\n        options = arg3\n      }\n\n      // Make save({ success: function() {} }) work.\n      if (!options && attrs) {\n        var extraKeys = _.reject(attrs, function (value, key) {\n          return _.include(['success', 'error', 'wait'], key)\n        })\n        if (extraKeys.length === 0) {\n          var allFunctions = true\n          if (_.has(attrs, 'success') && !_.isFunction(attrs.success)) {\n            allFunctions = false\n          }\n          if (_.has(attrs, 'error') && !_.isFunction(attrs.error)) {\n            allFunctions = false\n          }\n          if (allFunctions) {\n            // This attrs object looks like it's really an options object,\n            // and there's no other options object, so let's just use it.\n            return this.save(null, attrs)\n          }\n        }\n      }\n\n      options = _.clone(options) || {}\n      if (options.wait) {\n        current = _.clone(this.attributes)\n      }\n\n      var setOptions = _.clone(options) || {}\n      if (setOptions.wait) {\n        setOptions.silent = true\n      }\n      var setError\n      setOptions.error = function (model, error) {\n        setError = error\n      }\n      if (attrs && !this.set(attrs, setOptions)) {\n        return Parse.Promise.error(setError)._thenRunCallbacks(options, this)\n      }\n\n      var model = this\n\n      // If there is any unsaved child, save it first.\n      model._refreshCache()\n\n      var unsavedChildren = []\n      var unsavedFiles = []\n      Parse.Object._findUnsavedChildren(model.attributes,\n        unsavedChildren,\n        unsavedFiles)\n      if (unsavedChildren.length + unsavedFiles.length > 0) {\n        return Parse.Object._deepSaveAsync(this.attributes, {\n          useMasterKey: options.useMasterKey,\n          sessionToken: options.sessionToken\n        }).then(function () {\n          return model.save(null, options)\n        }, function (error) {\n          return Parse.Promise.error(error)._thenRunCallbacks(options, model)\n        })\n      }\n\n      this._startSave()\n      this._saving = (this._saving || 0) + 1\n\n      this._allPreviousSaves = this._allPreviousSaves || Parse.Promise.as()\n      this._allPreviousSaves = this._allPreviousSaves._continueWith(function () {\n        var method = model.id ? 'PUT' : 'POST'\n\n        var json = model._getSaveJSON()\n\n        var route = 'classes'\n        var className = model.className\n        if (model.className === '_User' && !model.id) {\n          // Special-case user sign-up.\n          route = 'users'\n          className = null\n        }\n        var request = Parse._request({\n          route: route,\n          className: className,\n          objectId: model.id,\n          method: method,\n          useMasterKey: options.useMasterKey,\n          sessionToken: options.sessionToken,\n          data: json\n        })\n\n        request = request.then(function (resp, status, xhr) {\n          var serverAttrs = model.parse(resp, status, xhr)\n          if (options.wait) {\n            serverAttrs = _.extend(attrs || {}, serverAttrs)\n          }\n          model._finishSave(serverAttrs)\n          if (options.wait) {\n            model.set(current, setOptions)\n          }\n          return model\n        }, function (error) {\n          model._cancelSave()\n          return Parse.Promise.error(error)\n        })._thenRunCallbacks(options, model)\n\n        return request\n      })\n      return this._allPreviousSaves\n    },\n\n    /**\n     * Destroy this model on the server if it was already persisted.\n     * Optimistically removes the model from its collection, if it has one.\n     * If `wait: true` is passed, waits for the server to respond\n     * before removal.\n     *\n     * @param {Object} options A Backbone-style callback object.\n     * Valid options are:<ul>\n     *   <li>wait: Set to true to wait for the server to confirm successful\n     *   deletion of the object before triggering the `destroy` event.\n     *   <li>success: A Backbone-style success callback\n     *   <li>error: An Backbone-style error callback.\n     *   <li>useMasterKey: In Cloud Code and Node only, causes the Master Key to\n     *     be used for this request.\n     *   <li>sessionToken: A valid session token, used for making a request on\n     *       behalf of a specific user.\n     * </ul>\n     * @return {Parse.Promise} A promise that is fulfilled when the destroy\n     *     completes.\n     */\n    destroy: function (options) {\n      options = options || {}\n      var model = this\n\n      var triggerDestroy = function () {\n        model.trigger('destroy', model, model.collection, options)\n      }\n\n      if (!this.id) {\n        return triggerDestroy()\n      }\n\n      if (!options.wait) {\n        triggerDestroy()\n      }\n\n      var request = Parse._request({\n        route: 'classes',\n        className: this.className,\n        objectId: this.id,\n        method: 'DELETE',\n        useMasterKey: options.useMasterKey,\n        sessionToken: options.sessionToken\n      })\n      return request.then(function () {\n        if (options.wait) {\n          triggerDestroy()\n        }\n        return model\n      })._thenRunCallbacks(options, this)\n    },\n\n    /**\n     * Converts a response into the hash of attributes to be set on the model.\n     * @ignore\n     */\n    parse: function (resp, status, xhr) {\n      var output = _.clone(resp)\n      _(['createdAt', 'updatedAt']).each(function (key) {\n        if (output[key]) {\n          output[key] = Parse._parseDate(output[key])\n        }\n      })\n      if (!output.updatedAt) {\n        output.updatedAt = output.createdAt\n      }\n      if (status) {\n        this._existed = (status !== 201)\n      }\n      return output\n    },\n\n    /**\n     * Creates a new model with identical attributes to this one.\n     * @return {Parse.Object}\n     */\n    clone: function () {\n      return new this.constructor(this.attributes)\n    },\n\n    /**\n     * Returns true if this object has never been saved to Parse.\n     * @return {Boolean}\n     */\n    isNew: function () {\n      return !this.id\n    },\n\n    /**\n     * Call this method to manually fire a `\"change\"` event for this model and\n     * a `\"change:attribute\"` event for each changed attribute.\n     * Calling this will cause all objects observing the model to update.\n     */\n    change: function (options) {\n      options = options || {}\n      var changing = this._changing\n      this._changing = true\n\n      // Silent changes become pending changes.\n      var self = this\n      Parse._objectEach(this._silent, function (attr) {\n        self._pending[attr] = true\n      })\n\n      // Silent changes are triggered.\n      var changes = _.extend({}, options.changes, this._silent)\n      this._silent = {}\n      Parse._objectEach(changes, function (unusedValue, attr) {\n        self.trigger('change:' + attr, self, self.get(attr), options)\n      })\n      if (changing) {\n        return this\n      }\n\n      // This is to get around lint not letting us make a function in a loop.\n      var deleteChanged = function (value, attr) {\n        if (!self._pending[attr] && !self._silent[attr]) {\n          delete self.changed[attr]\n        }\n      }\n\n      // Continue firing `\"change\"` events while there are pending changes.\n      while (!_.isEmpty(this._pending)) {\n        this._pending = {}\n        this.trigger('change', this, options)\n        // Pending and silent changes still remain.\n        Parse._objectEach(this.changed, deleteChanged)\n        self._previousAttributes = _.clone(this.attributes)\n      }\n\n      this._changing = false\n      return this\n    },\n\n    /**\n     * Returns true if this object was created by the Parse server when the\n     * object might have already been there (e.g. in the case of a Facebook\n     * login)\n     */\n    existed: function () {\n      return this._existed\n    },\n\n    /**\n     * Determine if the model has changed since the last <code>\"change\"</code>\n     * event.  If you specify an attribute name, determine if that attribute\n     * has changed.\n     * @param {String} attr Optional attribute name\n     * @return {Boolean}\n     */\n    hasChanged: function (attr) {\n      if (!arguments.length) {\n        return !_.isEmpty(this.changed)\n      }\n      return this.changed && _.has(this.changed, attr)\n    },\n\n    /**\n     * Returns an object containing all the attributes that have changed, or\n     * false if there are no changed attributes. Useful for determining what\n     * parts of a view need to be updated and/or what attributes need to be\n     * persisted to the server. Unset attributes will be set to undefined.\n     * You can also pass an attributes object to diff against the model,\n     * determining if there *would be* a change.\n     */\n    changedAttributes: function (diff) {\n      if (!diff) {\n        return this.hasChanged() ? _.clone(this.changed) : false\n      }\n      var changed = {}\n      var old = this._previousAttributes\n      Parse._objectEach(diff, function (diffVal, attr) {\n        if (!_.isEqual(old[attr], diffVal)) {\n          changed[attr] = diffVal\n        }\n      })\n      return changed\n    },\n\n    /**\n     * Gets the previous value of an attribute, recorded at the time the last\n     * <code>\"change\"</code> event was fired.\n     * @param {String} attr Name of the attribute to get.\n     */\n    previous: function (attr) {\n      if (!arguments.length || !this._previousAttributes) {\n        return null\n      }\n      return this._previousAttributes[attr]\n    },\n\n    /**\n     * Gets all of the attributes of the model at the time of the previous\n     * <code>\"change\"</code> event.\n     * @return {Object}\n     */\n    previousAttributes: function () {\n      return _.clone(this._previousAttributes)\n    },\n\n    /**\n     * Checks if the model is currently in a valid state. It's only possible to\n     * get into an *invalid* state if you're using silent changes.\n     * @return {Boolean}\n     */\n    isValid: function () {\n      return !this.validate(this.attributes)\n    },\n\n    /**\n     * You should not call this function directly unless you subclass\n     * <code>Parse.Object</code>, in which case you can override this method\n     * to provide additional validation on <code>set</code> and\n     * <code>save</code>.  Your implementation should return\n     *\n     * @param {Object} attrs The current data to validate.\n     * @param {Object} options A Backbone-like options object.\n     * @return {} False if the data is valid.  An error object otherwise.\n     * @see Parse.Object#set\n     */\n    validate: function (attrs, options) {\n      if (_.has(attrs, 'ACL') && !(attrs.ACL instanceof Parse.ACL)) {\n        return new Parse.Error(Parse.Error.OTHER_CAUSE,\n          'ACL must be a Parse.ACL.')\n      }\n      var correct = true\n      Parse._objectEach(attrs, function (unusedValue, key) {\n        if (!(/^[A-Za-z][0-9A-Za-z_]*$/).test(key)) {\n          correct = false\n        }\n      })\n      if (!correct) {\n        return new Parse.Error(Parse.Error.INVALID_KEY_NAME)\n      }\n      return false\n    },\n\n    /**\n     * Run validation against a set of incoming attributes, returning `true`\n     * if all is well. If a specific `error` callback has been passed,\n     * call that instead of firing the general `\"error\"` event.\n     */\n    _validate: function (attrs, options) {\n      if (options.silent || !this.validate) {\n        return true\n      }\n      attrs = _.extend({}, this.attributes, attrs)\n      var error = this.validate(attrs, options)\n      if (!error) {\n        return true\n      }\n      if (options && options.error) {\n        options.error(this, error, options)\n      } else {\n        this.trigger('error', this, error, options)\n      }\n      return false\n    },\n\n    /**\n     * Returns the ACL for this object.\n     * @returns {Parse.ACL} An instance of Parse.ACL.\n     * @see Parse.Object#get\n     */\n    getACL: function () {\n      return this.get('ACL')\n    },\n\n    /**\n     * Sets the ACL to be used for this object.\n     * @param {Parse.ACL} acl An instance of Parse.ACL.\n     * @param {Object} options Optional Backbone-like options object to be\n     *     passed in to set.\n     * @return {Boolean} Whether the set passed validation.\n     * @see Parse.Object#set\n     */\n    setACL: function (acl, options) {\n      return this.set('ACL', acl, options)\n    }\n\n  })\n\n  /**\n   * Returns the appropriate subclass for making new instances of the given\n   * className string.\n   */\n  Parse.Object._getSubclass = function (className) {\n    if (!_.isString(className)) {\n      throw new Error('Parse.Object._getSubclass requires a string argument.')\n    }\n    var ObjectClass = Parse.Object._classMap[className]\n    if (!ObjectClass) {\n      ObjectClass = Parse.Object.extend(className)\n      Parse.Object._classMap[className] = ObjectClass\n    }\n    return ObjectClass\n  }\n\n  /**\n   * Creates an instance of a subclass of Parse.Object for the given classname.\n   */\n  Parse.Object._create = function (className, attributes, options) {\n    var ObjectClass = Parse.Object._getSubclass(className)\n    return new ObjectClass(attributes, options)\n  }\n\n  /**\n   * Returns a list of object ids given a list of objects.\n   */\n  Parse.Object._toObjectIdArray = function (list, omitObjectsWithData) {\n    if (list.length === 0) {\n      return Parse.Promise.as(list)\n    }\n\n    var error\n    var className = list[0].className\n    var objectIds = []\n    for (var i = 0; i < list.length; i++) {\n      var object = list[i]\n      if (className !== object.className) {\n        error = new Parse.Error(Parse.Error.INVALID_CLASS_NAME,\n          'All objects should be of the same class')\n        return Parse.Promise.error(error)\n      } else if (!object.id) {\n        error = new Parse.Error(Parse.Error.MISSING_OBJECT_ID,\n          'All objects must have an ID')\n        return Parse.Promise.error(error)\n      } else if (omitObjectsWithData && object._hasData) {\n        continue\n      }\n      objectIds.push(object.id)\n    }\n\n    return Parse.Promise.as(objectIds)\n  }\n\n  /**\n   * Updates a list of objects with fetched results.\n   */\n  Parse.Object._updateWithFetchedResults = function (list, fetched, forceFetch) {\n    var fetchedObjectsById = {}\n    Parse._arrayEach(fetched, function (object, i) {\n      fetchedObjectsById[object.id] = object\n    })\n\n    for (var i = 0; i < list.length; i++) {\n      var object = list[i]\n      var fetchedObject = fetchedObjectsById[object.id]\n      if (!fetchedObject && forceFetch) {\n        var error = new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,\n          'All objects must exist on the server')\n        return Parse.Promise.error(error)\n      }\n\n      object._mergeFromObject(fetchedObject)\n    }\n\n    return Parse.Promise.as(list)\n  }\n\n  /**\n   * Fetches the objects given in list.  The forceFetch option will fetch all\n   * objects if true and ignore objects with data if false.\n   */\n  Parse.Object._fetchAll = function (list, forceFetch) {\n    if (list.length === 0) {\n      return Parse.Promise.as(list)\n    }\n\n    var omitObjectsWithData = !forceFetch\n    return Parse.Object._toObjectIdArray(\n      list,\n      omitObjectsWithData\n    ).then(function (objectIds) {\n      var className = list[0].className\n      var query = new Parse.Query(className)\n      query.containedIn('objectId', objectIds)\n      query.limit = objectIds.length\n      return query.find()\n    }).then(function (results) {\n      return Parse.Object._updateWithFetchedResults(\n        list,\n        results,\n        forceFetch\n      )\n    })\n  }\n\n  // Set up a map of className to class so that we can create new instances of\n  // Parse Objects from JSON automatically.\n  Parse.Object._classMap = {}\n\n  Parse.Object._extend = Parse._extend\n\n  /**\n   * Creates a new subclass of Parse.Object for the given Parse class name.\n   *\n   * <p>Every extension of a Parse class will inherit from the most recent\n   * previous extension of that class. When a Parse.Object is automatically\n   * created by parsing JSON, it will use the most recent extension of that\n   * class.</p>\n   *\n   * <p>You should call either:<pre>\n   *     var MyClass = Parse.Object.extend(\"MyClass\", {\n   *         <i>Instance methods</i>,\n   *         initialize: function(attrs, options) {\n   *             this.someInstanceProperty = [],\n   *             <i>Other instance properties</i>\n   *         }\n   *     }, {\n   *         <i>Class properties</i>\n   *     });</pre>\n   * or, for Backbone compatibility:<pre>\n   *     var MyClass = Parse.Object.extend({\n   *         className: \"MyClass\",\n   *         <i>Instance methods</i>,\n   *         initialize: function(attrs, options) {\n   *             this.someInstanceProperty = [],\n   *             <i>Other instance properties</i>\n   *         }\n   *     }, {\n   *         <i>Class properties</i>\n   *     });</pre></p>\n   *\n   * @param {String} className The name of the Parse class backing this model.\n   * @param {Object} protoProps Instance properties to add to instances of the\n   *     class returned from this method.\n   * @param {Object} classProps Class properties to add the class returned from\n   *     this method.\n   * @return {Class} A new subclass of Parse.Object.\n   */\n  Parse.Object.extend = function (className, protoProps, classProps) {\n    // Handle the case with only two args.\n    if (!_.isString(className)) {\n      if (className && _.has(className, 'className')) {\n        return Parse.Object.extend(className.className, className, protoProps)\n      } else {\n        throw new Error(\n          \"Parse.Object.extend's first argument should be the className.\")\n      }\n    }\n\n    // If someone tries to subclass \"User\", coerce it to the right type.\n    if (className === 'User' && Parse.User._performUserRewrite) {\n      className = '_User'\n    }\n    protoProps = protoProps || {}\n    protoProps.className = className\n\n    var NewClassObject = null\n    if (_.has(Parse.Object._classMap, className)) {\n      var OldClassObject = Parse.Object._classMap[className]\n      // This new subclass has been told to extend both from \"this\" and from\n      // OldClassObject. This is multiple inheritance, which isn't supported.\n      // For now, let's just pick one.\n      NewClassObject = OldClassObject._extend(protoProps, classProps)\n    } else {\n      NewClassObject = this._extend(protoProps, classProps)\n    }\n    // Extending a subclass should reuse the classname automatically.\n    NewClassObject.extend = function (arg0) {\n      if (_.isString(arg0) || (arg0 && _.has(arg0, 'className'))) {\n        return Parse.Object.extend.apply(NewClassObject, arguments)\n      }\n      var newArguments = [className].concat(Parse._.toArray(arguments))\n      return Parse.Object.extend.apply(NewClassObject, newArguments)\n    }\n\n    /**\n     * Creates a reference to a subclass of Parse.Object with the given id. This\n     * does not exist on Parse.Object, only on subclasses.\n     *\n     * <p>A shortcut for: <pre>\n     *  var Foo = Parse.Object.extend(\"Foo\")\n     *  var pointerToFoo = new Foo()\n     *  pointerToFoo.id = \"myObjectId\"\n     * </pre>\n     *\n     * @name createWithoutData\n     * @param {String} id The ID of the object to create a reference to.\n     * @return {Parse.Object} A Parse.Object reference.\n     * @function\n     * @memberOf Parse.Object\n     */\n    NewClassObject.createWithoutData = function (id) {\n      var obj = new NewClassObject()\n      obj.id = id\n      return obj\n    }\n\n    Parse.Object._classMap[className] = NewClassObject\n    return NewClassObject\n  }\n\n  Parse.Object._findUnsavedChildren = function (object, children, files) {\n    Parse._traverse(object, function (object) {\n      if (object instanceof Parse.Object) {\n        object._refreshCache()\n        if (object.dirty()) {\n          children.push(object)\n        }\n        return\n      }\n\n      if (object instanceof Parse.File) {\n        if (!object.url()) {\n          files.push(object)\n        }\n        return\n      }\n    })\n  }\n\n  Parse.Object._canBeSerializedAsValue = function (object) {\n    if (object instanceof Parse.Object) {\n      return !!object.id\n    }\n    if (object instanceof Parse.File) {\n      // Don't recurse indefinitely into files.\n      return true\n    }\n\n    var canBeSerializedAsValue = true\n\n    if (_.isArray(object)) {\n      Parse._arrayEach(object, function (child) {\n        if (!Parse.Object._canBeSerializedAsValue(child)) {\n          canBeSerializedAsValue = false\n        }\n      })\n    } else if (_.isObject(object)) {\n      Parse._objectEach(object, function (child) {\n        if (!Parse.Object._canBeSerializedAsValue(child)) {\n          canBeSerializedAsValue = false\n        }\n      })\n    }\n    return canBeSerializedAsValue\n  }\n\n  /**\n   * @param {Object} object The root object.\n   * @param {Object} options: The only valid option is useMasterKey.\n   */\n  Parse.Object._deepSaveAsync = function (object, options) {\n    var unsavedChildren = []\n    var unsavedFiles = []\n    Parse.Object._findUnsavedChildren(object, unsavedChildren, unsavedFiles)\n\n    var promise = Parse.Promise.as()\n    _.each(unsavedFiles, function (file) {\n      promise = promise.then(function () {\n        return file.save(options)\n      })\n    })\n\n    var objects = _.uniq(unsavedChildren)\n    var remaining = _.uniq(objects)\n\n    return promise.then(function () {\n      return Parse.Promise._continueWhile(function () {\n        return remaining.length > 0\n      }, function () {\n        // Gather up all the objects that can be saved in this batch.\n        var batch = []\n        var newRemaining = []\n        Parse._arrayEach(remaining, function (object) {\n          // Limit batches to 20 objects.\n          if (batch.length > 20) {\n            newRemaining.push(object)\n            return\n          }\n\n          if (object._canBeSerialized()) {\n            batch.push(object)\n          } else {\n            newRemaining.push(object)\n          }\n        })\n        remaining = newRemaining\n\n        // If we can't save any objects, there must be a circular reference.\n        if (batch.length === 0) {\n          return Parse.Promise.error(\n            new Parse.Error(Parse.Error.OTHER_CAUSE,\n              'Tried to save a batch with a cycle.'))\n        }\n\n        // Reserve a spot in every object's save queue.\n        var readyToStart = Parse.Promise.when(_.map(batch, function (object) {\n          return object._allPreviousSaves || Parse.Promise.as()\n        }))\n        var batchFinished = new Parse.Promise()\n        Parse._arrayEach(batch, function (object) {\n          object._allPreviousSaves = batchFinished\n        })\n\n        // Save a single batch, whether previous saves succeeded or failed.\n        return readyToStart._continueWith(function () {\n          return Parse._request({\n            route: 'batch',\n            method: 'POST',\n            useMasterKey: options.useMasterKey,\n            sessionToken: options.sessionToken,\n            data: {\n              requests: _.map(batch, function (object) {\n                var json = object._getSaveJSON()\n                var method = 'POST'\n\n                var path = '/1/classes/' + object.className\n                if (object.id) {\n                  path = path + '/' + object.id\n                  method = 'PUT'\n                }\n\n                object._startSave()\n\n                return {\n                  method: method,\n                  path: path,\n                  body: json\n                }\n              })\n            }\n          }).then(function (response, status, xhr) {\n            var error\n            Parse._arrayEach(batch, function (object, i) {\n              if (response[i].success) {\n                object._finishSave(\n                  object.parse(response[i].success, status, xhr))\n              } else {\n                error = error || response[i].error\n                object._cancelSave()\n              }\n            })\n            if (error) {\n              return Parse.Promise.error(\n                new Parse.Error(error.code, error.error))\n            }\n          }).then(function (results) {\n            batchFinished.resolve(results)\n            return results\n          }, function (error) {\n            batchFinished.reject(error)\n            return Parse.Promise.error(error)\n          })\n        })\n      })\n    }).then(function () {\n      return object\n    })\n  }\n}(this))\n\n"],"sourceRoot":"/source/"}